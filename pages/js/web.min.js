var LeaferUI=function(t){"use strict";const e={toURL(t,e){let i=encodeURIComponent(t);return"text"===e?i="data:text/plain;charset=utf-8,"+i:"svg"===e&&(i="data:image/svg+xml,"+i),i},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",getRealURL(t){const{prefix:i,suffix:s}=e.image;return!s||t.startsWith("data:")||t.startsWith("blob:")||(t+=(t.includes("?")?"&":"?")+s),i&&"/"===t[0]&&(t=i+t),t}}},i={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(t){const{types:e}=s;return e[t]?e[t]++:(e[t]=1,0)}},s=i;var r;t.Answer=void 0,(r=t.Answer||(t.Answer={}))[r.No=0]="No",r[r.Yes=1]="Yes",r[r.NoAndSkip=2]="NoAndSkip",r[r.YesAndSkip=3]="YesAndSkip";const n={};function o(t){return void 0===t}function a(t){return null==t}function h(t){return"string"==typeof t}const{isFinite:l}=Number;function d(t){return"number"==typeof t}const c=/^-?\d+(?:\.\d+)?$/;const{isArray:u}=Array;function _(t){return t&&"object"==typeof t}function p(t){return"{}"===JSON.stringify(t)}const g={default:(t,e)=>(f(e,t),f(t,e),t),assign(t,e,i){let s;Object.keys(e).forEach(r=>{var n,o;if(s=e[r],(null==s?void 0:s.constructor)===Object&&(null===(n=t[r])||void 0===n?void 0:n.constructor)===Object)return f(t[r],e[r],i&&i[r]);i&&r in i?(null===(o=i[r])||void 0===o?void 0:o.constructor)===Object&&f(t[r]={},e[r],i[r]):t[r]=e[r]})},copyAttrs:(t,e,i)=>(i.forEach(i=>{o(e[i])||(t[i]=e[i])}),t),clone:t=>JSON.parse(JSON.stringify(t)),toMap(t){const e={};for(let i=0,s=t.length;i<s;i++)e[t[i]]=!0;return e},stintSet(t,e,i){i||(i=void 0),t[e]!==i&&(t[e]=i)}},{assign:f}=g;class y{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&6===t.length&&1===t[0]}get __blendMode(){if(this.eraser&&"path"!==this.eraser)return"destination-out";const{blendMode:t}=this;return"pass-through"===t?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(!o(e))return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let i;for(let s in this)"_"!==s[0]&&(i=e?e[s]:void 0,t[s]=o(i)?this[s]:i);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(!o(e))return e}if("path"!==t||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&!o(this.__input[t])&&(this.__input[t]=void 0)}__getInputData(t,e){const i={};if(t)if(u(t))for(let e of t)i[e]=this.__getInput(e);else for(let e in t)i[e]=this.__getInput(e);else{let t,e,{__input:s}=this;i.tag=this.__leaf.tag;for(let r in this)if("_"!==r[0]&&(t=this["_"+r],!o(t))){if("path"===r&&!this.__pathInputed)continue;e=s?s[r]:void 0,i[r]=o(e)?t:e}}if(e&&e.matrix){const{a:t,b:e,c:s,d:r,e:n,f:o}=this.__leaf.__localMatrix;i.matrix={a:t,b:e,c:s,d:r,e:n,f:o}}return i}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if("pass-through"===t.blendMode){const e=this.__leaf;t.opacity<1&&(e.isBranch||t.__hasMultiPaint)||e.__hasEraser||t.eraser||t.filter?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}const{round:v,pow:m,PI:w}=Math,x={within:(t,e,i)=>(_(e)&&(i=e.max,e=e.min),!o(e)&&t<e&&(t=e),!o(i)&&t>i&&(t=i),t),fourNumber(t,e){let i;if(u(t))switch(t.length){case 4:i=o(e)?t:[...t];break;case 2:i=[t[0],t[1],t[0],t[1]];break;case 3:i=[t[0],t[1],t[2],t[1]];break;case 1:t=t[0];break;default:t=0}if(i||(i=[t,t,t,t]),e)for(let t=0;t<4;t++)i[t]>e&&(i[t]=e);return i},formatRotation:(t,e)=>(t%=360,e?t<0&&(t+=360):(t>180&&(t-=360),t<-180&&(t+=360)),x.float(t)),getGapRotation(t,e,i=0){let s=t+i;if(e>1){const t=Math.abs(s%e);(t<1||t>e-1)&&(s=Math.round(s/e)*e)}return s-i},float(t,e){const i=o(e)?1e12:m(10,e);return-0===(t=v(t*i)/i)?0:t},sign:t=>t<0?-1:1,getScaleData(t,e,i,s){if(s||(s={}),e){const t=(d(e)?e:e.width||0)/i.width,r=(d(e)?e:e.height||0)/i.height;s.scaleX=t||r||1,s.scaleY=r||t||1}else t&&x.assignScale(s,t);return s},assignScale(t,e){d(e)?t.scaleX=t.scaleY=e:(t.scaleX=e.x,t.scaleY=e.y)},randInt:b,randColor:t=>`rgba(${b(255)},${b(255)},${b(255)},${t||1})`};function b(t){return Math.round(Math.random()*t)}const E=w/180,P=2*w,B=w/2;function k(){return{x:0,y:0}}function R(){return{x:0,y:0,width:0,height:0}}function C(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:T,cos:S,acos:L,sqrt:O}=Math,{float:D}=x,I={};function A(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const M={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:A(),tempMatrix:{},set(t,e=1,i=0,s=0,r=1,n=0,o=0){t.a=e,t.b=i,t.c=s,t.d=r,t.e=n,t.f=o},get:C,getWorld:A,copy(t,e){t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.e=e.e,t.f=e.f},translate(t,e,i){t.e+=e,t.f+=i},translateInner(t,e,i,s){t.e+=t.a*e+t.c*i,t.f+=t.b*e+t.d*i,s&&(t.e-=e,t.f-=i)},scale(t,e,i=e){t.a*=e,t.b*=e,t.c*=i,t.d*=i},scaleOfOuter(t,e,i,s){W.toInnerPoint(t,e,I),W.scaleOfInner(t,I,i,s)},scaleOfInner(t,e,i,s=i){W.translateInner(t,e.x,e.y),W.scale(t,i,s),W.translateInner(t,-e.x,-e.y)},rotate(t,e){const{a:i,b:s,c:r,d:n}=t,o=S(e*=E),a=T(e);t.a=i*o-s*a,t.b=i*a+s*o,t.c=r*o-n*a,t.d=r*a+n*o},rotateOfOuter(t,e,i){W.toInnerPoint(t,e,I),W.rotateOfInner(t,I,i)},rotateOfInner(t,e,i){W.translateInner(t,e.x,e.y),W.rotate(t,i),W.translateInner(t,-e.x,-e.y)},skew(t,e,i){const{a:s,b:r,c:n,d:o}=t;i&&(i*=E,t.a=s+n*i,t.b=r+o*i),e&&(e*=E,t.c=n+s*e,t.d=o+r*e)},skewOfOuter(t,e,i,s){W.toInnerPoint(t,e,I),W.skewOfInner(t,I,i,s)},skewOfInner(t,e,i,s=0){W.translateInner(t,e.x,e.y),W.skew(t,i,s),W.translateInner(t,-e.x,-e.y)},multiply(t,e){const{a:i,b:s,c:r,d:n,e:o,f:a}=t;t.a=e.a*i+e.b*r,t.b=e.a*s+e.b*n,t.c=e.c*i+e.d*r,t.d=e.c*s+e.d*n,t.e=e.e*i+e.f*r+o,t.f=e.e*s+e.f*n+a},multiplyParent(t,e,i,s,r){const{e:n,f:a}=t;if(i||(i=t),o(s)&&(s=1!==t.a||t.b||t.c||1!==t.d),s){const{a:s,b:n,c:o,d:a}=t;i.a=s*e.a+n*e.c,i.b=s*e.b+n*e.d,i.c=o*e.a+a*e.c,i.d=o*e.b+a*e.d,r&&(i.scaleX=e.scaleX*r.scaleX,i.scaleY=e.scaleY*r.scaleY)}else i.a=e.a,i.b=e.b,i.c=e.c,i.d=e.d,r&&(i.scaleX=e.scaleX,i.scaleY=e.scaleY);i.e=n*e.a+a*e.c+e.e,i.f=n*e.b+a*e.d+e.f},divide(t,e){W.multiply(t,W.tempInvert(e))},divideParent(t,e){W.multiplyParent(t,W.tempInvert(e))},tempInvert(t){const{tempMatrix:e}=W;return W.copy(e,t),W.invert(e),e},invert(t){const{a:e,b:i,c:s,d:r,e:n,f:o}=t;if(i||s){const a=1/(e*r-i*s);t.a=r*a,t.b=-i*a,t.c=-s*a,t.d=e*a,t.e=-(n*r-o*s)*a,t.f=-(o*e-n*i)*a}else if(1===e&&1===r)t.e=-n,t.f=-o;else{const i=1/(e*r);t.a=r*i,t.d=e*i,t.e=-n*r*i,t.f=-o*e*i}},toOuterPoint(t,e,i,s){const{x:r,y:n}=e;i||(i=e),i.x=r*t.a+n*t.c,i.y=r*t.b+n*t.d,s||(i.x+=t.e,i.y+=t.f)},toInnerPoint(t,e,i,s){const{a:r,b:n,c:o,d:a}=t,h=1/(r*a-n*o),{x:l,y:d}=e;if(i||(i=e),i.x=(l*a-d*o)*h,i.y=(d*r-l*n)*h,!s){const{e:e,f:s}=t;i.x-=(e*a-s*o)*h,i.y-=(s*r-e*n)*h}},setLayout(t,e,i,s,r){const{x:n,y:a,scaleX:h,scaleY:l}=e;if(o(r)&&(r=e.rotation||e.skewX||e.skewY),r){const{rotation:i,skewX:s,skewY:r}=e,n=i*E,o=S(n),a=T(n);if(s||r){const e=s*E,i=r*E;t.a=(o+i*-a)*h,t.b=(a+i*o)*h,t.c=(e*o-a)*l,t.d=(o+e*a)*l}else t.a=o*h,t.b=a*h,t.c=-a*l,t.d=o*l}else t.a=h,t.b=0,t.c=0,t.d=l;t.e=n,t.f=a,(i=i||s)&&W.translateInner(t,-i.x,-i.y,!s)},getLayout(t,e,i,s){const{a:r,b:n,c:o,d:a,e:h,f:l}=t;let d,c,u,_,p,g=h,f=l;if(n||o){const t=r*a-n*o;if(o&&!s){d=O(r*r+n*n),c=t/d;const e=r/d;u=n>0?L(e):-L(e)}else{c=O(o*o+a*a),d=t/c;const e=o/c;u=B-(a>0?L(-e):-L(e))}const e=D(S(u)),i=T(u);d=D(d),c=D(c),_=e?D((o/c+i)/e/E,9):0,p=e?D((n/d-i)/e/E,9):0,u=D(u/E)}else d=r,c=a,u=_=p=0;return(e=i||e)&&(g+=e.x*r+e.y*o,f+=e.x*n+e.y*a,i||(g-=e.x,f-=e.y)),{x:g,y:f,scaleX:d,scaleY:c,rotation:u,skewX:_,skewY:p}},withScale(t,e,i=e){const s=t;if(!e||!i){const{a:s,b:r,c:n,d:o}=t;r||n?i=(s*o-r*n)/(e=O(s*s+r*r)):(e=s,i=o)}return s.scaleX=e,s.scaleY=i,s},reset(t){W.set(t)}},W=M,{toInnerPoint:F,toOuterPoint:U}=M,{sin:z,cos:N,abs:Y,sqrt:X,atan2:H,min:j,round:V}=Math,G={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(t,e=0,i=0){t.x=e,t.y=i},setRadius(t,e,i){t.radiusX=e,t.radiusY=o(i)?e:i},copy(t,e){t.x=e.x,t.y=e.y},copyFrom(t,e,i){t.x=e,t.y=i},round(t,e){t.x=e?V(t.x-.5)+.5:V(t.x),t.y=e?V(t.y-.5)+.5:V(t.y)},move(t,e,i){_(e)?(t.x+=e.x,t.y+=e.y):(t.x+=e,t.y+=i)},scale(t,e,i=e){t.x&&(t.x*=e),t.y&&(t.y*=i)},scaleOf(t,e,i,s=i){t.x+=(t.x-e.x)*(i-1),t.y+=(t.y-e.y)*(s-1)},rotate(t,e,i){i||(i=K.defaultPoint);const s=N(e*=E),r=z(e),n=t.x-i.x,o=t.y-i.y;t.x=i.x+n*s-o*r,t.y=i.y+n*r+o*s},tempToInnerOf(t,e){const{tempPoint:i}=K;return Z(i,t),F(e,i,i),i},tempToOuterOf(t,e){const{tempPoint:i}=K;return Z(i,t),U(e,i,i),i},tempToInnerRadiusPointOf(t,e){const{tempRadiusPoint:i}=K;return Z(i,t),K.toInnerRadiusPointOf(t,e,i),i},toInnerRadiusPointOf(t,e,i){i||(i=t),F(e,t,i),i.radiusX=Math.abs(t.radiusX/e.scaleX),i.radiusY=Math.abs(t.radiusY/e.scaleY)},toInnerOf(t,e,i){F(e,t,i)},toOuterOf(t,e,i){U(e,t,i)},getCenter:(t,e)=>({x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}),getCenterX:(t,e)=>t+(e-t)/2,getCenterY:(t,e)=>t+(e-t)/2,getDistance:(t,e)=>q(t.x,t.y,e.x,e.y),getDistanceFrom(t,e,i,s){const r=Y(i-t),n=Y(s-e);return X(r*r+n*n)},getMinDistanceFrom:(t,e,i,s,r,n)=>j(q(t,e,i,s),q(i,s,r,n)),getAngle:(t,e)=>$(t,e)/E,getRotation:(t,e,i,s)=>(s||(s=e),K.getRadianFrom(t.x,t.y,e.x,e.y,i.x,i.y,s.x,s.y)/E),getRadianFrom(t,e,i,s,r,n,a,h){o(a)&&(a=i,h=s);const l=t-i,d=e-s,c=r-a,u=n-h;return Math.atan2(l*u-d*c,l*c+d*u)},getAtan2:(t,e)=>H(e.y-t.y,e.x-t.x),getDistancePoint(t,e,i,s){const r=$(t,e);return(e=s?e:{}).x=t.x+N(r)*i,e.y=t.y+z(r)*i,e},toNumberPoints(t){let e=t;return _(t[0])&&(e=[],t.forEach(t=>e.push(t.x,t.y))),e},reset(t){K.reset(t)}},K=G,{getDistanceFrom:q,copy:Z,getAtan2:$}=K;class Q{constructor(t,e){this.set(t,e)}set(t,e){return _(t)?G.copy(this,t):G.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new Q(this)}move(t,e){return G.move(this,t,e),this}scale(t,e){return G.scale(this,t,e),this}scaleOf(t,e,i){return G.scaleOf(this,t,e,i),this}rotate(t,e){return G.rotate(this,t,e),this}rotateOf(t,e){return G.rotate(this,e,t),this}getRotation(t,e,i){return G.getRotation(this,t,e,i)}toInnerOf(t,e){return G.toInnerOf(this,t,e),this}toOuterOf(t,e){return G.toOuterOf(this,t,e),this}getCenter(t){return new Q(G.getCenter(this,t))}getDistance(t){return G.getDistance(this,t)}getDistancePoint(t,e,i){return new Q(G.getDistancePoint(this,t,e,i))}getAngle(t){return G.getAngle(this,t)}getAtan2(t){return G.getAtan2(this,t)}reset(){return G.reset(this),this}}const J=new Q;class tt{constructor(t,e,i,s,r,n){this.set(t,e,i,s,r,n)}set(t,e,i,s,r,n){return _(t)?M.copy(this,t):M.set(this,t,e,i,s,r,n),this}setWith(t){return M.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:i,d:s,e:r,f:n}=this;return{a:t,b:e,c:i,d:s,e:r,f:n}}clone(){return new tt(this)}translate(t,e){return M.translate(this,t,e),this}translateInner(t,e){return M.translateInner(this,t,e),this}scale(t,e){return M.scale(this,t,e),this}scaleWith(t,e){return M.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,i){return M.scaleOfOuter(this,t,e,i),this}scaleOfInner(t,e,i){return M.scaleOfInner(this,t,e,i),this}rotate(t){return M.rotate(this,t),this}rotateOfOuter(t,e){return M.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return M.rotateOfInner(this,t,e),this}skew(t,e){return M.skew(this,t,e),this}skewOfOuter(t,e,i){return M.skewOfOuter(this,t,e,i),this}skewOfInner(t,e,i){return M.skewOfInner(this,t,e,i),this}multiply(t){return M.multiply(this,t),this}multiplyParent(t){return M.multiplyParent(this,t),this}divide(t){return M.divide(this,t),this}divideParent(t){return M.divideParent(this,t),this}invert(){return M.invert(this),this}invertWith(){return M.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,i){M.toOuterPoint(this,t,e,i)}toInnerPoint(t,e,i){M.toInnerPoint(this,t,e,i)}setLayout(t,e,i){return M.setLayout(this,t,e,i),this}getLayout(t,e,i){return M.getLayout(this,t,e,i)}withScale(t,e){return M.withScale(this,t,e)}reset(){M.reset(this)}}const et=new tt,it={tempPointBounds:{},setPoint(t,e,i){t.minX=t.maxX=e,t.minY=t.maxY=i},addPoint(t,e,i){t.minX=e<t.minX?e:t.minX,t.minY=i<t.minY?i:t.minY,t.maxX=e>t.maxX?e:t.maxX,t.maxY=i>t.maxY?i:t.maxY},addBounds(t,e,i,s,r){st(t,e,i),st(t,e+s,i+r)},copy(t,e){t.minX=e.minX,t.minY=e.minY,t.maxX=e.maxX,t.maxY=e.maxY},addPointBounds(t,e){t.minX=e.minX<t.minX?e.minX:t.minX,t.minY=e.minY<t.minY?e.minY:t.minY,t.maxX=e.maxX>t.maxX?e.maxX:t.maxX,t.maxY=e.maxY>t.maxY?e.maxY:t.maxY},toBounds(t,e){e.x=t.minX,e.y=t.minY,e.width=t.maxX-t.minX,e.height=t.maxY-t.minY}},{addPoint:st}=it;var rt,nt;t.Direction4=void 0,(rt=t.Direction4||(t.Direction4={}))[rt.top=0]="top",rt[rt.right=1]="right",rt[rt.bottom=2]="bottom",rt[rt.left=3]="left",t.Direction9=void 0,(nt=t.Direction9||(t.Direction9={}))[nt.topLeft=0]="topLeft",nt[nt.top=1]="top",nt[nt.topRight=2]="topRight",nt[nt.right=3]="right",nt[nt.bottomRight=4]="bottomRight",nt[nt.bottom=5]="bottom",nt[nt.bottomLeft=6]="bottomLeft",nt[nt.left=7]="left",nt[nt.center=8]="center",nt[nt["top-left"]=0]="top-left",nt[nt["top-right"]=2]="top-right",nt[nt["bottom-right"]=4]="bottom-right",nt[nt["bottom-left"]=6]="bottom-left";const ot=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];ot.forEach(t=>t.type="percent");const at={directionData:ot,tempPoint:{},get:ht,toPoint(t,e,i,s,r,n){const o=ht(t);i.x=o.x,i.y=o.y,"percent"===o.type&&(i.x*=e.width,i.y*=e.height,r&&(n||(i.x-=r.x,i.y-=r.y),o.x&&(i.x-=1===o.x?r.width:.5===o.x?o.x*r.width:0),o.y&&(i.y-=1===o.y?r.height:.5===o.y?o.y*r.height:0))),s||(i.x+=e.x,i.y+=e.y)},getPoint:(t,e,i)=>(i||(i={}),at.toPoint(t,e,i,!0),i)};function ht(e){return h(e)?ot[t.Direction9[e]]:e}const{toPoint:lt}=at,dt={toPoint(t,e,i,s,r,n){lt(t,i,s,r,e,n)}},{tempPointBounds:ct,setPoint:ut,addPoint:_t,toBounds:pt}=it,{toOuterPoint:gt}=M,{float:ft,fourNumber:yt}=x,{floor:vt,ceil:mt}=Math;let wt,xt,bt,Et;const Pt={},Bt={},kt={},Rt={tempBounds:kt,set(t,e=0,i=0,s=0,r=0){t.x=e,t.y=i,t.width=s,t.height=r},copy(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},copyAndSpread(t,e,i,s,r){const{x:n,y:o,width:a,height:h}=e;if(u(i)){const e=yt(i);s?Ct.set(t,n+e[3],o+e[0],a-e[1]-e[3],h-e[2]-e[0]):Ct.set(t,n-e[3],o-e[0],a+e[1]+e[3],h+e[2]+e[0])}else s&&(i=-i),Ct.set(t,n-i,o-i,a+2*i,h+2*i);r&&("width"===r?(t.y=o,t.height=h):(t.x=n,t.width=a))},minX:t=>t.width>0?t.x:t.x+t.width,minY:t=>t.height>0?t.y:t.y+t.height,maxX:t=>t.width>0?t.x+t.width:t.x,maxY:t=>t.height>0?t.y+t.height:t.y,move(t,e,i){t.x+=e,t.y+=i},scroll(t,e){t.x+=e.scrollX,t.y+=e.scrollY},getByMove:(t,e,i)=>(t=Object.assign({},t),Ct.move(t,e,i),t),toOffsetOutBounds(t,e,i){e?St(e,t):e=t,i?(e.offsetX=-(Ct.maxX(i)-t.x),e.offsetY=-(Ct.maxY(i)-t.y)):(e.offsetX=t.x+t.width,e.offsetY=t.y+t.height),Ct.move(e,-e.offsetX,-e.offsetY)},scale(t,e,i=e,s){s||G.scale(t,e,i),t.width*=e,t.height*=i},scaleOf(t,e,i,s=i){G.scaleOf(t,e,i,s),t.width*=i,t.height*=s},tempToOuterOf:(t,e)=>(Ct.copy(kt,t),Ct.toOuterOf(kt,e),kt),getOuterOf:(t,e)=>(t=Object.assign({},t),Ct.toOuterOf(t,e),t),toOuterOf(t,e,i){if(i||(i=t),0===e.b&&0===e.c){const{a:s,d:r}=e;s>0?(i.width=t.width*s,i.x=e.e+t.x*s):(i.width=t.width*-s,i.x=e.e+t.x*s-i.width),r>0?(i.height=t.height*r,i.y=e.f+t.y*r):(i.height=t.height*-r,i.y=e.f+t.y*r-i.height)}else Pt.x=t.x,Pt.y=t.y,gt(e,Pt,Bt),ut(ct,Bt.x,Bt.y),Pt.x=t.x+t.width,gt(e,Pt,Bt),_t(ct,Bt.x,Bt.y),Pt.y=t.y+t.height,gt(e,Pt,Bt),_t(ct,Bt.x,Bt.y),Pt.x=t.x,gt(e,Pt,Bt),_t(ct,Bt.x,Bt.y),pt(ct,i)},toInnerOf(t,e,i){i||(i=t),Ct.move(i,-e.e,-e.f),Ct.scale(i,1/e.a,1/e.d)},getFitMatrix(t,e,i=1){const s=Math.min(i,Ct.getFitScale(t,e));return new tt(s,0,0,s,-e.x*s,-e.y*s)},getFitScale(t,e,i){const s=t.width/e.width,r=t.height/e.height;return i?Math.max(s,r):Math.min(s,r)},put(t,e,i="center",s=1,r=!0,n){n||(n=e),h(s)&&(s=Ct.getFitScale(t,e,"cover"===s)),kt.width=r?e.width*=s:e.width*s,kt.height=r?e.height*=s:e.height*s,dt.toPoint(i,kt,t,n,!0,!0)},getSpread(t,e,i){const s={};return Ct.copyAndSpread(s,t,e,!1,i),s},spread(t,e,i){Ct.copyAndSpread(t,t,e,!1,i)},shrink(t,e,i){Ct.copyAndSpread(t,t,e,!0,i)},ceil(t){const{x:e,y:i}=t;t.x=vt(t.x),t.y=vt(t.y),t.width=e>t.x?mt(t.width+e-t.x):mt(t.width),t.height=i>t.y?mt(t.height+i-t.y):mt(t.height)},unsign(t){t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height)},float(t,e){t.x=ft(t.x,e),t.y=ft(t.y,e),t.width=ft(t.width,e),t.height=ft(t.height,e)},add(t,e,i){wt=t.x+t.width,xt=t.y+t.height,bt=e.x,Et=e.y,i||(bt+=e.width,Et+=e.height),wt=wt>bt?wt:bt,xt=xt>Et?xt:Et,t.x=t.x<e.x?t.x:e.x,t.y=t.y<e.y?t.y:e.y,t.width=wt-t.x,t.height=xt-t.y},addList(t,e){Ct.setListWithFn(t,e,void 0,!0)},setList(t,e,i=!1){Ct.setListWithFn(t,e,void 0,i)},addListWithFn(t,e,i){Ct.setListWithFn(t,e,i,!0)},setListWithFn(t,e,i,s=!1){let r,n=!0;for(let o=0,a=e.length;o<a;o++)r=i?i(e[o],o):e[o],r&&(r.width||r.height)&&(n?(n=!1,s||St(t,r)):Tt(t,r));n&&Ct.reset(t)},setPoints(t,e){e.forEach((t,e)=>0===e?ut(ct,t.x,t.y):_t(ct,t.x,t.y)),pt(ct,t)},setPoint(t,e){Ct.set(t,e.x,e.y)},addPoint(t,e){Tt(t,e,!0)},getPoints(t){const{x:e,y:i,width:s,height:r}=t;return[{x:e,y:i},{x:e+s,y:i},{x:e+s,y:i+r},{x:e,y:i+r}]},hitRadiusPoint:(t,e,i)=>(i&&(e=G.tempToInnerRadiusPointOf(e,i)),e.x>=t.x-e.radiusX&&e.x<=t.x+t.width+e.radiusX&&e.y>=t.y-e.radiusY&&e.y<=t.y+t.height+e.radiusY),hitPoint:(t,e,i)=>(i&&(e=G.tempToInnerOf(e,i)),e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height),hit:(t,e,i)=>(i&&(e=Ct.tempToOuterOf(e,i)),!(t.y+t.height<e.y||e.y+e.height<t.y||t.x+t.width<e.x||e.x+e.width<t.x)),includes:(t,e,i)=>(i&&(e=Ct.tempToOuterOf(e,i)),t.x<=e.x&&t.y<=e.y&&t.x+t.width>=e.x+e.width&&t.y+t.height>=e.y+e.height),getIntersectData(t,e,i){if(i&&(e=Ct.tempToOuterOf(e,i)),!Ct.hit(t,e))return{x:0,y:0,width:0,height:0};let{x:s,y:r,width:n,height:o}=e;return wt=s+n,xt=r+o,bt=t.x+t.width,Et=t.y+t.height,s=s>t.x?s:t.x,r=r>t.y?r:t.y,wt=wt<bt?wt:bt,xt=xt<Et?xt:Et,n=wt-s,o=xt-r,{x:s,y:r,width:n,height:o}},intersect(t,e,i){Ct.copy(t,Ct.getIntersectData(t,e,i))},isSame:(t,e)=>t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height,isEmpty:t=>0===t.x&&0===t.y&&0===t.width&&0===t.height,reset(t){Ct.set(t)}},Ct=Rt,{add:Tt,copy:St}=Ct;class Lt{get minX(){return Rt.minX(this)}get minY(){return Rt.minY(this)}get maxX(){return Rt.maxX(this)}get maxY(){return Rt.maxY(this)}constructor(t,e,i,s){this.set(t,e,i,s)}set(t,e,i,s){return _(t)?Rt.copy(this,t):Rt.set(this,t,e,i,s),this}get(){const{x:t,y:e,width:i,height:s}=this;return{x:t,y:e,width:i,height:s}}clone(){return new Lt(this)}move(t,e){return Rt.move(this,t,e),this}scale(t,e,i){return Rt.scale(this,t,e,i),this}scaleOf(t,e,i){return Rt.scaleOf(this,t,e,i),this}toOuterOf(t,e){return Rt.toOuterOf(this,t,e),this}toInnerOf(t,e){return Rt.toInnerOf(this,t,e),this}getFitMatrix(t,e){return Rt.getFitMatrix(this,t,e)}put(t,e,i){Rt.put(this,t,e,i)}spread(t,e){return Rt.spread(this,t,e),this}shrink(t,e){return Rt.shrink(this,t,e),this}ceil(){return Rt.ceil(this),this}unsign(){return Rt.unsign(this),this}float(t){return Rt.float(this,t),this}add(t){return Rt.add(this,t),this}addList(t){return Rt.setList(this,t,!0),this}setList(t){return Rt.setList(this,t),this}addListWithFn(t,e){return Rt.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return Rt.setListWithFn(this,t,e),this}setPoint(t){return Rt.setPoint(this,t),this}setPoints(t){return Rt.setPoints(this,t),this}addPoint(t){return Rt.addPoint(this,t),this}getPoints(){return Rt.getPoints(this)}hitPoint(t,e){return Rt.hitPoint(this,t,e)}hitRadiusPoint(t,e){return Rt.hitRadiusPoint(this,t,e)}hit(t,e){return Rt.hit(this,t,e)}includes(t,e){return Rt.includes(this,t,e)}intersect(t,e){return Rt.intersect(this,t,e),this}getIntersect(t,e){return new Lt(Rt.getIntersectData(this,t,e))}isSame(t){return Rt.isSame(this,t)}isEmpty(){return Rt.isEmpty(this)}reset(){Rt.reset(this)}}const Ot=new Lt;class Dt{constructor(t,e,i,s,r,n){_(t)?this.copy(t):this.set(t,e,i,s,r,n)}set(t=0,e=0,i=0,s=0,r=0,n=0){this.top=t,this.right=e,this.bottom=i,this.left=s,this.width=r,this.height=n}copy(t){const{top:e,right:i,bottom:s,left:r,width:n,height:o}=t;this.set(e,i,s,r,n,o)}getBoundsFrom(t){const{top:e,right:i,bottom:s,left:r,width:n,height:o}=this;return new Lt(r,e,n||t.width-r-i,o||t.height-e-s)}}const It={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1},{randColor:At}=x;class Mt{constructor(t){this.repeatMap={},this.name=t}static get(t){return new Mt(t)}static set filter(t){this.filterList=Wt(t)}static set exclude(t){this.excludeList=Wt(t)}static drawRepaint(t,e){const i=At();t.fillWorld(e,i.replace("1)",".1)")),t.strokeWorld(e,i)}static drawBounds(t,e,i){const s="hit"===Mt.showBounds,r=t.__nowWorld,n=At();s&&(e.setWorld(r),t.__drawHitPath(e),e.fillStyle=n.replace("1)",".2)"),e.fill()),e.resetTransform(),e.setStroke(n,2),s?e.stroke():e.strokeWorld(r,n)}log(...t){if(Ft.enable){if(Ft.filterList.length&&Ft.filterList.every(t=>t!==this.name))return;if(Ft.excludeList.length&&Ft.excludeList.some(t=>t===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){Ft.enable&&this.warn(...t)}warn(...t){Ft.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}function Wt(t){return t?h(t)&&(t=[t]):t=[],t}Mt.filterList=[],Mt.excludeList=[],Mt.showWarn=!0;const Ft=Mt,Ut=Mt.get("RunTime"),zt={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(t,e){const s=i.create(i.RUNTIME);return Nt.currentId=Nt.idMap[s]=e?performance.now():Date.now(),Nt.currentName=Nt.nameMap[s]=t,Nt.nameToIdMap[t]=s,s},end(t,e){const i=Nt.idMap[t],s=Nt.nameMap[t],r=e?(performance.now()-i)/1e3:Date.now()-i;Nt.idMap[t]=Nt.nameMap[t]=Nt.nameToIdMap[s]=void 0,Ut.log(s,r,"ms")},endOfName(t,e){const i=Nt.nameToIdMap[t];o(i)||Nt.end(i,e)}},Nt=zt,Yt=[],Xt={list:{},add(t,...e){this.list[t]=!0,Yt.push(...e)},has(t,e){const i=this.list[t];return!i&&e&&this.need(t),i},need(t){console.error("please install and import plugin: "+(t.includes("-x")?"":"@leafer-in/")+t)}};setTimeout(()=>Yt.forEach(t=>Xt.has(t,!0)));const Ht={editor:t=>Xt.need("editor")},jt=Mt.get("UICreator"),Vt={list:{},register(t){const{__tag:e}=t.prototype;Gt[e]&&jt.repeat(e),Gt[e]=t},get(t,e,i,s,r,n){Gt[t]||jt.error("not register "+t);const a=new Gt[t](e);return o(i)||(a.x=i,s&&(a.y=s),r&&(a.width=r),n&&(a.height=n)),a}},{list:Gt}=Vt,Kt=Mt.get("EventCreator"),qt={nameList:{},register(t){let e;Object.keys(t).forEach(i=>{e=t[i],h(e)&&(Zt[e]&&Kt.repeat(e),Zt[e]=t)})},changeName(t,e){const i=Zt[t];if(i){const s=Object.keys(i).find(e=>i[e]===t);s&&(i[s]=e,Zt[e]=i)}},has(t){return!!this.nameList[t]},get:(t,...e)=>new Zt[t](...e)},{nameList:Zt}=qt;class $t{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:i}=this;for(let s=0,r=i.length;s<r;s++)if(e=i[s],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const s=Ht.canvas(t);return this.add(s),s}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let i=0,s=this.list.length;i<s;i++)t=this.list[i],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}function Qt(t,e,i,s){var r,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(n<3?r(o):n>3?r(e,i,o):r(e,i))||o);return n>3&&o&&Object.defineProperty(e,i,o),o}function Jt(t,e,i,s){return new(i||(i=Promise))(function(r,n){function o(t){try{h(s.next(t))}catch(t){n(t)}}function a(t){try{h(s.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(o,a)}h((s=s.apply(t,e||[])).next())})}function te(t){return(e,i)=>{t||(t=i);const s={get(){return this.context[t]},set(e){this.context[t]=e}};"strokeCap"===i&&(s.set=function(e){this.context[t]="none"===e?"butt":e}),Object.defineProperty(e,i,s)}}"function"==typeof SuppressedError&&SuppressedError;const ee=[];function ie(){return(t,e)=>{ee.push(e)}}const se=[];class re{set blendMode(t){"normal"===t&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||se)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;ee.forEach(e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,e,i,s,r,n){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,i,s,r,n){_(t)?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,i,s,r,n)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,i,s){}strokeRect(t,e,i,s){}clearRect(t,e,i,s){}drawImage(t,e,i,s,r,n,o,a,h){switch(arguments.length){case 9:if(e<0){const t=-e/s*a;s+=e,e=0,n+=t,a-=t}if(i<0){const t=-i/r*h;r+=i,i=0,o+=t,h-=t}this.context.drawImage(t,e,i,s,r,n,o,a,h);break;case 5:this.context.drawImage(t,e,i,s,r);break;case 3:this.context.drawImage(t,e,i)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,i,s,r,n){}quadraticCurveTo(t,e,i,s){}closePath(){}arc(t,e,i,s,r,n){}arcTo(t,e,i,s,r){}ellipse(t,e,i,s,r,n,o,a){}rect(t,e,i,s){}roundRect(t,e,i,s,r){}createConicGradient(t,e,i){}createLinearGradient(t,e,i,s){}createPattern(t,e){}createRadialGradient(t,e,i,s,r,n){}fillText(t,e,i,s){}measureText(t){}strokeText(t,e,i,s){}destroy(){this.context=null}}Qt([te("imageSmoothingEnabled")],re.prototype,"smooth",void 0),Qt([te("imageSmoothingQuality")],re.prototype,"smoothLevel",void 0),Qt([te("globalAlpha")],re.prototype,"opacity",void 0),Qt([te()],re.prototype,"fillStyle",void 0),Qt([te()],re.prototype,"strokeStyle",void 0),Qt([te("lineWidth")],re.prototype,"strokeWidth",void 0),Qt([te("lineCap")],re.prototype,"strokeCap",void 0),Qt([te("lineJoin")],re.prototype,"strokeJoin",void 0),Qt([te("lineDashOffset")],re.prototype,"dashOffset",void 0),Qt([te()],re.prototype,"miterLimit",void 0),Qt([te()],re.prototype,"shadowBlur",void 0),Qt([te()],re.prototype,"shadowColor",void 0),Qt([te()],re.prototype,"shadowOffsetX",void 0),Qt([te()],re.prototype,"shadowOffsetY",void 0),Qt([te()],re.prototype,"filter",void 0),Qt([te()],re.prototype,"font",void 0),Qt([te()],re.prototype,"fontKerning",void 0),Qt([te()],re.prototype,"fontStretch",void 0),Qt([te()],re.prototype,"fontVariantCaps",void 0),Qt([te()],re.prototype,"textAlign",void 0),Qt([te()],re.prototype,"textBaseline",void 0),Qt([te()],re.prototype,"textRendering",void 0),Qt([te()],re.prototype,"wordSpacing",void 0),Qt([te()],re.prototype,"letterSpacing",void 0),Qt([te()],re.prototype,"direction",void 0),Qt([ie()],re.prototype,"setTransform",null),Qt([ie()],re.prototype,"resetTransform",null),Qt([ie()],re.prototype,"getTransform",null),Qt([ie()],re.prototype,"save",null),Qt([ie()],re.prototype,"restore",null),Qt([ie()],re.prototype,"translate",null),Qt([ie()],re.prototype,"scale",null),Qt([ie()],re.prototype,"rotate",null),Qt([ie()],re.prototype,"fill",null),Qt([ie()],re.prototype,"stroke",null),Qt([ie()],re.prototype,"clip",null),Qt([ie()],re.prototype,"fillRect",null),Qt([ie()],re.prototype,"strokeRect",null),Qt([ie()],re.prototype,"clearRect",null),Qt([ie()],re.prototype,"beginPath",null),Qt([ie()],re.prototype,"moveTo",null),Qt([ie()],re.prototype,"lineTo",null),Qt([ie()],re.prototype,"bezierCurveTo",null),Qt([ie()],re.prototype,"quadraticCurveTo",null),Qt([ie()],re.prototype,"closePath",null),Qt([ie()],re.prototype,"arc",null),Qt([ie()],re.prototype,"arcTo",null),Qt([ie()],re.prototype,"ellipse",null),Qt([ie()],re.prototype,"rect",null),Qt([ie()],re.prototype,"roundRect",null),Qt([ie()],re.prototype,"createConicGradient",null),Qt([ie()],re.prototype,"createLinearGradient",null),Qt([ie()],re.prototype,"createPattern",null),Qt([ie()],re.prototype,"createRadialGradient",null),Qt([ie()],re.prototype,"fillText",null),Qt([ie()],re.prototype,"measureText",null),Qt([ie()],re.prototype,"strokeText",null);const{copy:ne,multiplyParent:oe}=M,{round:ae}=Math,he=new Lt,le=new Lt,de={width:1,height:1,pixelRatio:1},ce=["width","height","pixelRatio"];class ue extends re{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio||0}get pixelHeight(){return this.height*this.pixelRatio||0}get pixelSnap(){return this.config.pixelSnap}set pixelSnap(t){this.config.pixelSnap=t}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,s){super(),this.size={},this.worldTransform={},t||(t=de),this.manager=s,this.innerId=i.create(i.CNAVAS);const{width:r,height:n,pixelRatio:o}=t;this.autoLayout=!r||!n,this.size.pixelRatio=o||e.devicePixelRatio,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t,e=!0){if(this.isSameSize(t))return;let i;this.context&&!this.unreal&&e&&this.width&&(i=this.getSameCanvas(),i.copyWorld(this));const s=this.size;g.copyAttrs(s,t,ce),ce.forEach(t=>s[t]||(s[t]=1)),this.bounds=new Lt(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&i&&(this.clearWorld(i.bounds),this.copyWorld(i),i.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:i,pixelSnap:s}=this,r=this.worldTransform;e&&oe(t,e,r),r.a=t.a*i,r.b=t.b*i,r.c=t.c*i,r.d=t.d*i,r.e=t.e*i,r.f=t.f*i,s&&(t.half&&t.half*i%2?(r.e=ae(r.e-.5)+.5,r.f=ae(r.f-.5)+.5):(r.e=ae(r.e),r.f=ae(r.f))),this.setTransform(r.a,r.b,r.c,r.d,r.e,r.f)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,i,s){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),i&&this.setStrokeOptions(i,s)}setStrokeOptions(t,e){let{strokeCap:i,strokeJoin:s,dashPattern:r,dashOffset:n,miterLimit:a}=t;e&&(e.strokeCap&&(i=e.strokeCap),e.strokeJoin&&(s=e.strokeJoin),o(e.dashPattern)||(r=e.dashPattern),o(e.dashOffset)||(n=e.dashOffset),e.miterLimit&&(a=e.miterLimit)),this.strokeCap=i,this.strokeJoin=s,this.dashPattern=r,this.dashOffset=n,this.miterLimit=a}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,i=1){return!0}setWorldShadow(t,e,i,s){const{pixelRatio:r}=this;this.shadowOffsetX=t*r,this.shadowOffsetY=e*r,this.shadowBlur=i*r,this.shadowColor=s||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,i,s,r=!0){s&&(this.blendMode=s),e?(this.setTempPixelBounds(e,r),i?(this.setTempPixelBounds2(i,r),i=le):i=he,this.drawImage(t.view,he.x,he.y,he.width,he.height,i.x,i.y,i.width,i.height)):this.drawImage(t.view,0,0),s&&(this.blendMode="source-over")}copyWorldToInner(t,e,i,s,r=!0){e.b||e.c?(this.save(),this.resetTransform(),this.copyWorld(t,e,Rt.tempToOuterOf(i,e),s,r),this.restore()):(s&&(this.blendMode=s),this.setTempPixelBounds(e,r),this.drawImage(t.view,he.x,he.y,he.width,he.height,i.x,i.y,i.width,i.height),s&&(this.blendMode="source-over"))}copyWorldByReset(t,e,i,s,r,n=!0){this.resetTransform(),this.copyWorld(t,e,i,s,n),r||this.useWorldTransform()}useGrayscaleAlpha(t){let e,i;this.setTempPixelBounds(t,!0,!0);const{context:s}=this,r=s.getImageData(he.x,he.y,he.width,he.height),{data:n}=r;for(let t=0,s=n.length;t<s;t+=4)i=.299*n[t]+.587*n[t+1]+.114*n[t+2],(e=n[t+3])&&(n[t+3]=255===e?i:e*(i/255));s.putImageData(r,he.x,he.y)}useMask(t,e,i){this.copyWorld(t,e,i,"destination-in")}useEraser(t,e,i){this.copyWorld(t,e,i,"destination-out")}fillWorld(t,e,i,s){i&&(this.blendMode=i),this.fillStyle=e,this.setTempPixelBounds(t,s),this.fillRect(he.x,he.y,he.width,he.height),i&&(this.blendMode="source-over")}strokeWorld(t,e,i,s){i&&(this.blendMode=i),this.strokeStyle=e,this.setTempPixelBounds(t,s),this.strokeRect(he.x,he.y,he.width,he.height),i&&(this.blendMode="source-over")}clipWorld(t,e=!0){this.beginPath(),this.setTempPixelBounds(t,e),this.rect(he.x,he.y,he.width,he.height),this.clip()}clipUI(t){t.windingRule?this.clip(t.windingRule):this.clip()}clearWorld(t,e=!0){this.setTempPixelBounds(t,e),this.clearRect(he.x,he.y,he.width,he.height)}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempPixelBounds(t,e,i){this.copyToPixelBounds(he,t,e,i)}setTempPixelBounds2(t,e,i){this.copyToPixelBounds(le,t,e,i)}copyToPixelBounds(t,e,i,s){t.set(e),s&&t.intersect(this.bounds),t.scale(this.pixelRatio),i&&t.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&(!t.pixelRatio||this.pixelRatio===t.pixelRatio)}getSameCanvas(t,e){const{size:i,pixelSnap:s}=this,r=this.manager?this.manager.get(i):Ht.canvas(Object.assign({},i));return r.save(),t&&(ne(r.worldTransform,this.worldTransform),r.useWorldTransform()),e&&(r.smooth=this.smooth),r.pixelSnap!==s&&(r.pixelSnap=s),r}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const _e={creator:{},parse(t,e){},convertToCanvasData(t,e){}},pe={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},ge=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},pe),fe={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},ye={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},ve=Object.assign(Object.assign({},ye),pe),me=ge,we={};for(let t in me)we[me[t]]=t;const xe={};for(let t in me)xe[me[t]]=fe[t];const be={drawRoundRect(t,e,i,s,r,n){const o=x.fourNumber(n,Math.min(s/2,r/2)),a=e+s,h=i+r;o[0]?t.moveTo(e+o[0],i):t.moveTo(e,i),o[1]?t.arcTo(a,i,a,h,o[1]):t.lineTo(a,i),o[2]?t.arcTo(a,h,e,h,o[2]):t.lineTo(a,h),o[3]?t.arcTo(e,h,e,i,o[3]):t.lineTo(e,h),o[0]?t.arcTo(e,i,a,i,o[0]):t.lineTo(e,i)}},{sin:Ee,cos:Pe,atan2:Be,ceil:ke,abs:Re,PI:Ce,sqrt:Te,pow:Se}=Math,{setPoint:Le,addPoint:Oe}=it,{set:De,toNumberPoints:Ie}=G,{M:Ae,L:Me,C:We,Q:Fe,Z:Ue}=ge,ze={},Ne={points(t,e,i,s){let r=Ie(e);if(t.push(Ae,r[0],r[1]),i&&r.length>5){let e,n,o,a,h,l,d,c,u,_,p,g,f,y=r.length;const v=!0===i?.5:i;s&&(r=[r[y-2],r[y-1],...r,r[0],r[1],r[2],r[3]],y=r.length);for(let i=2;i<y-2;i+=2)e=r[i-2],n=r[i-1],o=r[i],a=r[i+1],h=r[i+2],l=r[i+3],p=Te(Se(o-e,2)+Se(a-n,2)),g=Te(Se(h-o,2)+Se(l-a,2)),(p||g)&&(f=p+g,p=v*p/f,g=v*g/f,h-=e,l-=n,d=o-p*h,c=a-p*l,2===i?s||t.push(Fe,d,c,o,a):t.push(We,u,_,d,c,o,a),u=o+g*h,_=a+g*l);s||t.push(Fe,u,_,r[y-2],r[y-1])}else for(let e=2,i=r.length;e<i;e+=2)t.push(Me,r[e],r[e+1]);s&&t.push(Ue)},rect(t,e,i,s,r){_e.creator.path=t,_e.creator.moveTo(e,i).lineTo(e+s,i).lineTo(e+s,i+r).lineTo(e,i+r).lineTo(e,i)},roundRect(t,e,i,s,r,n){_e.creator.path=[],be.drawRoundRect(_e.creator,e,i,s,r,n),t.push(..._e.convertToCanvasData(_e.creator.path,!0))},arcTo(t,e,i,s,r,n,o,a,h,l,d){const c=s-e,u=r-i,_=n-s,p=o-r;let g=Be(u,c),f=Be(p,_),y=f-g;if(y<0&&(y+=P),y===Ce||Re(c+u)<1e-12||Re(_+p)<1e-12)return t&&t.push(Me,s,r),h&&(Le(h,e,i),Oe(h,s,r)),d&&De(d,e,i),void(l&&De(l,s,r));const v=c*p-_*u<0,m=v?-1:1,w=a/Pe(y/2),x=s+w*Pe(g+y/2+B*m),b=r+w*Ee(g+y/2+B*m);return g-=B*m,f-=B*m,He(t,x,b,a,a,0,g/E,f/E,v,h,l,d)},arc:(t,e,i,s,r,n,o,a,h,l)=>He(t,e,i,s,s,0,r,n,o,a,h,l),ellipse(t,e,i,s,r,n,o,a,h,l,d,c){const u=n*E,_=Ee(u),p=Pe(u);let g=o*E,f=a*E;g>Ce&&(g-=P),f<0&&(f+=P);let y=f-g;y<0?y+=P:y>P&&(y-=P),h&&(y-=P);const v=ke(Re(y/B)),m=y/v,w=Ee(m/4),x=8/3*w*w/Ee(m/2);f=g+m;let b,k,R,C,T,S,L,O,D=Pe(g),I=Ee(g),A=R=p*s*D-_*r*I,M=C=_*s*D+p*r*I,W=e+R,F=i+C;t&&t.push(t.length?Me:Ae,W,F),l&&Le(l,W,F),c&&De(c,W,F);for(let n=0;n<v;n++)b=Pe(f),k=Ee(f),R=p*s*b-_*r*k,C=_*s*b+p*r*k,T=e+A-x*(p*s*I+_*r*D),S=i+M-x*(_*s*I-p*r*D),L=e+R+x*(p*s*k+_*r*b),O=i+C+x*(_*s*k-p*r*b),t&&t.push(We,T,S,L,O,e+R,i+C),l&&Xe(e+A,i+M,T,S,L,O,e+R,i+C,l,!0),A=R,M=C,D=b,I=k,g=f,f+=m;d&&De(d,e+R,i+C)},quadraticCurveTo(t,e,i,s,r,n,o){t.push(We,(e+2*s)/3,(i+2*r)/3,(n+2*s)/3,(o+2*r)/3,n,o)},toTwoPointBoundsByQuadraticCurve(t,e,i,s,r,n,o,a){Xe(t,e,(t+2*i)/3,(e+2*s)/3,(r+2*i)/3,(n+2*s)/3,r,n,o,a)},toTwoPointBounds(t,e,i,s,r,n,o,a,h,l){const d=[];let c,u,_,p,g,f,y,v,m=t,w=i,x=r,b=o;for(let t=0;t<2;++t)if(1==t&&(m=e,w=s,x=n,b=a),c=-3*m+9*w-9*x+3*b,u=6*m-12*w+6*x,_=3*w-3*m,Math.abs(c)<1e-12){if(Math.abs(u)<1e-12)continue;p=-_/u,0<p&&p<1&&d.push(p)}else y=u*u-4*_*c,v=Math.sqrt(y),y<0||(g=(-u+v)/(2*c),0<g&&g<1&&d.push(g),f=(-u-v)/(2*c),0<f&&f<1&&d.push(f));l?Oe(h,t,e):Le(h,t,e),Oe(h,o,a);for(let l=0,c=d.length;l<c;l++)Ye(d[l],t,e,i,s,r,n,o,a,ze),Oe(h,ze.x,ze.y)},getPointAndSet(t,e,i,s,r,n,o,a,h,l){const d=1-t,c=d*d*d,u=3*d*d*t,_=3*d*t*t,p=t*t*t;l.x=c*e+u*s+_*n+p*a,l.y=c*i+u*r+_*o+p*h},getPoint(t,e,i,s,r,n,o,a,h){const l={};return Ye(t,e,i,s,r,n,o,a,h,l),l},getDerivative(t,e,i,s,r){const n=1-t;return 3*n*n*(i-e)+6*n*t*(s-i)+3*t*t*(r-s)}},{getPointAndSet:Ye,toTwoPointBounds:Xe,ellipse:He}=Ne,{sin:je,cos:Ve,sqrt:Ge,atan2:Ke}=Math,{ellipse:qe}=Ne,Ze={ellipticalArc(t,i,s,r,n,o,a,h,l,d,c){const u=(l-i)/2,_=(d-s)/2,p=o*E,g=je(p),f=Ve(p),y=-f*u-g*_,v=-f*_+g*u,m=r*r,w=n*n,x=v*v,b=y*y,B=m*w-m*x-w*b;let k=0;if(B<0){const t=Ge(1-B/(m*w));r*=t,n*=t}else k=(a===h?-1:1)*Ge(B/(m*x+w*b));const R=k*r*v/n,C=-k*n*y/r,T=Ke((v-C)/n,(y-R)/r),S=Ke((-v-C)/n,(-y-R)/r);let L=S-T;0===h&&L>0?L-=P:1===h&&L<0&&(L+=P);const O=i+u+f*R-g*C,D=s+_+g*R+f*C,I=L<0?1:0;c||e.ellipseToCurve?qe(t,O,D,r,n,o,T/E,S/E,I):r!==n||o?t.push(ge.G,O,D,r,n,o,T/E,S/E,I):t.push(ge.O,O,D,r,T/E,S/E,I)}},{M:$e,m:Qe,L:Je,l:ti,H:ei,h:ii,V:si,v:ri,C:ni,c:oi,S:ai,s:hi,Q:li,q:di,T:ci,t:ui,A:_i,a:pi,Z:gi,z:fi,N:yi,D:vi,X:mi,G:wi,F:xi,O:bi,P:Ei,U:Pi}=ge,{rect:Bi,roundRect:ki,arcTo:Ri,arc:Ci,ellipse:Ti,quadraticCurveTo:Si}=Ne,{ellipticalArc:Li}=Ze,Oi=Mt.get("PathConvert"),Di={},Ii={current:{dot:0},stringify(t,e){let i,s,r,n=0,o=t.length,a="";for(;n<o;){s=t[n],i=xe[s],a+=s===r?" ":we[s];for(let s=1;s<i;s++)a+=x.float(t[n+s],e),s===i-1||(a+=" ");r=s,n+=i}return a},parse(t,e){let i,s,r,n="";const o=[],a=e?ve:ye;for(let e=0,h=t.length;e<h;e++)s=t[e],It[s]?("."===s&&(Ai.dot&&(Mi(o,n),n=""),Ai.dot++),"0"===n&&"."!==s&&(Mi(o,n),n=""),n+=s):ge[s]?(n&&(Mi(o,n),n=""),Ai.name=ge[s],Ai.length=fe[s],Ai.index=0,Mi(o,Ai.name),!i&&a[s]&&(i=!0)):"-"===s||"+"===s?"e"===r||"E"===r?n+=s:(n&&Mi(o,n),n=s):n&&(Mi(o,n),n=""),r=s;return n&&Mi(o,n),i?Ii.toCanvasData(o,e):o},toCanvasData(t,e){let i,s,r,n,o,a=0,h=0,l=0,d=0,c=0,u=t.length;const _=[];for(;c<u;){switch(r=t[c],r){case Qe:t[c+1]+=a,t[c+2]+=h;case $e:a=t[c+1],h=t[c+2],_.push($e,a,h),c+=3;break;case ii:t[c+1]+=a;case ei:a=t[c+1],_.push(Je,a,h),c+=2;break;case ri:t[c+1]+=h;case si:h=t[c+1],_.push(Je,a,h),c+=2;break;case ti:t[c+1]+=a,t[c+2]+=h;case Je:a=t[c+1],h=t[c+2],_.push(Je,a,h),c+=3;break;case hi:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=ai;case ai:o=n===ni||n===ai,l=o?2*a-i:t[c+1],d=o?2*h-s:t[c+2],i=t[c+1],s=t[c+2],a=t[c+3],h=t[c+4],_.push(ni,l,d,i,s,a,h),c+=5;break;case oi:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,t[c+5]+=a,t[c+6]+=h,r=ni;case ni:i=t[c+3],s=t[c+4],a=t[c+5],h=t[c+6],_.push(ni,t[c+1],t[c+2],i,s,a,h),c+=7;break;case ui:t[c+1]+=a,t[c+2]+=h,r=ci;case ci:o=n===li||n===ci,i=o?2*a-i:t[c+1],s=o?2*h-s:t[c+2],e?Si(_,a,h,i,s,t[c+1],t[c+2]):_.push(li,i,s,t[c+1],t[c+2]),a=t[c+1],h=t[c+2],c+=3;break;case di:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=li;case li:i=t[c+1],s=t[c+2],e?Si(_,a,h,i,s,t[c+3],t[c+4]):_.push(li,i,s,t[c+3],t[c+4]),a=t[c+3],h=t[c+4],c+=5;break;case pi:t[c+6]+=a,t[c+7]+=h;case _i:Li(_,a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],e),a=t[c+6],h=t[c+7],c+=8;break;case fi:case gi:_.push(gi),c++;break;case yi:a=t[c+1],h=t[c+2],e?Bi(_,a,h,t[c+3],t[c+4]):Wi(_,t,c,5),c+=5;break;case vi:a=t[c+1],h=t[c+2],e?ki(_,a,h,t[c+3],t[c+4],[t[c+5],t[c+6],t[c+7],t[c+8]]):Wi(_,t,c,9),c+=9;break;case mi:a=t[c+1],h=t[c+2],e?ki(_,a,h,t[c+3],t[c+4],t[c+5]):Wi(_,t,c,6),c+=6;break;case wi:Ti(e?_:Wi(_,t,c,9),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],t[c+8],null,Di),a=Di.x,h=Di.y,c+=9;break;case xi:e?Ti(_,t[c+1],t[c+2],t[c+3],t[c+4],0,0,360,!1):Wi(_,t,c,5),a=t[c+1]+t[c+3],h=t[c+2],c+=5;break;case bi:Ci(e?_:Wi(_,t,c,7),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],null,Di),a=Di.x,h=Di.y,c+=7;break;case Ei:e?Ci(_,t[c+1],t[c+2],t[c+3],0,360,!1):Wi(_,t,c,4),a=t[c+1]+t[c+3],h=t[c+2],c+=4;break;case Pi:Ri(e?_:Wi(_,t,c,6),a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],null,Di),a=Di.x,h=Di.y,c+=6;break;default:return Oi.error(`command: ${r} [index:${c}]`,t),_}n=r}return _},objectToCanvasData(t){const e=[];return t.forEach(t=>{switch(t.name){case"M":e.push($e,t.x,t.y);break;case"L":e.push(Je,t.x,t.y);break;case"C":e.push(ni,t.x1,t.y1,t.x2,t.y2,t.x,t.y);break;case"Q":e.push(li,t.x1,t.y1,t.x,t.y);break;case"Z":e.push(gi)}}),e},copyData(t,e,i,s){for(let r=i,n=i+s;r<n;r++)t.push(e[r])},pushData(t,e){Ai.index===Ai.length&&(Ai.index=1,t.push(Ai.name)),t.push(Number(e)),Ai.index++,Ai.dot=0}},{current:Ai,pushData:Mi,copyData:Wi}=Ii,{M:Fi,L:Ui,C:zi,Q:Ni,Z:Yi,N:Xi,D:Hi,X:ji,G:Vi,F:Gi,O:Ki,P:qi,U:Zi}=ge,{getMinDistanceFrom:$i,getRadianFrom:Qi}=G,{tan:Ji,min:ts,abs:es}=Math,is={},ss={beginPath(t){t.length=0},moveTo(t,e,i){t.push(Fi,e,i)},lineTo(t,e,i){t.push(Ui,e,i)},bezierCurveTo(t,e,i,s,r,n,o){t.push(zi,e,i,s,r,n,o)},quadraticCurveTo(t,e,i,s,r){t.push(Ni,e,i,s,r)},closePath(t){t.push(Yi)},rect(t,e,i,s,r){t.push(Xi,e,i,s,r)},roundRect(t,e,i,s,r,n){if(d(n))t.push(ji,e,i,s,r,n);else{const o=x.fourNumber(n);o?t.push(Hi,e,i,s,r,...o):t.push(Xi,e,i,s,r)}},ellipse(t,e,i,s,r,n,o,h,l){a(n)?t.push(Gi,e,i,s,r):(a(o)&&(o=0),a(h)&&(h=360),t.push(Vi,e,i,s,r,n,o,h,l?1:0))},arc(t,e,i,s,r,n,o){a(r)?t.push(qi,e,i,s):(a(n)&&(n=360),t.push(Ki,e,i,s,r,n,o?1:0))},arcTo(t,e,i,s,r,n,a,h){if(!o(a)){const t=$i(a,h,e,i,s,r);n=ts(n,ts(t/2,t/2*es(Ji(Qi(a,h,e,i,s,r)/2))))}t.push(Zi,e,i,s,r,n)},drawEllipse(t,e,i,s,r,n,o,h,l){Ne.ellipse(null,e,i,s,r,a(n)?0:n,a(o)?0:o,a(h)?360:h,l,null,null,is),t.push(Fi,is.x,is.y),rs(t,e,i,s,r,n,o,h,l)},drawArc(t,e,i,s,r,n,o){Ne.arc(null,e,i,s,a(r)?0:r,a(n)?360:n,o,null,null,is),t.push(Fi,is.x,is.y),ns(t,e,i,s,r,n,o)},drawPoints(t,e,i,s){Ne.points(t,e,i,s)}},{ellipse:rs,arc:ns}=ss,{moveTo:os,lineTo:as,quadraticCurveTo:hs,bezierCurveTo:ls,closePath:ds,beginPath:cs,rect:us,roundRect:_s,ellipse:ps,arc:gs,arcTo:fs,drawEllipse:ys,drawArc:vs,drawPoints:ms}=ss;class ws{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?h(t)?_e.parse(t):t:[],this}beginPath(){return cs(this.__path),this.paint(),this}moveTo(t,e){return os(this.__path,t,e),this.paint(),this}lineTo(t,e){return as(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,i,s,r,n){return ls(this.__path,t,e,i,s,r,n),this.paint(),this}quadraticCurveTo(t,e,i,s){return hs(this.__path,t,e,i,s),this.paint(),this}closePath(){return ds(this.__path),this.paint(),this}rect(t,e,i,s){return us(this.__path,t,e,i,s),this.paint(),this}roundRect(t,e,i,s,r){return _s(this.__path,t,e,i,s,r),this.paint(),this}ellipse(t,e,i,s,r,n,o,a){return ps(this.__path,t,e,i,s,r,n,o,a),this.paint(),this}arc(t,e,i,s,r,n){return gs(this.__path,t,e,i,s,r,n),this.paint(),this}arcTo(t,e,i,s,r){return fs(this.__path,t,e,i,s,r),this.paint(),this}drawEllipse(t,e,i,s,r,n,o,a){return ys(this.__path,t,e,i,s,r,n,o,a),this.paint(),this}drawArc(t,e,i,s,r,n){return vs(this.__path,t,e,i,s,r,n),this.paint(),this}drawPoints(t,e,i){return ms(this.__path,t,e,i),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:xs,L:bs,C:Es,Q:Ps,Z:Bs,N:ks,D:Rs,X:Cs,G:Ts,F:Ss,O:Ls,P:Os,U:Ds}=ge,Is=Mt.get("PathDrawer"),As={drawPathByData(t,e){if(!e)return;let i,s=0,r=e.length;for(;s<r;)switch(i=e[s],i){case xs:t.moveTo(e[s+1],e[s+2]),s+=3;break;case bs:t.lineTo(e[s+1],e[s+2]),s+=3;break;case Es:t.bezierCurveTo(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5],e[s+6]),s+=7;break;case Ps:t.quadraticCurveTo(e[s+1],e[s+2],e[s+3],e[s+4]),s+=5;break;case Bs:t.closePath(),s+=1;break;case ks:t.rect(e[s+1],e[s+2],e[s+3],e[s+4]),s+=5;break;case Rs:t.roundRect(e[s+1],e[s+2],e[s+3],e[s+4],[e[s+5],e[s+6],e[s+7],e[s+8]]),s+=9;break;case Cs:t.roundRect(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]),s+=6;break;case Ts:t.ellipse(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]*E,e[s+6]*E,e[s+7]*E,e[s+8]),s+=9;break;case Ss:t.ellipse(e[s+1],e[s+2],e[s+3],e[s+4],0,0,P,!1),s+=5;break;case Ls:t.arc(e[s+1],e[s+2],e[s+3],e[s+4]*E,e[s+5]*E,e[s+6]),s+=7;break;case Os:t.arc(e[s+1],e[s+2],e[s+3],0,P,!1),s+=4;break;case Ds:t.arcTo(e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]),s+=6;break;default:return void Is.error(`command: ${i} [index:${s}]`,e)}}},{M:Ms,L:Ws,C:Fs,Q:Us,Z:zs,N:Ns,D:Ys,X:Xs,G:Hs,F:js,O:Vs,P:Gs,U:Ks}=ge,{toTwoPointBounds:qs,toTwoPointBoundsByQuadraticCurve:Zs,arcTo:$s,arc:Qs,ellipse:Js}=Ne,{addPointBounds:tr,copy:er,addPoint:ir,setPoint:sr,addBounds:rr,toBounds:nr}=it,or=Mt.get("PathBounds");let ar,hr,lr;const dr={},cr={},ur={},_r={toBounds(t,e){_r.toTwoPointBounds(t,cr),nr(cr,e)},toTwoPointBounds(t,e){if(!t||!t.length)return sr(e,0,0);let i,s,r,n,o,a=0,h=0,l=0;const d=t.length;for(;a<d;)switch(o=t[a],0===a&&(o===zs||o===Fs||o===Us?sr(e,h,l):sr(e,t[a+1],t[a+2])),o){case Ms:case Ws:h=t[a+1],l=t[a+2],ir(e,h,l),a+=3;break;case Fs:r=t[a+5],n=t[a+6],qs(h,l,t[a+1],t[a+2],t[a+3],t[a+4],r,n,dr),tr(e,dr),h=r,l=n,a+=7;break;case Us:i=t[a+1],s=t[a+2],r=t[a+3],n=t[a+4],Zs(h,l,i,s,r,n,dr),tr(e,dr),h=r,l=n,a+=5;break;case zs:a+=1;break;case Ns:h=t[a+1],l=t[a+2],rr(e,h,l,t[a+3],t[a+4]),a+=5;break;case Ys:case Xs:h=t[a+1],l=t[a+2],rr(e,h,l,t[a+3],t[a+4]),a+=o===Ys?9:6;break;case Hs:Js(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],dr,ur),0===a?er(e,dr):tr(e,dr),h=ur.x,l=ur.y,a+=9;break;case js:h=t[a+1],l=t[a+2],hr=t[a+3],lr=t[a+4],rr(e,h-hr,l-lr,2*hr,2*lr),h+=hr,a+=5;break;case Vs:Qs(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],dr,ur),0===a?er(e,dr):tr(e,dr),h=ur.x,l=ur.y,a+=7;break;case Gs:h=t[a+1],l=t[a+2],ar=t[a+3],rr(e,h-ar,l-ar,2*ar,2*ar),h+=ar,a+=4;break;case Ks:$s(null,h,l,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],dr,ur),0===a?er(e,dr):tr(e,dr),h=ur.x,l=ur.y,a+=6;break;default:return void or.error(`command: ${o} [index:${a}]`,t)}}},{M:pr,L:gr,Z:fr}=ge,{getCenterX:yr,getCenterY:vr}=G,{arcTo:mr}=ss,wr={smooth(t,e,i){let s,r,n,o=0,a=0,h=0,l=0,d=0,c=0,u=0,_=0,p=0;const g=t.length,f=[];for(;o<g;){switch(s=t[o],s){case pr:l=_=t[o+1],d=p=t[o+2],o+=3,t[o]===gr?(c=t[o+1],u=t[o+2],f.push(pr,yr(l,c),vr(d,u))):f.push(pr,l,d);break;case gr:switch(a=t[o+1],h=t[o+2],o+=3,t[o]){case gr:mr(f,a,h,t[o+1],t[o+2],e,_,p);break;case fr:mr(f,a,h,l,d,e,_,p);break;default:f.push(gr,a,h)}_=a,p=h;break;case fr:r!==fr&&(mr(f,l,d,c,u,e,_,p),f.push(fr)),o+=1;break;default:n=xe[s];for(let e=0;e<n;e++)f.push(t[o+e]);o+=n}r=s}return s!==fr&&(f[1]=l,f[2]=d),f}};_e.creator=new ws,_e.parse=Ii.parse,_e.convertToCanvasData=Ii.toCanvasData;const xr=new ws,{drawRoundRect:br}=be;function Er(t){!function(t){t&&!t.roundRect&&(t.roundRect=function(t,e,i,s,r){br(this,t,e,i,s,r)})}(t)}const Pr={alphaPixelTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:t=>!t||t.startsWith("image")?t:("jpg"===t&&(t="jpeg"),"image/"+t),fileType(t){const e=t.split(".");return e[e.length-1]},isOpaqueImage(t){const e=Br.fileType(t);return["jpg","jpeg"].some(t=>t===e)},getExportOptions(t){switch(typeof t){case"object":return t;case"number":return{quality:t};case"boolean":return{blob:t};default:return{}}}},Br=Pr;Br.alphaPixelTypes.forEach(t=>Br.upperCaseTypeMap[t]=t.toUpperCase());const kr=Mt.get("TaskProcessor");class Rr{constructor(t){this.parallel=!0,this.time=1,this.id=i.create(i.TASK),this.task=t}run(){return Jt(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){kr.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class Cr{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,i=0;for(let s=0;s<t;s++)s<=this.finishedIndex?(i+=this.list[s].time,s===this.finishedIndex&&(e=i)):e+=this.list[s].time;return this.isComplete?1:i/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&g.assign(this.config,t),this.empty()}add(t,e){let i,s,r,n;const a=new Rr(t);return a.parent=this,d(e)?n=e:e&&(s=e.parallel,i=e.start,r=e.time,n=e.delay),r&&(a.time=r),!1===s&&(a.parallel=!1),o(n)?this.push(a,i):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(a,i))},n)),this.isComplete=!1,a}push(t,e){this.list.push(t),!1===e||this.timer||(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(t=>{this.onError(t)}):this.nextTask()}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(t=>{this.onParallelError(t)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let i=this.index;i<e&&(t=this.list[i],t.parallel);i++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const i=e.length,s=this.finishedIndex+i;if(e.length){if(!this.running)return;s<this.total&&(t=this.list[s],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(t=>{t.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const Tr=Mt.get("Resource"),Sr={tasker:new Cr,map:{},get isComplete(){return Lr.tasker.isComplete},set(t,e){Lr.map[t]&&Tr.repeat(t),Lr.map[t]=e},get:t=>Lr.map[t],remove(t){const e=Lr.map[t];e&&(e.destroy&&e.destroy(),delete Lr.map[t])},loadImage(t,e){return new Promise((i,s)=>{const r=this.setImage(t,t,e);r.load(()=>i(r),t=>s(t))})},setImage(t,e,i){let s;return h(e)?s={url:e}:e.url||(s={url:t,view:e}),s&&(i&&(s.format=i),e=Ht.image(s)),Lr.set(t,e),e},destroy(){Lr.map={}}},Lr=Sr,Or={maxRecycled:10,recycledList:[],patternTasker:new Cr,get(t){let e=Sr.get(t.url);return e||Sr.set(t.url,e=Ht.image(t)),e.use++,e},recycle(t){t.use--,setTimeout(()=>{t.use||Dr.recycledList.push(t)})},clearRecycled(){const t=Dr.recycledList;t.length>Dr.maxRecycled&&(t.forEach(t=>!t.use&&t.url&&Sr.remove(t.url)),t.length=0)},hasAlphaPixel:t=>Pr.alphaPixelTypes.some(e=>Dr.isFormat(e,t)),isFormat(t,e){if(e.format===t)return!0;const{url:i}=e;if(i.startsWith("data:")){if(i.startsWith("data:"+Pr.mineType(t)))return!0}else{if(i.includes("."+t)||i.includes("."+Pr.upperCaseTypeMap[t]))return!0;if("png"===t&&!i.includes("."))return!0}return!1},destroy(){Dr.recycledList=[]}},Dr=Or,{IMAGE:Ir,create:Ar}=i,{floor:Mr,max:Wr}=Math;class Fr{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){if(this.use=0,this.waitComplete=[],this.innerId=Ar(Ir),this.config=t||(t={url:""}),t.view){const{view:e}=t;this.setView(e.config?e.view:e)}Or.isFormat("svg",t)&&(this.isSVG=!0),Or.hasAlphaPixel(t)&&(this.hasAlphaPixel=!0)}load(t,i){if(!this.loading){this.loading=!0;let{loadImage:t,loadImageWithProgress:i}=e.origin,s=this.config.showProgress&&i&&this.onProgress.bind(this);s&&(t=i),Sr.tasker.add(()=>Jt(this,void 0,void 0,function*(){return yield t(this.url,s).then(t=>this.setView(t)).catch(t=>{this.error=t,this.onComplete(!1)})}))}return this.waitComplete.push(t,i),this.waitComplete.length-2}unload(t,e){const i=this.waitComplete;if(e){const e=i[t+1];e&&e({type:"stop"})}i[t]=i[t+1]=void 0}setView(t){this.ready=!0,this.width=t.naturalWidth||t.width,this.height=t.naturalHeight||t.height,this.view=t,this.onComplete(!0)}onProgress(t){this.progress=t}onComplete(t){let e;this.waitComplete.forEach((i,s)=>{e=s%2,i&&(t?e||i(this):e&&i(this.error))}),this.waitComplete.length=0,this.loading=!1}getFull(t){return this.view}getCanvas(t,i,s,r,n,o){if(t||(t=this.width),i||(i=this.height),this.cache){let{params:t,data:e}=this.cache;for(let i in t)if(t[i]!==arguments[i]){e=null;break}if(e)return e}const a=e.origin.createCanvas(Wr(Mr(t+(n||0)),1),Wr(Mr(i+(o||0)),1)),h=a.getContext("2d");return s&&(h.globalAlpha=s),h.drawImage(this.view,0,0,t,i),this.cache=this.use>1?{data:a,params:arguments}:null,a}getPattern(t,i,s,r){const n=e.canvas.createPattern(t,i);try{s&&n.setTransform&&(n.setTransform(s),s=void 0)}catch(t){}return r&&g.stintSet(r,"transform",s),n}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Ur(t,e,i,s){s||(i.configurable=i.enumerable=!0),Object.defineProperty(t,e,i)}function zr(t,e){return Object.getOwnPropertyDescriptor(t,e)}function Nr(t,e){const i="_"+t;return{get(){const t=this[i];return null==t?e:t},set(t){this[i]=t}}}function Yr(t,e){return(i,s)=>Hr(i,s,t,e&&e(s))}function Xr(t){return t}function Hr(t,e,i,s){const r={get(){return this.__getAttr(e)},set(t){this.__setAttr(e,t)}};Ur(t,e,Object.assign(r,s||{})),vn(t,e,i)}function jr(t){return Yr(t)}function Vr(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Gr(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__scrollWorld||(this.__scrollWorld={}))}}))}function Kr(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal(),Jr(this))}}))}function qr(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i,e)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function Zr(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i,e)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function $r(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i,e)&&Jr(this)}}))}function Qr(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(Jr(this),this.__.__removeNaturalSize())}}))}function Jr(t){t.__layout.boxChanged||t.__layout.boxChange(),t.__hasAutoLayout&&(t.__layout.matrixChanged||t.__layout.matrixChange())}function tn(t){return Yr(t,t=>({set(e){const i=this.__;2!==i.__pathInputed&&(i.__pathInputed=e?1:0),e||(i.__pathForRender=void 0),this.__setAttr(t,e),Jr(this)}}))}const en=$r;function sn(t,e){return Yr(t,t=>({set(i){this.__setAttr(t,i)&&(rn(this),e&&(this.__.__useStroke=!0))}}))}function rn(t){t.__layout.strokeChanged||t.__layout.strokeChange(),t.__.__useArrow&&Jr(t)}const nn=sn;function on(t){return Yr(t,t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}}))}function an(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function hn(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange()),this.mask&&dn(this)}}))}function ln(t){return Yr(t,t=>({set(e){const i=this.visible;if(!0===i&&0===e){if(this.animationOut)return this.__runAnimation("out",()=>cn(this,t,e,i))}else 0===i&&!0===e&&this.animation&&this.__runAnimation("in");cn(this,t,e,i),this.mask&&dn(this)}}))}function dn(t){const{parent:e}=t;if(e){const{__hasMask:t}=e;e.__updateMask(),t!==e.__hasMask&&e.forceUpdate()}}function cn(t,e,i,s){t.__setAttr(e,i)&&(t.__layout.opacityChanged||t.__layout.opacityChange(),0!==s&&0!==i||Jr(t))}function un(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function _n(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(e)}))}}))}function pn(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&this.waitParent(()=>{this.parent.__updateEraser(e)})}}))}function gn(t){return Yr(t,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,"hit"===Mt.showBounds&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function fn(t){return Yr(t,t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}}))}function yn(t){return(e,i)=>{Ur(e,"__DataProcessor",{get:()=>t})}}function vn(t,e,i){const s=t.__DataProcessor.prototype,r="_"+e,n=function(t){return"set"+t.charAt(0).toUpperCase()+t.slice(1)}(e),a=Nr(e,i);if(o(i))a.get=function(){return this[r]};else if("function"==typeof i)a.get=function(){const t=this[r];return null==t?i(this.__leaf):t};else if(_(i)){const t=p(i);a.get=function(){const e=this[r];return null==e?this[r]=t?{}:g.clone(i):e}}const h=t.isBranchLeaf;"width"===e?a.get=function(){const t=this[r];if(null==t){const t=this,e=t.__naturalWidth,s=t.__leaf;return!i||s.pathInputed?s.boxBounds.width:e?t._height&&t.__useNaturalRatio?t._height*e/t.__naturalHeight:e:h&&s.children.length?s.boxBounds.width:i}return t}:"height"===e&&(a.get=function(){const t=this[r];if(null==t){const t=this,e=t.__naturalHeight,s=t.__leaf;return!i||s.pathInputed?s.boxBounds.height:e?t._width&&t.__useNaturalRatio?t._width*e/t.__naturalWidth:e:h&&s.children.length?s.boxBounds.height:i}return t});let l,d=s;for(;!l&&d;)l=zr(d,e),d=d.__proto__;l&&l.set&&(a.set=l.set),s[n]&&(a.set=s[n],delete s[n]),Ur(s,e,a)}const mn=new Mt("rewrite"),wn=[],xn=["destroy","constructor"];function bn(t){return(e,i)=>{wn.push({name:e.constructor.name+"."+i,run:()=>{e[i]=t}})}}function En(){return t=>{Pn()}}function Pn(t){wn.length&&(wn.forEach(e=>{t&&mn.error(e.name,"Class@rewriteAble()"),e.run()}),wn.length=0)}function Bn(t,e){return i=>{var s;(t.prototype?(s=t.prototype,Object.getOwnPropertyNames(s)):Object.keys(t)).forEach(s=>{if(!(xn.includes(s)||e&&e.includes(s)))if(t.prototype){zr(t.prototype,s).writable&&(i.prototype[s]=t.prototype[s])}else i.prototype[s]=t[s]})}}function kn(){return t=>{Vt.register(t)}}function Rn(){return t=>{qt.register(t)}}setTimeout(()=>Pn(!0));const{copy:Cn,toInnerPoint:Tn,toOuterPoint:Sn,scaleOfOuter:Ln,rotateOfOuter:On,skewOfOuter:Dn,multiplyParent:In,divideParent:An,getLayout:Mn}=M,Wn={},{round:Fn}=Math,Un={updateAllMatrix(t,e,i){if(e&&t.__hasAutoLayout&&t.__layout.matrixChanged&&(i=!0),Yn(t,e,i),t.isBranch){const{children:s}=t;for(let t=0,r=s.length;t<r;t++)Nn(s[t],e,i)}},updateMatrix(t,e,i){const s=t.__layout;e?i&&(s.waitAutoLayout=!0,t.__hasAutoLayout&&(s.matrixChanged=!1)):s.waitAutoLayout&&(s.waitAutoLayout=!1),s.matrixChanged&&t.__updateLocalMatrix(),s.waitAutoLayout||t.__updateWorldMatrix()},updateBounds(t){const e=t.__layout;e.boundsChanged&&t.__updateLocalBounds(),e.waitAutoLayout||t.__updateWorldBounds()},updateAllWorldOpacity(t){if(t.__updateWorldOpacity(),t.isBranch){const{children:e}=t;for(let t=0,i=e.length;t<i;t++)Xn(e[t])}},updateChange(t){const e=t.__layout;e.stateStyleChanged&&t.updateState(),e.opacityChanged&&Xn(t),t.__updateChange()},updateAllChange(t){if(jn(t),t.isBranch){const{children:e}=t;for(let t=0,i=e.length;t<i;t++)Hn(e[t])}},worldHittable(t){for(;t;){if(!t.__.hittable)return!1;t=t.parent}return!0},draggable:t=>(t.draggable||t.editable)&&t.hitSelf&&!t.locked,copyCanvasByWorld(t,i,s,r,n,o){r||(r=t.__nowWorld),t.__worldFlipped||e.fullImageShadow?i.copyWorldByReset(s,r,t.__nowWorld,n,o):i.copyWorldToInner(s,r,t.__layout.renderBounds,n)},moveWorld(t,e,i=0,s,r){const n=_(e)?Object.assign({},e):{x:e,y:i};s?Sn(t.localTransform,n,n,!0):t.parent&&Tn(t.parent.scrollWorldTransform,n,n,!0),zn.moveLocal(t,n.x,n.y,r)},moveLocal(t,e,i=0,s){_(e)&&(i=e.y,e=e.x),e+=t.x,i+=t.y,t.leafer&&t.leafer.config.pointSnap&&(e=Fn(e),i=Fn(i)),s?t.animate({x:e,y:i},s):(t.x=e,t.y=i)},zoomOfWorld(t,e,i,s,r,n){zn.zoomOfLocal(t,Vn(t,e),i,s,r,n)},zoomOfLocal(t,e,i,s=i,r,n){const o=t.__localMatrix;if(d(s)||(s&&(n=s),s=i),Cn(Wn,o),Ln(Wn,e,i,s),zn.hasHighPosition(t))zn.setTransform(t,Wn,r,n);else{const e=t.x+Wn.e-o.e,a=t.y+Wn.f-o.f;n&&!r?t.animate({x:e,y:a,scaleX:t.scaleX*i,scaleY:t.scaleY*s},n):(t.x=e,t.y=a,t.scaleResize(i,s,!0!==r))}},rotateOfWorld(t,e,i,s){zn.rotateOfLocal(t,Vn(t,e),i,s)},rotateOfLocal(t,e,i,s){const r=t.__localMatrix;Cn(Wn,r),On(Wn,e,i),zn.hasHighPosition(t)?zn.setTransform(t,Wn,!1,s):t.set({x:t.x+Wn.e-r.e,y:t.y+Wn.f-r.f,rotation:x.formatRotation(t.rotation+i)},s)},skewOfWorld(t,e,i,s,r,n){zn.skewOfLocal(t,Vn(t,e),i,s,r,n)},skewOfLocal(t,e,i,s=0,r,n){Cn(Wn,t.__localMatrix),Dn(Wn,e,i,s),zn.setTransform(t,Wn,r,n)},transformWorld(t,e,i,s){Cn(Wn,t.worldTransform),In(Wn,e),t.parent&&An(Wn,t.parent.scrollWorldTransform),zn.setTransform(t,Wn,i,s)},transform(t,e,i,s){Cn(Wn,t.localTransform),In(Wn,e),zn.setTransform(t,Wn,i,s)},setTransform(t,e,i,s){const r=t.__,n=r.origin&&zn.getInnerOrigin(t,r.origin),o=Mn(e,n,r.around&&zn.getInnerOrigin(t,r.around));if(zn.hasOffset(t)&&(o.x-=r.offsetX,o.y-=r.offsetY),i){const e=o.scaleX/t.scaleX,i=o.scaleY/t.scaleY;if(delete o.scaleX,delete o.scaleY,n){Rt.scale(t.boxBounds,Math.abs(e),Math.abs(i));const s=zn.getInnerOrigin(t,r.origin);G.move(o,n.x-s.x,n.y-s.y)}t.set(o),t.scaleResize(e,i,!1)}else t.set(o,s)},getFlipTransform(t,e){const i={a:1,b:0,c:0,d:1,e:0,f:0},s="x"===e?1:-1;return Ln(i,zn.getLocalOrigin(t,"center"),-1*s,1*s),i},getLocalOrigin:(t,e)=>G.tempToOuterOf(zn.getInnerOrigin(t,e),t.localTransform),getInnerOrigin(t,e){const i={};return at.toPoint(e,t.boxBounds,i),i},getRelativeWorld:(t,e,i)=>(Cn(Wn,t.worldTransform),An(Wn,e.scrollWorldTransform),i?Wn:Object.assign({},Wn)),drop(t,e,i,s){t.setTransform(zn.getRelativeWorld(t,e,!0),s),e.add(t,i)},hasHighPosition:t=>t.origin||t.around||zn.hasOffset(t),hasOffset:t=>t.offsetX||t.offsetY,hasParent(t,e){if(!e)return!1;for(;t;){if(e===t)return!0;t=t.parent}},animateMove(t,i,s=.3){if(i.x||i.y)if(Math.abs(i.x)<1&&Math.abs(i.y)<1)t.move(i);else{const r=i.x*s,n=i.y*s;i.x-=r,i.y-=n,t.move(r,n),e.requestRender(()=>zn.animateMove(t,i,s))}}},zn=Un,{updateAllMatrix:Nn,updateMatrix:Yn,updateAllWorldOpacity:Xn,updateAllChange:Hn,updateChange:jn}=zn;function Vn(t,e){return t.parent?G.tempToInnerOf(e,t.parent.scrollWorldTransform):e}const Gn={worldBounds:t=>t.__world,localBoxBounds:t=>t.__.eraser||0===t.__.visible?null:t.__local||t.__layout,localStrokeBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localStrokeBounds,localRenderBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localRenderBounds,maskLocalBoxBounds:(t,e)=>qn(t,e)&&t.__localBoxBounds,maskLocalStrokeBounds:(t,e)=>qn(t,e)&&t.__layout.localStrokeBounds,maskLocalRenderBounds:(t,e)=>qn(t,e)&&t.__layout.localRenderBounds,excludeRenderBounds:(t,e)=>!(!e.bounds||e.bounds.hit(t.__world,e.matrix))||!(!e.hideBounds||!e.hideBounds.includes(t.__world,e.matrix))};let Kn;function qn(t,e){return e||(Kn=0),t.__.mask&&(Kn=1),Kn<0?null:(Kn&&(Kn=-1),!0)}const{updateBounds:Zn}=Un,$n={sort:(t,e)=>t.__.zIndex===e.__.zIndex?t.__tempNumber-e.__tempNumber:t.__.zIndex-e.__.zIndex,pushAllChildBranch(t,e){if(t.__tempNumber=1,t.__.__childBranchNumber){const{children:i}=t;for(let s=0,r=i.length;s<r;s++)(t=i[s]).isBranch&&(t.__tempNumber=1,e.add(t),Qn(t,e))}},pushAllParent(t,e){const{keys:i}=e;if(i)for(;t.parent&&o(i[t.parent.innerId]);)e.add(t.parent),t=t.parent;else for(;t.parent;)e.add(t.parent),t=t.parent},pushAllBranchStack(t,e){let i=e.length;const{children:s}=t;for(let t=0,i=s.length;t<i;t++)s[t].isBranch&&e.push(s[t]);for(let t=i,s=e.length;t<s;t++)Jn(e[t],e)},updateBounds(t,e){const i=[t];Jn(t,i),to(i,e)},updateBoundsByBranchStack(t,e){let i,s;for(let r=t.length-1;r>-1;r--){i=t[r],s=i.children;for(let t=0,e=s.length;t<e;t++)Zn(s[t]);e&&e===i||Zn(i)}}},{pushAllChildBranch:Qn,pushAllBranchStack:Jn,updateBoundsByBranchStack:to}=$n,eo={run(t){if(t&&t.length){const e=t.length;for(let i=0;i<e;i++)t[i]();t.length===e?t.length=0:t.splice(0,e)}}},{getRelativeWorld:io,updateBounds:so}=Un,{toOuterOf:ro,getPoints:no,copy:oo}=Rt,ao="_localContentBounds",ho="_worldContentBounds",lo="_worldBoxBounds",co="_worldStrokeBounds";class uo{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}set renderBounds(t){this._renderBounds=t}get localContentBounds(){return ro(this.contentBounds,this.leaf.__localMatrix,this[ao]||(this[ao]={})),this[ao]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return ro(this.contentBounds,this.leaf.__world,this[ho]||(this[ho]={})),this[ho]}get worldBoxBounds(){return ro(this.boxBounds,this.leaf.__world,this[lo]||(this[lo]={})),this[lo]}get worldStrokeBounds(){return ro(this.strokeBounds,this.leaf.__world,this[co]||(this[co]={})),this[co]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),t.__world&&(this.boxBounds={x:0,y:0,width:0,height:0},this.boxChange(),this.matrixChange())}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leaf:t}=this,{leafer:i}=t;if(t.isApp)return so(t);if(i)i.ready?i.watcher.changed&&i.layouter.layout():i.start();else{let i=t;for(;i.parent&&!i.parent.leafer;)i=i.parent;const s=i;if(s.__fullLayouting)return;s.__fullLayouting=!0,e.layout(s),delete s.__fullLayouting}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return M.defaultMatrix;case"page":t=e.zoomLayer;default:return io(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new Lt(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",i){const{leaf:s}=this;let r,n,o,a=this.getInnerBounds(t);switch(e){case"world":r=s.getWorldPoint(a),n=s.__world;break;case"local":const{scaleX:t,scaleY:i,rotation:h,skewX:l,skewY:d}=s.__;o={scaleX:t,scaleY:i,rotation:h,skewX:l,skewY:d},r=s.getLocalPointByInner(a);break;case"inner":r=a,n=M.defaultMatrix;break;case"page":e=s.zoomLayer;default:r=s.getWorldPoint(a,e),n=io(s,e,!0)}if(o||(o=M.getLayout(n)),oo(o,a),G.copy(o,r),i){const{scaleX:t,scaleY:e}=o,i=Math.abs(t),s=Math.abs(e);1===i&&1===s||(o.scaleX/=i,o.scaleY/=s,o.width*=i,o.height*=s)}return o}getLayoutPoints(t,e="world"){const{leaf:i}=this,s=no(this.getInnerBounds(t));let r;switch(e){case"world":r=null;break;case"local":r=i.parent;break;case"inner":break;case"page":e=i.zoomLayer;default:r=e}return o(r)||s.forEach(t=>i.innerToWorld(t,null,!1,r)),s}shrinkContent(){const{x:t,y:e,width:i,height:s}=this.boxBounds;this._contentBounds={x:t,y:e,width:i,height:s}}spreadStroke(){const{x:t,y:e,width:i,height:s}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:i,height:s},this._localStrokeBounds={x:t,y:e,width:i,height:s},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:i,height:s}=this.renderBounds;this._renderBounds={x:t,y:e,width:i,height:s},this._localRenderBounds={x:t,y:e,width:i,height:s}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged?this.boundsChanged||(this.boundsChanged=!0):this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=this.affectChildrenSort=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class _o{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&e.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&e.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&e.event.stop(this.origin)}}class po extends _o{constructor(t,e,i){super(t,e),this.parent=i,this.child=e}}po.ADD="child.add",po.REMOVE="child.remove",po.CREATED="created",po.MOUNTED="mounted",po.UNMOUNTED="unmounted",po.DESTROY="destroy";const go="property.scroll";class fo extends _o{constructor(t,e,i,s,r){super(t,e),this.attrName=i,this.oldValue=s,this.newValue=r}}fo.CHANGE="property.change",fo.LEAFER_CHANGE="property.leafer_change",fo.SCROLL=go;const yo={scrollX:go,scrollY:go};class vo extends _o{constructor(t,e){super(t),Object.assign(this,e)}}vo.LOAD="image.load",vo.LOADED="image.loaded",vo.ERROR="image.error";class mo extends _o{static checkHas(t,e,i){"on"===i?e===Eo?t.__hasWorldEvent=!0:t.__hasLocalEvent=!0:(t.__hasLocalEvent=t.hasEvent(wo)||t.hasEvent(xo)||t.hasEvent(bo),t.__hasWorldEvent=t.hasEvent(Eo))}static emitLocal(t){if(t.leaferIsReady){const{resized:e}=t.__layout;"local"!==e&&(t.emit(wo,t),"inner"===e&&t.emit(xo,t)),t.emit(bo,t)}}static emitWorld(t){t.leaferIsReady&&t.emit(Eo,this)}}mo.RESIZE="bounds.resize",mo.INNER="bounds.inner",mo.LOCAL="bounds.local",mo.WORLD="bounds.world";const{RESIZE:wo,INNER:xo,LOCAL:bo,WORLD:Eo}=mo,Po={};[wo,xo,bo,Eo].forEach(t=>Po[t]=1);class Bo extends _o{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,e){_(t)?(super(Bo.RESIZE),Object.assign(this,t)):super(t),this.old=e}static isResizing(t){return this.resizingKeys&&!o(this.resizingKeys[t.innerId])}}Bo.RESIZE="resize";class ko extends _o{constructor(t,e){super(t),this.data=e}}ko.REQUEST="watch.request",ko.DATA="watch.data";class Ro extends _o{constructor(t,e,i){super(t),e&&(this.data=e,this.times=i)}}Ro.REQUEST="layout.request",Ro.START="layout.start",Ro.BEFORE="layout.before",Ro.LAYOUT="layout",Ro.AFTER="layout.after",Ro.AGAIN="layout.again",Ro.END="layout.end";class Co extends _o{constructor(t,e,i,s){super(t),e&&(this.times=e),i&&(this.renderBounds=i,this.renderOptions=s)}}Co.REQUEST="render.request",Co.CHILD_START="render.child_start",Co.CHILD_END="render.child_end",Co.START="render.start",Co.BEFORE="render.before",Co.RENDER="render",Co.AFTER="render.after",Co.AGAIN="render.again",Co.END="render.end",Co.NEXT="render.next";class To extends _o{}To.START="leafer.start",To.BEFORE_READY="leafer.before_ready",To.READY="leafer.ready",To.AFTER_READY="leafer.after_ready",To.VIEW_READY="leafer.view_ready",To.VIEW_COMPLETED="leafer.view_completed",To.STOP="leafer.stop",To.RESTART="leafer.restart",To.END="leafer.end",To.TRANSFORM="leafer.transform",To.MOVE="leafer.move",To.SCALE="leafer.scale",To.ROTATE="leafer.rotate",To.SKEW="leafer.skew";const{MOVE:So,SCALE:Lo,ROTATE:Oo,SKEW:Do}=To,Io={x:So,y:So,scaleX:Lo,scaleY:Lo,rotation:Oo,skewX:Do,skewY:Do},Ao={};class Mo{set event(t){this.on(t)}on(t,e,i){if(!e){let e;if(u(t))t.forEach(t=>this.on(t[0],t[1],t[2]));else for(let i in t)u(e=t[i])?this.on(i,e[0],e[1]):this.on(i,e);return}let s,r,n;i&&("once"===i?r=!0:"boolean"==typeof i?s=i:(s=i.capture,r=i.once));const o=Wo(this,s,!0),a=h(t)?t.split(" "):t,l=r?{listener:e,once:r}:{listener:e};a.forEach(t=>{t&&(n=o[t],n?-1===n.findIndex(t=>t.listener===e)&&n.push(l):o[t]=[l],Po[t]&&mo.checkHas(this,t,"on"))})}off(t,e,i){if(t){const s=h(t)?t.split(" "):t;if(e){let t,r,n;i&&(t="boolean"==typeof i?i:"once"!==i&&i.capture);const o=Wo(this,t);s.forEach(t=>{t&&(r=o[t],r&&(n=r.findIndex(t=>t.listener===e),n>-1&&r.splice(n,1),r.length||delete o[t],Po[t]&&mo.checkHas(this,t,"off")))})}else{const{__bubbleMap:t,__captureMap:e}=this;s.forEach(i=>{t&&delete t[i],e&&delete e[i]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,i,s){return e?this.on(t,i?e=e.bind(i):e,s):u(t)&&t.forEach(t=>this.on(t[0],t[2]?t[1]=t[1].bind(t[2]):t[1],t[3])),{type:t,current:this,listener:e,options:s}}off_(t){if(!t)return;const e=u(t)?t:[t];e.forEach(t=>{t&&(t.listener?t.current.off(t.type,t.listener,t.options):u(t.type)&&t.type.forEach(e=>t.current.off(e[0],e[1],e[3])))}),e.length=0}once(t,e,i,s){if(!e)return u(t)&&t.forEach(t=>this.once(t[0],t[1],t[2],t[3]));_(i)?e=e.bind(i):s=i,this.on(t,e,{once:!0,capture:s})}emit(t,e,i){!e&&qt.has(t)&&(e=qt.get(t,{type:t,target:this,current:this}));const s=Wo(this,i)[t];if(s){let r;for(let n=0,o=s.length;n<o&&!((r=s[n])&&(r.listener(e),r.once&&(this.off(t,r.listener,i),n--,o--),e&&e.isStopNow));n++);}this.syncEventer&&this.syncEventer.emitEvent(e,i)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:i,__captureMap:s}=this,r=i&&i[t],n=s&&s[t];return!!(o(e)?r||n:e?n:r)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Wo(t,e,i){if(e){const{__captureMap:e}=t;return e||(i?t.__captureMap={}:Ao)}{const{__bubbleMap:e}=t;return e||(i?t.__bubbleMap={}:Ao)}}const{on:Fo,on_:Uo,off:zo,off_:No,once:Yo,emit:Xo,emitEvent:Ho,hasEvent:jo,destroy:Vo}=Mo.prototype,Go={on:Fo,on_:Uo,off:zo,off_:No,once:Yo,emit:Xo,emitEvent:Ho,hasEvent:jo,destroyEventer:Vo},Ko=Mt.get("setAttr"),qo={__setAttr(t,e,i){if(this.leaferIsCreated){const s=this.__.__getInput(t);if(!i||l(e)||o(e)||(Ko.warn(this.innerName,t,e),e=void 0),_(e)||s!==e){if(this.__realSetAttr(t,e),this.isLeafer){this.emitEvent(new fo(fo.LEAFER_CHANGE,this,t,s,e));const i=Io[t];i&&(this.emitEvent(new To(i,this)),this.emitEvent(new To(To.TRANSFORM,this)))}this.emitPropertyEvent(fo.CHANGE,t,s,e);const i=yo[t];return i&&this.emitPropertyEvent(i,t,s,e),!0}return!1}return this.__realSetAttr(t,e),!0},emitPropertyEvent(t,e,i,s){const r=new fo(t,this,e,i,s);this.isLeafer||this.hasEvent(t)&&this.emitEvent(r),this.leafer.emitEvent(r)},__realSetAttr(t,e){const i=this.__;i[t]=e,this.__proxyData&&this.setProxyAttr(t,e),i.normalStyle&&(this.lockNormalStyle||o(i.normalStyle[t])||(i.normalStyle[t]=e))},__getAttr(t){return this.__proxyData?this.getProxyAttr(t):this.__.__get(t)}},{setLayout:Zo,multiplyParent:$o,translateInner:Qo,defaultWorld:Jo}=M,{toPoint:ta,tempPoint:ea}=at,ia={__updateWorldMatrix(){const{parent:t,__layout:e,__world:i,__scrollWorld:s,__:r}=this;$o(this.__local||e,t?t.__scrollWorld||t.__world:Jo,i,!!e.affectScaleOrRotation,r),s&&Qo(Object.assign(s,i),r.scrollX,r.scrollY)},__updateLocalMatrix(){if(this.__local){const t=this.__layout,e=this.__local,i=this.__;t.affectScaleOrRotation&&(t.scaleChanged&&(t.resized||(t.resized="scale"))||t.rotationChanged)&&(Zo(e,i,null,null,t.affectRotation),t.scaleChanged=t.rotationChanged=void 0),e.e=i.x+i.offsetX,e.f=i.y+i.offsetY,(i.around||i.origin)&&(ta(i.around||i.origin,t.boxBounds,ea),Qo(e,-ea.x,-ea.y,!i.around))}this.__layout.matrixChanged=void 0}},{updateMatrix:sa,updateAllMatrix:ra}=Un,{updateBounds:na}=$n,{toOuterOf:oa,copyAndSpread:aa,copy:ha}=Rt,{toBounds:la}=_r,da={__updateWorldBounds(){const t=this.__layout;oa(t.renderBounds,this.__world,this.__world),t.resized&&("inner"===t.resized&&this.__onUpdateSize(),this.__hasLocalEvent&&mo.emitLocal(this),t.resized=void 0),this.__hasWorldEvent&&mo.emitWorld(this)},__updateLocalBounds(){const t=this.__layout;t.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),t.resized="inner"),t.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),t.localBoxChanged=void 0,t.strokeSpread&&(t.strokeChanged=!0),t.renderSpread&&(t.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),t.boxChanged=void 0,t.strokeChanged&&(t.strokeSpread=this.__updateStrokeSpread(),t.strokeSpread?(t.strokeBounds===t.boxBounds&&t.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):t.spreadStrokeCancel(),t.strokeChanged=void 0,(t.renderSpread||t.strokeSpread!==t.strokeBoxSpread)&&(t.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),t.resized="inner"),t.renderChanged&&(t.renderSpread=this.__updateRenderSpread(),t.renderSpread?(t.renderBounds!==t.boxBounds&&t.renderBounds!==t.strokeBounds||t.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):t.spreadRenderCancel(),t.renderChanged=void 0,this.parent&&this.parent.__layout.renderChange()),t.resized||(t.resized="local"),t.boundsChanged=void 0},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),oa(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){oa(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){oa(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(t,e){const i=this.__layout.boxBounds,s=this.__;s.__pathInputed?la(s.path,i):(i.x=0,i.y=0,i.width=s.width,i.height=s.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.__extraUpdate(),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),ra(this),na(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(ra(this),na(this,this))):sa(this)},__updateNaturalSize(){const{__:t,__layout:e}=this;t.__naturalWidth=e.boxBounds.width,t.__naturalHeight=e.boxBounds.height},__updateStrokeBounds(t){const e=this.__layout;aa(e.strokeBounds,e.boxBounds,e.strokeBoxSpread)},__updateRenderBounds(t){const e=this.__layout;e.renderSpread>0?aa(e.renderBounds,e.boxBounds,e.renderSpread):ha(e.renderBounds,e.strokeBounds)}},ca={__render(t,e){if(e.shape)return this.__renderShape(t,e);if(this.__worldOpacity){const i=this.__;if(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),t.opacity=e.dimOpacity&&!i.dimskip?i.opacity*e.dimOpacity:i.opacity,this.__.__single){if("path"===i.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!0,!0);this.__draw(s,e,t),Un.copyCanvasByWorld(this,t,s,this.__nowWorld,i.__blendMode,!0),s.recycle(this.__nowWorld)}else this.__draw(t,e);Mt.showBounds&&Mt.drawBounds(this,t,e)}},__renderShape(t,e){this.__worldOpacity&&(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),this.__drawShape(t,e))},__clip(t,e){this.__worldOpacity&&(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),this.__drawRenderPath(t),t.clipUI(this))},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:ua}=Gn,_a={__updateChange(){const{__layout:t}=this;t.childrenSortChanged&&(this.__updateSortChildren(),t.childrenSortChanged=!1),this.__.__checkSingle()},__render(t,e){if(this.__nowWorld=this.__getNowWorld(e),this.__worldOpacity){const i=this.__;if(i.dim?e.dimOpacity=!0===i.dim?.2:i.dim:i.dimskip&&e.dimOpacity&&(e.dimOpacity=0),i.__single&&!this.isBranchLeaf){if("path"===i.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!1,!0);this.__renderBranch(s,e);const r=this.__nowWorld;t.opacity=e.dimOpacity?i.opacity*e.dimOpacity:i.opacity,t.copyWorldByReset(s,r,r,i.__blendMode,!0),s.recycle(r)}else this.__renderBranch(t,e)}},__renderBranch(t,e){if(this.__hasMask)this.__renderMask(t,e);else{const{children:i}=this;for(let s=0,r=i.length;s<r;s++)ua(i[s],e)||i[s].__render(t,e)}},__clip(t,e){if(this.__worldOpacity){const{children:i}=this;for(let s=0,r=i.length;s<r;s++)ua(i[s],e)||i[s].__clip(t,e)}}},pa={},{LEAF:ga,create:fa}=i,{toInnerPoint:ya,toOuterPoint:va,multiplyParent:ma}=M,{toOuterOf:wa}=Rt,{copy:xa,move:ba}=G,{moveLocal:Ea,zoomOfLocal:Pa,rotateOfLocal:Ba,skewOfLocal:ka,moveWorld:Ra,zoomOfWorld:Ca,rotateOfWorld:Ta,skewOfWorld:Sa,transform:La,transformWorld:Oa,setTransform:Da,getFlipTransform:Ia,getLocalOrigin:Aa,getRelativeWorld:Ma,drop:Wa}=Un;t.Leaf=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return y}get __LayoutProcessor(){return uo}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get scrollWorldTransform(){return this.updateLayout(),this.__scrollWorld||this.__world}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.updateLayout(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){return this.leaferIsCreated&&this.leafer.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=fa(ga),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(po.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),0!==t&&(this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},null!==t&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0})),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(po.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(po.MOUNTED,t,"once")}nextRender(t,e,i){this.leafer?this.leafer.nextRender(t,e,i):this.waitLeafer(()=>this.leafer.nextRender(t,e,i))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&null!==t&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(po.MOUNTED)):this.__emitLifeEvent(po.UNMOUNTED),this.isBranch){const{children:e}=this;for(let i=0,s=e.length;i<s;i++)e[i].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){o(t)?t="width":"surface"===t&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=o(e)?null:void 0,this[t]=e}forceRender(t,e){this.forceUpdate("surface")}__extraUpdate(){this.leaferIsReady&&this.leafer.layouter.addExtra(this)}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(t,e){}__updateContentBounds(){}__updateStrokeBounds(t){}__updateRenderBounds(t){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=!!t||this.children.some(t=>t.__.eraser)}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:i}=this.__layout;t.clearRect(i.x,i.y,i.width,i.height),t.restore()}__updateMask(t){this.__hasMask=this.children.some(t=>t.__.mask&&t.__.visible&&t.__.opacity)}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld,i=this.__world;return ma(i,t.matrix,e,void 0,i),wa(this.__layout.renderBounds,e,e),e.half!==i.half&&(e.half=i.half),e}return this.__world}getClampRenderScale(){let{scaleX:t}=this.__nowWorld||this.__world;return t<0&&(t=-t),t>1?t:1}getRenderScaleData(t,e){let{scaleX:i,scaleY:s}=Or.patternLocked?this.__world:this.__nowWorld;return t&&(i<0&&(i=-i),s<0&&(s=-s)),(!0===e||"zoom-in"===e&&i>1&&s>1)&&(i=s=1),pa.scaleX=i,pa.scaleY=s,pa}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,i){return this.__layout.getLayoutBounds(t,e,i)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,i){const s=e?Ma(this,e):this.worldTransform,r=i?t:{};return wa(t,s,r),r}worldToLocal(t,e,i,s){this.parent?this.parent.worldToInner(t,e,i,s):e&&xa(e,t)}localToWorld(t,e,i,s){this.parent?this.parent.innerToWorld(t,e,i,s):e&&xa(e,t)}worldToInner(t,e,i,s){s&&(s.innerToWorld(t,e,i),t=e||t),ya(this.scrollWorldTransform,t,e,i)}innerToWorld(t,e,i,s){va(this.scrollWorldTransform,t,e,i),s&&s.worldToInner(e||t,null,i)}getBoxPoint(t,e,i,s){return this.getBoxPointByInner(this.getInnerPoint(t,e,i,s),null,null,!0)}getBoxPointByInner(t,e,i,s){const r=s?t:Object.assign({},t),{x:n,y:o}=this.boxBounds;return ba(r,-n,-o),r}getInnerPoint(t,e,i,s){const r=s?t:{};return this.worldToInner(t,r,i,e),r}getInnerPointByBox(t,e,i,s){const r=s?t:Object.assign({},t),{x:n,y:o}=this.boxBounds;return ba(r,n,o),r}getInnerPointByLocal(t,e,i,s){return this.getInnerPoint(t,this.parent,i,s)}getLocalPoint(t,e,i,s){const r=s?t:{};return this.worldToLocal(t,r,i,e),r}getLocalPointByInner(t,e,i,s){return this.getWorldPoint(t,this.parent,i,s)}getPagePoint(t,e,i,s){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,i,s)}getWorldPoint(t,e,i,s){const r=s?t:{};return this.innerToWorld(t,r,i,e),r}getWorldPointByBox(t,e,i,s){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,s),e,i,!0)}getWorldPointByLocal(t,e,i,s){const r=s?t:{};return this.localToWorld(t,r,i,e),r}getWorldPointByPage(t,e,i,s){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,i,s)}setTransform(t,e,i){Da(this,t,e,i)}transform(t,e,i){La(this,t,e,i)}move(t,e,i){Ea(this,t,e,i)}moveInner(t,e,i){Ra(this,t,e,!0,i)}scaleOf(t,e,i,s,r){Pa(this,Aa(this,t),e,i,s,r)}rotateOf(t,e,i){Ba(this,Aa(this,t),e,i)}skewOf(t,e,i,s,r){ka(this,Aa(this,t),e,i,s,r)}transformWorld(t,e,i){Oa(this,t,e,i)}moveWorld(t,e,i){Ra(this,t,e,!1,i)}scaleOfWorld(t,e,i,s,r){Ca(this,t,e,i,s,r)}rotateOfWorld(t,e){Ta(this,t,e)}skewOfWorld(t,e,i,s,r){Sa(this,t,e,i,s,r)}flip(t,e){La(this,Ia(this,t),!1,e)}scaleResize(t,e=t,i){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}hit(t,e){return!0}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e,i){}__clip(t,e){}__renderShape(t,e){}__drawShape(t,e){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Xt.need("path")}getMotionPoint(t){return Xt.need("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,i){Wa(this,t,e,i)}on(t,e,i){}off(t,e,i){}on_(t,e,i,s){}off_(t){}once(t,e,i,s){}emit(t,e,i){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,i){i?this.addAttr(t,e,i):vn(this.prototype,t,e)}static addAttr(t,e,i,s){i||(i=$r),i(e,s)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new po(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(po.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}},t.Leaf=Qt([Bn(qo),Bn(ia),Bn(da),Bn(Go),Bn(ca)],t.Leaf);const{setListWithFn:Fa}=Rt,{sort:Ua}=$n,{localBoxBounds:za,localStrokeBounds:Na,localRenderBounds:Ya,maskLocalBoxBounds:Xa,maskLocalStrokeBounds:Ha,maskLocalRenderBounds:ja}=Gn,Va=new Mt("Branch");t.Branch=class extends t.Leaf{__updateStrokeSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,i=t.length;e<i;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(t,e){Fa(e||this.__layout.boxBounds,this.children,this.__hasMask?Xa:za)}__updateStrokeBounds(t){Fa(t||this.__layout.strokeBounds,this.children,this.__hasMask?Ha:Na)}__updateRenderBounds(t){Fa(t||this.__layout.renderBounds,this.children,this.__hasMask?ja:Ya)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let i=0,s=e.length;i<s;i++)e[i].__tempNumber=i,e[i].__.zIndex&&(t=!0);e.sort(Ua),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this||t.destroyed)return Va.warn("add self or destroyed");const i=o(e);if(!t.__){if(u(t))return t.forEach(t=>{this.add(t,e),i||e++});t=Vt.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,i?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1);const s=t.__layout;s.boxChanged||s.boxChange(),s.matrixChanged||s.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(po.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(po.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",()=>this.__remove(t,e)):this.__remove(t,e):this.find(t).forEach(t=>this.remove(t,e)):o(t)&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach(e=>{this.__realRemoveChild(e),t&&e.destroy()}))}clear(){this.removeAll(!0)}__remove(t,e){const i=this.children.indexOf(t);i>-1&&(this.children.splice(i,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(po.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(po.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const i=new po(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(i),this.leafer.emitEvent(i)}},t.Branch=Qt([Bn(_a)],t.Branch);class Ga{get length(){return this.list.length}constructor(t){this.reset(),t&&(u(t)?this.addList(t):this.add(t))}has(t){return t&&!o(this.keys[t.innerId])}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return o(e)?-1:e}add(t){const{list:e,keys:i}=this;o(i[t.innerId])&&(e.push(t),i[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:i}=this;if(o(i[t.innerId])){const{list:s}=this;for(let t=e,r=s.length;t<r;t++)i[s[t].innerId]++;0===e?s.unshift(t):(e>s.length&&(e=s.length),s.splice(e,0,t)),i[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let i;for(let s=0,r=e.length;s<r;s++)o(i)?e[s].innerId===t.innerId&&(i=s,delete this.keys[t.innerId]):this.keys[e[s].innerId]=s-1;o(i)||e.splice(i,1)}sort(t){const{list:e}=this;t?e.sort((t,e)=>e.__level-t.__level):e.sort((t,e)=>t.__level-e.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new Ga;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let i=0,s=t.length;i<s;i++)e[t[i].innerId]=i}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class Ka{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(u(t)?this.addList(t):this.add(t))}has(t){return!o(this.keys[t.innerId])}without(t){return o(this.keys[t.innerId])}sort(t){const{levels:e}=this;t?e.sort((t,e)=>e-t):e.sort((t,e)=>t-e)}addList(t){t.forEach(t=>{this.add(t)})}add(t){const{keys:e,levelMap:i}=this;e[t.innerId]||(e[t.innerId]=1,i[t.__level]?i[t.__level].push(t):(i[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach(i=>{e=this.levelMap[i];for(let i=0,s=e.length;i<s;i++)t(e[i])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}const qa=Mt.get("LeaferCanvas");class Za extends ue{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:i}=this;if(e&&i){const s=i.children[t];s?(this.setAbsolute(s),i.insertBefore(e,s)):i.appendChild(s)}}init(){const{config:t}=this,i=t.view||t.canvas;i?this.__createViewFrom(i):this.__createView();const{style:s}=this.view;if(s.display||(s.display="block"),this.parentView=this.view.parentElement,this.parentView){const t=this.parentView.style;t.webkitUserSelect=t.userSelect="none"}e.syncDomFont&&!this.parentView&&(s.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return"none"!==this.view.style.pointerEvents}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e=h(t)?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let t=e;if(e===window||e===document){const e=document.createElement("div"),{style:i}=e;i.position="absolute",i.top=i.bottom=i.left=i.right="0px",document.body.appendChild(e),t=e}this.__createView();const i=this.view;t.hasChildNodes()&&(this.setAbsolute(i),t.style.position||(t.style.position="relative")),t.appendChild(i)}else qa.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:i}=this,{style:s}=this.view;s.width=t+"px",s.height=e+"px",this.view.width=Math.ceil(t*i),this.view.height=Math.ceil(e*i)}updateClientBounds(){this.view.parentElement&&(this.clientBounds=this.view.getBoundingClientRect())}startAutoLayout(t,i){if(this.resizeListener=i,t){this.autoBounds=t;try{this.resizeObserver=new ResizeObserver(t=>{this.updateClientBounds();for(const e of t)this.checkAutoBounds(e.contentRect)});const t=this.parentView;t?(this.resizeObserver.observe(t),this.checkAutoBounds(t.getBoundingClientRect())):(this.checkAutoBounds(this.view),qa.warn("no parent"))}catch(t){this.imitateResizeObserver()}}else window.addEventListener("resize",this.windowListener=()=>{const t=e.devicePixelRatio;if(!this.config.pixelRatio&&this.pixelRatio!==t){const{width:e,height:i}=this;this.emitResize({width:e,height:i,pixelRatio:t})}})}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),e.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const i=this.view,{x:s,y:r,width:n,height:o}=this.autoBounds.getBoundsFrom(t),a={width:n,height:o,pixelRatio:this.config.pixelRatio?this.pixelRatio:e.devicePixelRatio};if(!this.isSameSize(a)){const{style:t}=i;t.marginLeft=s+"px",t.marginTop=r+"px",this.emitResize(a)}}stopAutoLayout(){this.autoLayout=!1,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeListener=this.resizeObserver=null}emitResize(t){const e={};g.copyAttrs(e,this,ce),this.resize(t),this.resizeListener&&!o(this.width)&&this.resizeListener(new Bo(t,e))}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),this.windowListener&&(window.removeEventListener("resize",this.windowListener),this.windowListener=null),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}Er(CanvasRenderingContext2D.prototype),Er(Path2D.prototype);const{mineType:$a,fileType:Qa}=Pr;function Ja(t,i){e.origin={createCanvas(t,e){const i=document.createElement("canvas");return i.width=t,i.height=e,i},canvasToDataURL:(t,e,i)=>{const s=$a(e),r=t.toDataURL(s,i);return"image/bmp"===s?r.replace("image/png;","image/bmp;"):r},canvasToBolb:(t,e,i)=>new Promise(s=>t.toBlob(s,$a(e),i)),canvasSaveAs:(t,i,s)=>{const r=t.toDataURL($a(Qa(i)),s);return e.origin.download(r,i)},download:(t,e)=>new Promise(i=>{let s=document.createElement("a");s.href=t,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s),i()}),loadImage:t=>new Promise((i,s)=>{const r=new e.origin.Image,{crossOrigin:n}=e.image;n&&(r.setAttribute("crossOrigin",n),r.crossOrigin=n),r.onload=()=>{i(r)},r.onerror=t=>{s(t)},r.src=e.image.getRealURL(t)}),Image:Image,PointerEvent:PointerEvent,DragEvent:DragEvent},e.event={stopDefault(t){t.preventDefault()},stopNow(t){t.stopImmediatePropagation()},stop(t){t.stopPropagation()}},e.canvas=Ht.canvas(),e.conicGradientSupport=!!e.canvas.context.createConicGradient}Object.assign(Ht,{canvas:(t,e)=>new Za(t,e),image:t=>new Fr(t)}),e.name="web",e.isMobile="ontouchstart"in window,e.requestRender=function(t){window.requestAnimationFrame(t)},Ur(e,"devicePixelRatio",{get:()=>devicePixelRatio});const{userAgent:th}=navigator;th.indexOf("Firefox")>-1?(e.conicGradientRotate90=!0,e.intWheelDeltaY=!0,e.syncDomFont=!0):(/iPhone|iPad|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent))&&(e.fullImageShadow=!0),th.indexOf("Windows")>-1?(e.os="Windows",e.intWheelDeltaY=!0):th.indexOf("Mac")>-1?e.os="Mac":th.indexOf("Linux")>-1&&(e.os="Linux");class eh{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new Ga;return this.__updatedList.list.forEach(e=>{e.leafer&&t.add(e)}),t}return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new Ga,this.target=t,e&&(this.config=g.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(Co.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===po.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let t=0,i=e.length;t<i;t++)this.__pushChild(e[t])}__onRquestData(){this.target.emitEvent(new ko(ko.DATA,{updatedList:this.updatedList})),this.__updatedList=new Ga,this.totalTimes++,this.changed=this.hasVisible=this.hasRemove=this.hasAdd=!1}__listenEvents(){this.__eventIds=[this.target.on_([[fo.CHANGE,this.__onAttrChange,this],[[po.ADD,po.REMOVE],this.__onChildEvent,this],[ko.REQUEST,this.__onRquestData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.__updatedList=null)}}const{updateAllMatrix:ih,updateBounds:sh,updateChange:rh}=Un,{pushAllChildBranch:nh,pushAllParent:oh}=$n;const{worldBounds:ah}=Gn;class hh{constructor(t){this.updatedBounds=new Lt,this.beforeBounds=new Lt,this.afterBounds=new Lt,u(t)&&(t=new Ga(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,ah)}setAfter(){this.afterBounds.setListWithFn(this.updatedList.list,ah),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:lh,updateAllChange:dh}=Un,ch=Mt.get("Layouter");class uh{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new Ka,this.target=t,e&&(this.config=g.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(this.layouting||!this.running)return;const{target:t}=this;this.times=0;try{t.emit(Ro.START),this.layoutOnce(),t.emitEvent(new Ro(Ro.END,this.layoutedBlocks,this.times))}catch(t){ch.error(t)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?ch.warn("layouting"):this.times>3?ch.warn("layout max times"):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(ko.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){var t;if(!(null===(t=this.__updatedList)||void 0===t?void 0:t.length))return;const e=zt.start("PartLayout"),{target:i,__updatedList:s}=this,{BEFORE:r,LAYOUT:n,AFTER:o}=Ro,a=this.getBlocks(s);a.forEach(t=>t.setBefore()),i.emitEvent(new Ro(r,a,this.times)),this.extraBlock=null,s.sort(),function(t,e){let i;t.list.forEach(t=>{i=t.__layout,e.without(t)&&!i.proxyZoom&&(i.matrixChanged?(ih(t,!0),e.add(t),t.isBranch&&nh(t,e),oh(t,e)):i.boundsChanged&&(e.add(t),t.isBranch&&(t.__tempNumber=0),oh(t,e)))})}(s,this.__levelList),function(t){let e,i,s;t.sort(!0),t.levels.forEach(r=>{e=t.levelMap[r];for(let t=0,r=e.length;t<r;t++){if(i=e[t],i.isBranch&&i.__tempNumber){s=i.children;for(let t=0,e=s.length;t<e;t++)s[t].isBranch||sh(s[t])}sh(i)}})}(this.__levelList),function(t){t.list.forEach(rh)}(s),this.extraBlock&&a.push(this.extraBlock),a.forEach(t=>t.setAfter()),i.emitEvent(new Ro(n,a,this.times)),i.emitEvent(new Ro(o,a,this.times)),this.addBlocks(a),this.__levelList.reset(),this.__updatedList=null,zt.end(e)}fullLayout(){const t=zt.start("FullLayout"),{target:e}=this,{BEFORE:i,LAYOUT:s,AFTER:r}=Ro,n=this.getBlocks(new Ga(e));e.emitEvent(new Ro(i,n,this.times)),uh.fullLayout(e),n.forEach(t=>{t.setAfter()}),e.emitEvent(new Ro(s,n,this.times)),e.emitEvent(new Ro(r,n,this.times)),this.addBlocks(n),zt.end(t)}static fullLayout(t){lh(t,!0),t.isBranch?$n.updateBounds(t):Un.updateBounds(t),dh(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:i}=this.extraBlock||(this.extraBlock=new hh([]));e.length?i.add(t.__world):i.set(t.__world),e.add(t)}}createBlock(t){return new hh(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){this.__eventIds=[this.target.on_([[Ro.REQUEST,this.layout,this],[Ro.AGAIN,this.layoutAgain,this],[ko.DATA,this.__onReceiveWatchData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const _h=Mt.get("Renderer");class ph{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(t,e,i){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,i&&(this.config=g.default(i,this.config)),this.__listenEvents()}start(){this.running=!0,this.update(!1)}stop(){this.running=!1}update(t=!0){this.changed||(this.changed=t),this.__requestRender()}requestLayout(){this.target.emit(Ro.REQUEST)}checkRender(){if(this.running){const{target:t}=this;t.isApp&&(t.emit(Co.CHILD_START,t),t.children.forEach(t=>{t.renderer.FPS=this.FPS,t.renderer.checkRender()}),t.emit(Co.CHILD_END,t)),this.changed&&this.canvas.view&&this.render(),this.target.emit(Co.NEXT)}}render(t){if(!this.running||!this.canvas.view)return this.update();const{target:e}=this;this.times=0,this.totalBounds=new Lt,_h.log(e.innerName,"---\x3e");try{this.emitRender(Co.START),this.renderOnce(t),this.emitRender(Co.END,this.totalBounds),Or.clearRecycled()}catch(t){this.rendering=!1,_h.error(t)}_h.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return _h.warn("rendering");if(this.times>3)return _h.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new Lt,this.renderOptions={},t)this.emitRender(Co.BEFORE),t();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(Co.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(Co.RENDER,this.renderBounds,this.renderOptions),this.emitRender(Co.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;e&&(this.mergeBlocks(),e.forEach(e=>{t.bounds.hit(e)&&!e.isEmpty()&&this.clipRender(e)}))}clipRender(t){const e=zt.start("PartRender"),{canvas:i}=this,s=t.getIntersect(i.bounds),r=new Lt(s);i.save(),s.spread(ph.clipSpread).ceil(),i.clearWorld(s),i.clipWorld(s),this.__render(s,r),i.restore(),zt.end(e)}fullRender(){const t=zt.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds),e.restore(),zt.end(t)}__render(t,e){const{canvas:i}=this,s=t.includes(this.target.__world),r=s?{includes:s}:{bounds:t,includes:s};this.needFill&&i.fillWorld(t,this.config.fill),Mt.showRepaint&&Mt.drawRepaint(i,t),this.target.__render(i,r),this.renderBounds=e=e||t,this.renderOptions=r,this.totalBounds.isEmpty()?this.totalBounds=e:this.totalBounds.add(e),i.updateRender(e)}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new Lt;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=this.target;if(this.requestTime||!t)return;if(t.parentApp)return t.parentApp.requestRender(!1);const i=this.requestTime=Date.now();e.requestRender(()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-i))),this.requestTime=0,this.checkRender()})}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:i}=t.old;if(!new Lt(0,0,e,i).includes(this.target.__world)||this.needFill||!t.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate("surface")}this.addBlock(new Lt(0,0,1,1)),this.update()}}__onLayoutEnd(t){t.data&&t.data.map(t=>{let e;t.updatedList&&t.updatedList.list.some(t=>(e=!t.__world.width||!t.__world.height,e&&(t.isLeafer||_h.tip(t.innerName,": empty"),e=!t.isBranch||t.isBranchLeaf),e)),this.addBlock(e?this.canvas.bounds:t.updatedBounds)})}emitRender(t,e,i){this.target.emitEvent(new Co(t,this.times,e,i))}__listenEvents(){this.__eventIds=[this.target.on_([[Co.REQUEST,this.update,this],[Ro.END,this.__onLayoutEnd,this],[Co.AGAIN,this.renderAgain,this],[Bo.RESIZE,this.__onResize,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}ph.clipSpread=10;const{hitRadiusPoint:gh}=Rt;class fh{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,i){e||(e=0),i||(i={});const s=i.through||!1,r=i.ignoreHittable||!1,n=i.target||this.target;this.exclude=i.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new Ga(i.findList),i.findList||this.hitBranch(n.isBranchLeaf?{children:[n]}:n);const{list:o}=this.findList,a=this.getBestMatchLeaf(o,i.bottomList,r),h=r?this.getPath(a):this.getHitablePath(a);return this.clear(),s?{path:h,target:a,throughPath:o.length?this.getThroughPath(o):h}:{path:h,target:a}}hitPoint(t,e,i){return!!this.getByPoint(t,e,i).target}getBestMatchLeaf(t,e,i){const s=this.findList=new Ga;if(t.length){let e;const{x:r,y:n}=this.point,o={x:r,y:n,radiusX:0,radiusY:0};for(let r=0,n=t.length;r<n;r++)if(e=t[r],(i||Un.worldHittable(e))&&(this.hitChild(e,o),s.length)){if(e.isBranchLeaf&&t.some(t=>t!==e&&Un.hasParent(t,e))){s.reset();break}return s.list[0]}}if(e)for(let t=0,i=e.length;t<i;t++)if(this.hitChild(e[t].target,this.point,e[t].proxy),s.length)return s.list[0];return i?t[0]:t.find(t=>Un.worldHittable(t))}getPath(t){const e=new Ga;for(;t;)e.add(t),t=t.parent;return this.target&&e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let i,s=new Ga;for(let t=e.list.length-1;t>-1&&(i=e.list[t],i.__.hittable)&&(s.addAt(i,0),i.__.hitChildren);t--);return s}getThroughPath(t){const e=new Ga,i=[];for(let e=t.length-1;e>-1;e--)i.push(this.getPath(t[e]));let s,r,n;for(let t=0,o=i.length;t<o;t++){s=i[t],r=i[t+1];for(let t=0,i=s.length;t<i&&(n=s.list[t],!r||!r.has(n));t++)e.add(n)}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let i,s;const{point:r}=this;for(let n=t.length-1;n>-1;n--)i=t[n],!i.__.visible||e&&!i.__.mask||(s=!!i.__.hitRadius||gh(i.__world,r),i.isBranch?(s||i.__ignoreHitWorld)&&(i.topChildren&&this.eachFind(i.topChildren,!1),this.eachFind(i.children,i.__onlyHitMask),i.isBranchLeaf&&this.hitChild(i,r)):s&&this.hitChild(i,r))}hitChild(t,e,i){if((!this.exclude||!this.exclude.has(t))&&t.__hitWorld(e)){const{parent:s}=t;if(s&&s.__hasMask&&!t.__.mask){let i,r=[];const{children:n}=s;for(let s=0,o=n.length;s<o;s++)if(i=n[s],i.__.mask&&r.push(i),i===t){if(r&&!r.every(t=>t.__hitWorld(e)))return;break}}this.findList.add(i||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}class yh{constructor(t,e){this.config={},e&&(this.config=g.default(e,this.config)),this.picker=new fh(this.target=t,this),this.finder=Ht.finder&&Ht.finder()}getByPoint(t,i,s){const{target:r,picker:n}=this;return e.backgrounder&&r&&r.updateLayout(),n.getByPoint(t,i,s)}hitPoint(t,e,i){return this.picker.hitPoint(t,e,i)}getBy(t,e,i,s){return this.finder?this.finder.getBy(t,e,i,s):Xt.need("find")}destroy(){this.picker.destroy(),this.finder&&this.finder.destroy()}}function vh(t){return Yr(t,t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function mh(t){return Yr(t,t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function wh(){return(t,e)=>{const i="_"+e;Ur(t,e,{set(t){this.isLeafer&&(this[i]=t)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[i]||this:this.leafer&&this.leafer.zoomLayer}})}}Object.assign(Ht,{watcher:(t,e)=>new eh(t,e),layouter:(t,e)=>new uh(t,e),renderer:(t,e,i)=>new ph(t,e,i),selector:(t,e)=>new yh(t,e)}),e.layout=uh.fullLayout;const xh={},bh={hasTransparent:function(t){if(!t||7===t.length||4===t.length)return!1;if("transparent"===t)return!0;const e=t[0];if("#"===e)switch(t.length){case 5:return"f"!==t[4]&&"F"!==t[4];case 9:return"f"!==t[7]&&"F"!==t[7]||"f"!==t[8]&&"F"!==t[8]}else if(("r"===e||"h"===e)&&"a"===t[3]){const e=t.lastIndexOf(",");if(e>-1)return parseFloat(t.slice(e+1))<1}return!1}},Eh={number:(t,e)=>_(t)?"percent"===t.type?t.value*e:t.value:t},Ph={},Bh={},kh={},Rh={},Ch={},Th={apply(){Xt.need("filter")}},Sh={},Lh={setStyleName:()=>Xt.need("state"),set:()=>Xt.need("state")},Oh={list:{},register(t,e){Oh.list[t]=e},get:t=>Oh.list[t]},{parse:Dh,objectToCanvasData:Ih}=Ii,{stintSet:Ah}=g,{hasTransparent:Mh}=bh,Wh={},Fh=Mt.get("UIData");class Uh extends y{get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get __strokeWidth(){return this.__getRealStrokeWidth()}get __maxStrokeWidth(){const t=this;return t.__hasMultiStrokeStyle?Math.max(t.__hasMultiStrokeStyle,t.strokeWidth):t.strokeWidth}get __hasMultiPaint(){const t=this;return t.fill&&this.__useStroke||t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect}get __clipAfterFill(){const t=this;return t.cornerRadius||t.innerShadow||t.__pathInputed}get __hasSurface(){return this.fill||this.stroke}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:e}=this.__leaf;e&&(e.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Fh.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Fh.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),h(t)||!t?(Ah(this,"__isTransparentFill",Mh(t)),this.__isFills&&this.__removePaint("fill",!0),this._fill=t):_(t)&&this.__setPaint("fill",t)}setStroke(t){h(t)||!t?(Ah(this,"__isTransparentStroke",Mh(t)),this.__isStrokes&&this.__removePaint("stroke",!0),this._stroke=t):_(t)&&this.__setPaint("stroke",t)}setPath(t){const e=h(t);e||t&&_(t[0])?(this.__setInput("path",t),this._path=e?Dh(t):Ih(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){zh(this,"shadow",t)}setInnerShadow(t){zh(this,"innerShadow",t)}setFilter(t){zh(this,"filter",t)}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&Bh.compute("fill",this.__leaf),e&&Bh.compute("stroke",this.__leaf),this.__needComputePaint=void 0}__getRealStrokeWidth(t){let{strokeWidth:e,strokeWidthFixed:i}=this;if(t&&(t.strokeWidth&&(e=t.strokeWidth),o(t.strokeWidthFixed)||(i=t.strokeWidthFixed)),i){const t=this.__leaf.getClampRenderScale();return t>1?e/t:e}return e}__setPaint(t,e){this.__setInput(t,e);const i=this.__leaf.__layout;i.boxChanged||i.boxChange(),u(e)&&!e.length?this.__removePaint(t):"fill"===t?(this.__isFills=!0,this._fill||(this._fill=Wh)):(this.__isStrokes=!0,this._stroke||(this._stroke=Wh))}__removePaint(t,e){e&&this.__removeInput(t),kh.recycleImage(t,this),"fill"===t?(Ah(this,"__isAlphaPixelFill",void 0),this._fill=this.__isFills=void 0):(Ah(this,"__isAlphaPixelStroke",void 0),Ah(this,"__hasMultiStrokeStyle",void 0),this._stroke=this.__isStrokes=void 0)}}function zh(t,e,i){t.__setInput(e,i),u(i)?(i.some(t=>!1===t.visible)&&(i=i.filter(t=>!1!==t.visible)),i.length||(i=void 0)):i=i&&!1!==i.visible?[i]:void 0,t["_"+e]=i}class Nh extends Uh{}class Yh extends Nh{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.__single||this.__clipAfterFill}get __clipAfterFill(){const t=this;return"show"!==t.overflow&&t.__leaf.children.length&&(t.__leaf.isOverflow||super.__clipAfterFill)}}class Xh extends Nh{__getInputData(t,e){const i=super.__getInputData(t,e);return ce.forEach(t=>delete i[t]),i}}class Hh extends Yh{}class jh extends Uh{}class Vh extends Uh{get __boxStroke(){return!this.__pathInputed}}class Gh extends Uh{get __boxStroke(){return!this.__pathInputed}}class Kh extends Uh{}class qh extends Uh{}class Zh extends Uh{get __pathInputed(){return 2}}class $h extends Nh{}const Qh={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class Jh extends Uh{get __useNaturalRatio(){return!1}setFontWeight(t){h(t)?(this.__setInput("fontWeight",t),t=Qh[t]||400):this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t}setBoxStyle(t){let e=this.__leaf,i=e.__box;if(t){const{boxStyle:s}=this;if(i)for(let t in s)i[t]=void 0;else i=e.__box=Vt.get("Rect",0);const r=e.__layout,n=i.__layout;s||(i.parent=e,i.__world=e.__world,n.boxBounds=r.boxBounds),i.set(t),n.strokeChanged&&r.strokeChange(),n.renderChanged&&r.renderChange(),i.__updateChange()}else i&&(e.__box=i.parent=null,i.destroy());this._boxStyle=t}}class tl extends Vh{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(t,e){const i=super.__getInputData(t,e);return delete i.fill,i}}class el extends Vh{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,e){const i=super.__getInputData(t,e);return i.url=this.__leaf.canvas.toDataURL("image/png"),i}}const il={__updateStrokeSpread(){let t=0,e=0;const i=this.__,{strokeAlign:s,__maxStrokeWidth:r}=i,n=this.__box;if((i.stroke||"all"===i.hitStroke)&&r&&"inside"!==s&&(e=t="center"===s?r/2:r,!i.__boxStroke)){const e=i.__isLinePath?0:10*t,s="none"===i.strokeCap?0:r;t+=Math.max(e,s)}return i.__useArrow&&(t+=5*r),n&&(t=Math.max(n.__layout.strokeSpread=n.__updateStrokeSpread(),t),e=n.__layout.strokeBoxSpread),this.__layout.strokeBoxSpread=e,t},__updateRenderSpread(){let t=0;const{shadow:e,innerShadow:i,blur:s,backgroundBlur:r,filter:n,renderSpread:o}=this.__;e&&e.forEach(e=>t=Math.max(t,Math.max(Math.abs(e.y),Math.abs(e.x))+(e.spread>0?e.spread:0)+1.5*e.blur)),s&&(t=Math.max(t,s)),n&&(t+=Th.getSpread(n)),o&&(t+=o);let a=t=Math.ceil(t);return i&&i.forEach(t=>a=Math.max(a,Math.max(Math.abs(t.y),Math.abs(t.x))+(t.spread<0?-t.spread:0)+1.5*t.blur)),r&&(a=Math.max(a,r)),this.__layout.renderShapeSpread=a,t+=this.__layout.strokeSpread||0,this.__box?Math.max(this.__box.__updateRenderSpread(),t):t}},sl={getValidMove(t,e,i,s,r){const n=t.x+s.x,o=t.y+s.y,a=n+t.width,h=o+t.height,l=e.x+e.width,d=e.y+e.height;r||(s=Object.assign({},s));const c=t.width>e.width,u=t.height>e.height;return c&&"outer"!==i?n>e.x?s.x+=e.x-n:a<l&&(s.x+=l-a):n<e.x?s.x+=e.x-n:a>l&&(s.x+=l-a),u&&"outer"!==i?o>e.y?s.y+=e.y-o:h<d&&(s.y+=d-h):o<e.y?s.y+=e.y-o:h>d&&(s.y+=d-h),s.x=x.float(s.x),s.y=x.float(s.y),s},axisMove(t,e){const{draggable:i}=t;"x"===i&&(e.y=0),"y"===i&&(e.x=0)},limitMove(t,e){const{dragBounds:i,dragBoundsType:s}=t;i&&rl.getValidMove(t.__localBoxBounds,"parent"===i?t.parent.boxBounds:i,s,e,!0),rl.axisMove(t,e)}},rl=sl,{stintSet:nl}=g,ol={__updateChange(){const t=this.__;if(t.__useStroke){const e=t.__useStroke=!(!t.stroke||!t.strokeWidth);nl(this.__world,"half",e&&"center"===t.strokeAlign&&t.strokeWidth%2),nl(t,"__fillAfterStroke",e&&"outside"===t.strokeAlign&&t.fill&&!t.__isTransparentFill)}if(t.__useEffect){const{shadow:e,fill:i,stroke:s}=t,r=t.innerShadow||t.blur||t.backgroundBlur||t.filter;nl(t,"__isFastShadow",e&&!r&&e.length<2&&!e[0].spread&&i&&!t.__isTransparentFill&&!(u(i)&&i.length>1)&&(this.useFastShadow||!s||s&&"inside"===t.strokeAlign)),t.__useEffect=!(!e&&!r)}t.__checkSingle(),nl(t,"__complex",t.__isFills||t.__isStrokes||t.cornerRadius||t.__useEffect)},__drawFast(t,e){al(this,t,e)},__draw(t,e,i){const s=this.__;if(s.__complex){s.__needComputePaint&&s.__computePaint();const{fill:r,stroke:n,__drawAfterFill:o,__fillAfterStroke:a,__isFastShadow:h}=s;if(this.__drawRenderPath(t),s.__useEffect&&!h){const h=Bh.shape(this,t,e);this.__nowWorld=this.__getNowWorld(e);const{shadow:l,innerShadow:d,filter:c}=s;l&&Ch.shadow(this,t,h),a&&(s.__isStrokes?Bh.strokes(n,this,t):Bh.stroke(n,this,t)),r&&(s.__isFills?Bh.fills(r,this,t):Bh.fill(r,this,t)),o&&this.__drawAfterFill(t,e),d&&Ch.innerShadow(this,t,h),n&&!a&&(s.__isStrokes?Bh.strokes(n,this,t):Bh.stroke(n,this,t)),c&&Th.apply(c,this,this.__nowWorld,t,i,h),h.worldCanvas&&h.worldCanvas.recycle(),h.canvas.recycle()}else{if(a&&(s.__isStrokes?Bh.strokes(n,this,t):Bh.stroke(n,this,t)),h){const e=s.shadow[0],{scaleX:i,scaleY:r}=this.getRenderScaleData(!0,e.scaleFixed);t.save(),t.setWorldShadow(e.x*i,e.y*r,e.blur*i,bh.string(e.color))}r&&(s.__isFills?Bh.fills(r,this,t):Bh.fill(r,this,t)),h&&t.restore(),o&&this.__drawAfterFill(t,e),n&&!a&&(s.__isStrokes?Bh.strokes(n,this,t):Bh.stroke(n,this,t))}}else s.__pathInputed?al(this,t,e):this.__drawFast(t,e)},__drawShape(t,e){this.__drawRenderPath(t);const i=this.__,{fill:s,stroke:r}=i;s&&!e.ignoreFill&&(i.__isAlphaPixelFill?Bh.fills(s,this,t):Bh.fill("#000000",this,t)),i.__isCanvas&&this.__drawAfterFill(t,e),r&&!e.ignoreStroke&&(i.__isAlphaPixelStroke?Bh.strokes(r,this,t):Bh.stroke("#000000",this,t))},__drawAfterFill(t,e){this.__.__clipAfterFill?(t.save(),t.clipUI(this),this.__drawContent(t,e),t.restore()):this.__drawContent(t,e)}};function al(t,e,i){const{fill:s,stroke:r,__drawAfterFill:n,__fillAfterStroke:o}=t.__;t.__drawRenderPath(e),o&&Bh.stroke(r,t,e),s&&Bh.fill(s,t,e),n&&t.__drawAfterFill(e,i),r&&!o&&Bh.stroke(r,t,e)}const hl={__drawFast(t,e){let{x:i,y:s,width:r,height:n}=this.__layout.boxBounds;const{fill:o,stroke:a,__drawAfterFill:h}=this.__;if(o&&(t.fillStyle=o,t.fillRect(i,s,r,n)),h&&this.__drawAfterFill(t,e),a){const{strokeAlign:o,__strokeWidth:h}=this.__;if(!h)return;t.setStroke(a,h,this.__);const l=h/2;switch(o){case"center":t.strokeRect(0,0,r,n);break;case"inside":r-=h,n-=h,r<0||n<0?(t.save(),this.__clip(t,e),t.strokeRect(i+l,s+l,r,n),t.restore()):t.strokeRect(i+l,s+l,r,n);break;case"outside":t.strokeRect(i-l,s-l,r+h,n+h)}}}};var ll,dl;t.UI=ll=class extends t.Leaf{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){x.assignScale(this,t)}get scale(){return this.__.scale}get isAutoWidth(){const t=this.__;return t.__autoWidth||t.autoWidth}get isAutoHeight(){const t=this.__;return t.__autoHeight||t.autoHeight}get pen(){const{path:t}=this.__;return xr.set(this.path=t||[]),t||this.__drawPathByBox(xr),xr}constructor(t){super(t)}reset(t){}set(t,e){t&&(e?"temp"===e?(this.lockNormalStyle=!0,Object.assign(this,t),this.lockNormalStyle=!1):this.animate(t,e):Object.assign(this,t))}get(t){return h(t)?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){return Xt.need("find")}findTag(t){return this.find({tag:t})}findOne(t,e){return Xt.need("find")}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let i=e?this.__.__pathForRender:this.__.path;return i||(xr.set(i=[]),this.__drawPathByBox(xr)),t?Ii.toCanvasData(i,!0):i}getPathString(t,e,i){return Ii.stringify(this.getPath(t,e),i)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;!t.lazy||this.__inLazyBounds||Sh.running?t.__computePaint():t.__needComputePaint=!0}}__updateRenderPath(){const t=this.__;t.path?(t.__pathForRender=t.cornerRadius?wr.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&Ph.addArrows(this,!t.cornerRadius)):t.__pathForRender&&(t.__pathForRender=void 0)}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?As.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:i,width:s,height:r}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:n}=this.__;t.roundRect(e,i,s,r,d(n)?[n]:n)}else t.rect(e,i,s,r)}drawImagePlaceholder(t,e){Bh.fill(this.__.placeholderColor,this,t)}animate(t,e,i,s){return Xt.need("animate")}killAnimate(t,e){}export(t,e){return Xt.need("export")}syncExport(t,e){return Xt.need("export")}clone(t){const e=g.clone(this.toJSON());return t&&Object.assign(e,t),ll.one(e)}static one(t,e,i,s,r){return Vt.get(t.tag||this.prototype.__tag,t,e,i,s,r)}static registerUI(){kn()(this)}static registerData(t){yn(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}},Qt([yn(Uh)],t.UI.prototype,"__",void 0),Qt([wh()],t.UI.prototype,"zoomLayer",void 0),Qt([jr("")],t.UI.prototype,"id",void 0),Qt([jr("")],t.UI.prototype,"name",void 0),Qt([jr("")],t.UI.prototype,"className",void 0),Qt([an("pass-through")],t.UI.prototype,"blendMode",void 0),Qt([hn(1)],t.UI.prototype,"opacity",void 0),Qt([ln(!0)],t.UI.prototype,"visible",void 0),Qt([an(!1)],t.UI.prototype,"locked",void 0),Qt([an(!1)],t.UI.prototype,"dim",void 0),Qt([an(!1)],t.UI.prototype,"dimskip",void 0),Qt([un(0)],t.UI.prototype,"zIndex",void 0),Qt([_n(!1)],t.UI.prototype,"mask",void 0),Qt([pn(!1)],t.UI.prototype,"eraser",void 0),Qt([Vr(0,!0)],t.UI.prototype,"x",void 0),Qt([Vr(0,!0)],t.UI.prototype,"y",void 0),Qt([$r(100,!0)],t.UI.prototype,"width",void 0),Qt([$r(100,!0)],t.UI.prototype,"height",void 0),Qt([qr(1,!0)],t.UI.prototype,"scaleX",void 0),Qt([qr(1,!0)],t.UI.prototype,"scaleY",void 0),Qt([Zr(0,!0)],t.UI.prototype,"rotation",void 0),Qt([Zr(0,!0)],t.UI.prototype,"skewX",void 0),Qt([Zr(0,!0)],t.UI.prototype,"skewY",void 0),Qt([Vr(0,!0)],t.UI.prototype,"offsetX",void 0),Qt([Vr(0,!0)],t.UI.prototype,"offsetY",void 0),Qt([Gr(0,!0)],t.UI.prototype,"scrollX",void 0),Qt([Gr(0,!0)],t.UI.prototype,"scrollY",void 0),Qt([Kr()],t.UI.prototype,"origin",void 0),Qt([Kr()],t.UI.prototype,"around",void 0),Qt([jr(!1)],t.UI.prototype,"lazy",void 0),Qt([Qr(1)],t.UI.prototype,"pixelRatio",void 0),Qt([on(0)],t.UI.prototype,"renderSpread",void 0),Qt([tn()],t.UI.prototype,"path",void 0),Qt([en()],t.UI.prototype,"windingRule",void 0),Qt([en(!0)],t.UI.prototype,"closed",void 0),Qt([$r(0)],t.UI.prototype,"padding",void 0),Qt([$r(!1)],t.UI.prototype,"lockRatio",void 0),Qt([$r()],t.UI.prototype,"widthRange",void 0),Qt([$r()],t.UI.prototype,"heightRange",void 0),Qt([jr(!1)],t.UI.prototype,"draggable",void 0),Qt([jr()],t.UI.prototype,"dragBounds",void 0),Qt([jr("auto")],t.UI.prototype,"dragBoundsType",void 0),Qt([jr(!1)],t.UI.prototype,"editable",void 0),Qt([gn(!0)],t.UI.prototype,"hittable",void 0),Qt([gn("path")],t.UI.prototype,"hitFill",void 0),Qt([nn("path")],t.UI.prototype,"hitStroke",void 0),Qt([gn(!1)],t.UI.prototype,"hitBox",void 0),Qt([gn(!0)],t.UI.prototype,"hitChildren",void 0),Qt([gn(!0)],t.UI.prototype,"hitSelf",void 0),Qt([gn()],t.UI.prototype,"hitRadius",void 0),Qt([fn("")],t.UI.prototype,"cursor",void 0),Qt([an()],t.UI.prototype,"fill",void 0),Qt([nn(void 0,!0)],t.UI.prototype,"stroke",void 0),Qt([nn("inside")],t.UI.prototype,"strokeAlign",void 0),Qt([nn(1,!0)],t.UI.prototype,"strokeWidth",void 0),Qt([nn(!1)],t.UI.prototype,"strokeWidthFixed",void 0),Qt([nn("none")],t.UI.prototype,"strokeCap",void 0),Qt([nn("miter")],t.UI.prototype,"strokeJoin",void 0),Qt([nn()],t.UI.prototype,"dashPattern",void 0),Qt([nn(0)],t.UI.prototype,"dashOffset",void 0),Qt([nn(10)],t.UI.prototype,"miterLimit",void 0),Qt([en(0)],t.UI.prototype,"cornerRadius",void 0),Qt([en()],t.UI.prototype,"cornerSmoothing",void 0),Qt([vh()],t.UI.prototype,"shadow",void 0),Qt([vh()],t.UI.prototype,"innerShadow",void 0),Qt([vh()],t.UI.prototype,"blur",void 0),Qt([vh()],t.UI.prototype,"backgroundBlur",void 0),Qt([vh()],t.UI.prototype,"grayscale",void 0),Qt([vh()],t.UI.prototype,"filter",void 0),Qt([an()],t.UI.prototype,"placeholderColor",void 0),Qt([jr(100)],t.UI.prototype,"placeholderDelay",void 0),Qt([jr({})],t.UI.prototype,"data",void 0),Qt([bn(t.Leaf.prototype.reset)],t.UI.prototype,"reset",null),t.UI=ll=Qt([Bn(il),Bn(ol),En()],t.UI),t.Group=class extends t.UI{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,e){if(t)if(t.children){const{children:i}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,e),i.forEach(t=>this.add(t)),t.children=i}else super.set(t,e)}toJSON(t){const e=super.toJSON(t);return this.childlessJSON||(e.children=this.children.map(e=>e.toJSON(t))),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}},Qt([yn(Nh)],t.Group.prototype,"__",void 0),Qt([$r(0)],t.Group.prototype,"width",void 0),Qt([$r(0)],t.Group.prototype,"height",void 0),t.Group=Qt([Bn(t.Branch),kn()],t.Group);const cl=Mt.get("Leafer");t.Leafer=dl=class extends t.Group{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&Sr.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds(!0)||{x:0,y:0,width:0,height:0}}constructor(t,e){super(e),this.config={start:!0,hittable:!0,smooth:!0,lazySpeard:100},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),dl.list.add(this)}init(t,e){if(this.canvas)return;let i;const{config:s}=this;this.__setLeafer(this),e&&(this.parentApp=e,this.__bindApp(e),i=e.running),t&&(this.parent=e,this.initType(t.type),this.parent=void 0,g.assign(s,t));const r=this.canvas=Ht.canvas(s);this.__controllers.push(this.renderer=Ht.renderer(this,r,s),this.watcher=Ht.watcher(this,s),this.layouter=Ht.layouter(this,s)),this.isApp&&this.__setApp(),this.__checkAutoLayout(s,e),this.view=r.view,e||(this.selector=Ht.selector(this),this.interaction=Ht.interaction(this,r,this.selector,s),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=Ht.hitCanvasManager()),this.canvasManager=new $t,i=s.start),this.hittable=s.hittable,this.fill=s.fill,this.canvasManager.add(r),this.__listenEvents(),i&&(this.__startTimer=setTimeout(this.start.bind(this))),eo.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t,e){this.waitInit(()=>{super.set(t,e)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(To.RESTART):this.emitLeafer(To.START),this.__controllers.forEach(t=>t.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(t=>t.stop()),this.running=!1,this.emitLeafer(To.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=g.copyAttrs({},t,ce);Object.keys(e).forEach(t=>this[t]=e[t])}forceRender(t,e){const{renderer:i}=this;i&&(i.addBlock(t?new Lt(t):this.canvas.bounds),this.viewReady&&(e?i.render():i.update()))}requestRender(t=!1){this.renderer&&this.renderer.update(t)}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const i=g.copyAttrs({},this.canvas,ce);e.resize(t),this.updateLazyBounds(),this.__onResize(new Bo(t,i))}__onResize(t){this.emitEvent(t),g.copyAttrs(this.__,t,ce),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t,e){e||(t.width&&t.height||(this.autoLayout=new Dt(t)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(ce.includes(t)?this.__changeCanvasSize(t,e):"fill"===t?this.__changeFill(e):"hittable"===t?this.parent||(this.canvas.hittable=e):"zIndex"===t&&(this.canvas.zIndex=e,setTimeout(()=>this.parent&&this.parent.__updateSortChildren()))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&ce.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const i=g.copyAttrs({},this.canvas,ce);i[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(i)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready=!0,this.emitLeafer(To.BEFORE_READY),this.emitLeafer(To.READY),this.emitLeafer(To.AFTER_READY),eo.run(this.__readyWait)}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(To.VIEW_READY),eo.run(this.__viewReadyWait))}__onLayoutEnd(){const{grow:t,width:e,height:i}=this.config;if(t){let{width:s,height:r,pixelRatio:n}=this;const o="box"===t?this.worldBoxBounds:this.__world;e||(s=Math.max(1,o.x+o.width)),i||(r=Math.max(1,o.y+o.height)),this.__doResize({width:s,height:r,pixelRatio:n})}this.ready||this.__onReady()}__onNextRender(){if(this.viewReady){eo.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1,this.requestRender())}else this.requestRender()}__checkViewCompleted(t=!0){this.nextRender(()=>{this.imageReady&&(t&&this.emitLeafer(To.VIEW_COMPLETED),eo.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,i){e&&(t=t.bind(e));const s=this.__nextRenderWait;if(i){for(let e=0;e<s.length;e++)if(s[e]===t){s.splice(e,1);break}}else s.push(t);this.requestRender()}zoom(t,e,i,s){return Xt.need("view")}getValidMove(t,e,i){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}getPagePointByClient(t,e){return this.getPagePoint(this.getWorldPointByClient(t,e))}getClientPointByWorld(t){const{x:e,y:i}=this.clientBounds;return{x:e+t.x,y:i+t.y}}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(t){}emitLeafer(t){this.emitEvent(new To(t,this))}__listenEvents(){const t=zt.start("FirstCreate "+this.innerName);this.once([[To.START,()=>zt.end(t)],[Ro.START,this.updateLazyBounds,this],[Co.START,this.__onCreated,this],[Co.END,this.__onViewReady,this]]),this.__eventIds.push(this.on_([[ko.DATA,this.__onWatchData,this],[Ro.END,this.__onLayoutEnd,this],[Co.NEXT,this.__onNextRender,this]]))}__removeListenEvents(){this.off_(this.__eventIds)}destroy(t){const e=()=>{if(!this.destroyed){dl.list.remove(this);try{this.stop(),this.emitLeafer(To.END),this.__removeListenEvents(),this.__controllers.forEach(t=>!(this.parent&&t===this.interaction)&&t.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=this.parentApp=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{Or.clearRecycled()},100)}catch(t){cl.error(t)}}};t?e():setTimeout(e)}},t.Leafer.list=new Ga,Qt([yn(Xh)],t.Leafer.prototype,"__",void 0),Qt([$r()],t.Leafer.prototype,"pixelRatio",void 0),t.Leafer=dl=Qt([kn()],t.Leafer),t.Rect=class extends t.UI{get __tag(){return"Rect"}constructor(t){super(t)}},Qt([yn(Vh)],t.Rect.prototype,"__",void 0),t.Rect=Qt([Bn(hl),En(),kn()],t.Rect);const{add:ul,includes:_l,scroll:pl}=Rt,gl=t.Rect.prototype,fl=t.Group.prototype;t.Box=class extends t.Group{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){if(this.children.length&&!this.pathInputed){const t=this.__;if(t.__autoSide){t.__hasSurface&&this.__extraUpdate(),super.__updateBoxBounds();const{boxBounds:e}=this.__layout;t.__autoSize||(t.__autoWidth?(e.width+=e.x,e.x=0,e.height=t.height,e.y=0):(e.height+=e.y,e.y=0,e.width=t.width,e.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t,e;if(this.children.length){const i=this.__,s=this.__layout,{renderBounds:r,boxBounds:n}=s,{overflow:o}=i,a=s.childrenRenderBounds||(s.childrenRenderBounds={x:0,y:0,width:0,height:0});super.__updateRenderBounds(a),(e=o.includes("scroll"))&&(ul(a,n),pl(a,i)),this.__updateRectRenderBounds(),t=!_l(n,a),t&&"show"===o&&ul(r,a)}else this.__updateRectRenderBounds();g.stintSet(this,"isOverflow",t),this.__checkScroll(e)}__updateRectRenderBounds(){}__checkScroll(t){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e)),this.hasScroller&&this.scroller.__render(t,e)}__drawContent(t,e){this.__renderGroup(t,e),(this.__.__useStroke||this.__.__useEffect)&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}},Qt([yn(Yh)],t.Box.prototype,"__",void 0),Qt([$r(100)],t.Box.prototype,"width",void 0),Qt([$r(100)],t.Box.prototype,"height",void 0),Qt([jr(!1)],t.Box.prototype,"resizeChildren",void 0),Qt([on("show")],t.Box.prototype,"overflow",void 0),Qt([bn(gl.__updateStrokeSpread)],t.Box.prototype,"__updateStrokeSpread",null),Qt([bn(gl.__updateRenderSpread)],t.Box.prototype,"__updateRectRenderSpread",null),Qt([bn(gl.__updateBoxBounds)],t.Box.prototype,"__updateRectBoxBounds",null),Qt([bn(gl.__updateStrokeBounds)],t.Box.prototype,"__updateStrokeBounds",null),Qt([bn(gl.__updateRenderBounds)],t.Box.prototype,"__updateRectRenderBounds",null),Qt([bn(gl.__updateChange)],t.Box.prototype,"__updateRectChange",null),Qt([bn(gl.__render)],t.Box.prototype,"__renderRect",null),Qt([bn(fl.__render)],t.Box.prototype,"__renderGroup",null),t.Box=Qt([En(),kn()],t.Box),t.Frame=class extends t.Box{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}},Qt([yn(Hh)],t.Frame.prototype,"__",void 0),Qt([an("#FFFFFF")],t.Frame.prototype,"fill",void 0),Qt([on("hide")],t.Frame.prototype,"overflow",void 0),t.Frame=Qt([kn()],t.Frame);const{moveTo:yl,closePath:vl,ellipse:ml}=ss;t.Ellipse=class extends t.UI{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:i,innerRadius:s,startAngle:r,endAngle:n}=this.__,o=t/2,a=i/2,h=this.__.path=[];s?(r||n?(s<1&&ml(h,o,a,o*s,a*s,0,r,n,!1),ml(h,o,a,o,a,0,n,r,!0),s<1&&vl(h)):(s<1&&(ml(h,o,a,o*s,a*s),yl(h,t,a)),ml(h,o,a,o,a,0,360,0,!0)),e.ellipseToCurve&&(this.__.path=this.getPath(!0))):r||n?(yl(h,o,a),ml(h,o,a,o,a,0,r,n,!1),vl(h)):ml(h,o,a,o,a)}},Qt([yn(Gh)],t.Ellipse.prototype,"__",void 0),Qt([en(0)],t.Ellipse.prototype,"innerRadius",void 0),Qt([en(0)],t.Ellipse.prototype,"startAngle",void 0),Qt([en(0)],t.Ellipse.prototype,"endAngle",void 0),t.Ellipse=Qt([kn()],t.Ellipse);const{moveTo:wl,lineTo:xl,drawPoints:bl}=ss,{rotate:El,getAngle:Pl,getDistance:Bl,defaultPoint:kl}=G,{toBounds:Rl}=_r;t.Line=class extends t.UI{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,i={x:0,y:0};return t&&(i.x=t),e&&El(i,e),i}set toPoint(t){this.width=Bl(kl,t),this.rotation=Pl(kl,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?bl(e,t.points,!1,t.closed):(wl(e,0,0),xl(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(bl(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&Ph.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?Rl(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}},Qt([yn(jh)],t.Line.prototype,"__",void 0),Qt([sn("center")],t.Line.prototype,"strokeAlign",void 0),Qt([$r(0)],t.Line.prototype,"height",void 0),Qt([en()],t.Line.prototype,"points",void 0),Qt([en(0)],t.Line.prototype,"curve",void 0),Qt([en(!1)],t.Line.prototype,"closed",void 0),t.Line=Qt([kn()],t.Line);const{sin:Cl,cos:Tl,PI:Sl}=Math,{moveTo:Ll,lineTo:Ol,closePath:Dl,drawPoints:Il}=ss,Al=t.Line.prototype;t.Polygon=class extends t.UI{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)Il(t,this.__.points,!1,!0);else{const{width:e,height:i,sides:s}=this.__,r=e/2,n=i/2;Ll(t,r,0);for(let e=1;e<s;e++)Ol(t,r+r*Cl(2*e*Sl/s),n-n*Tl(2*e*Sl/s));Dl(t)}}__updateRenderPath(){}__updateBoxBounds(){}},Qt([yn(Kh)],t.Polygon.prototype,"__",void 0),Qt([en(3)],t.Polygon.prototype,"sides",void 0),Qt([en()],t.Polygon.prototype,"points",void 0),Qt([en(0)],t.Polygon.prototype,"curve",void 0),Qt([bn(Al.__updateRenderPath)],t.Polygon.prototype,"__updateRenderPath",null),Qt([bn(Al.__updateBoxBounds)],t.Polygon.prototype,"__updateBoxBounds",null),t.Polygon=Qt([En(),kn()],t.Polygon);const{sin:Ml,cos:Wl,PI:Fl}=Math,{moveTo:Ul,lineTo:zl,closePath:Nl}=ss;t.Star=class extends t.UI{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:i,innerRadius:s}=this.__,r=t/2,n=e/2,o=this.__.path=[];Ul(o,r,0);for(let t=1;t<2*i;t++)zl(o,r+(t%2==0?r:r*s)*Ml(t*Fl/i),n-(t%2==0?n:n*s)*Wl(t*Fl/i));Nl(o)}},Qt([yn(qh)],t.Star.prototype,"__",void 0),Qt([en(5)],t.Star.prototype,"corners",void 0),Qt([en(.382)],t.Star.prototype,"innerRadius",void 0),t.Star=Qt([kn()],t.Star),t.Image=class extends t.Rect{get __tag(){return"Image"}get ready(){const{image:t}=this;return t&&t.ready}get image(){const{fill:t}=this.__;return u(t)&&t[0].image}constructor(t){super(t)}},Qt([yn(tl)],t.Image.prototype,"__",void 0),Qt([$r("")],t.Image.prototype,"url",void 0),t.Image=Qt([kn()],t.Image);const Yl=t.Image;t.Canvas=class extends t.Rect{get __tag(){return"Canvas"}get context(){return this.canvas.context}get ready(){return!this.url}constructor(t){super(t),this.canvas=Ht.canvas(this.__),t&&t.url&&this.drawImage(t.url)}drawImage(t){new Fr({url:t}).load(t=>{this.context.drawImage(t.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new vo(vo.LOADED,{image:t}))})}draw(t,e,i,s){const r=new tt(t.worldTransform).invert(),n=new tt;e&&n.translate(e.x,e.y),i&&(d(i)?n.scale(i):n.scale(i.x,i.y)),s&&n.rotate(s),r.multiplyParent(n),t.__render(this.canvas,{matrix:r.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,e){const{width:i,height:s}=this.__,{view:r}=this.canvas;t.drawImage(r,0,0,r.width,r.height,0,0,i,s)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e,safeResize:i}=this.__;t.resize(this.__,i),t.smooth!==e&&(t.smooth=e)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=null),super.destroy()}},Qt([yn(el)],t.Canvas.prototype,"__",void 0),Qt([mh(100)],t.Canvas.prototype,"width",void 0),Qt([mh(100)],t.Canvas.prototype,"height",void 0),Qt([mh(1)],t.Canvas.prototype,"pixelRatio",void 0),Qt([mh(!0)],t.Canvas.prototype,"smooth",void 0),Qt([jr(!1)],t.Canvas.prototype,"safeResize",void 0),Qt([mh()],t.Canvas.prototype,"contextSettings",void 0),t.Canvas=Qt([kn()],t.Canvas);const{copyAndSpread:Xl,includes:Hl,spread:jl,setList:Vl}=Rt;t.Text=class extends t.UI{get __tag(){return"Text"}get textDrawData(){return this.updateLayout(),this.__.__textDrawData}constructor(t){super(t)}__updateTextDrawData(){const t=this.__,{lineHeight:e,letterSpacing:i,fontFamily:s,fontSize:r,fontWeight:n,italic:o,textCase:a,textOverflow:h,padding:l}=t;t.__lineHeight=Eh.number(e,r),t.__letterSpacing=Eh.number(i,r),t.__padding=l?x.fourNumber(l):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-.7*r)/2,t.__font=`${o?"italic ":""}${"small-caps"===a?"small-caps ":""}${"normal"!==n?n+" ":""}${r||12}px ${s||"caption"}`,t.__clipText="show"!==h&&!t.__autoSize,t.__textDrawData=xh.getDrawData((t.__isPlacehold=t.placeholder&&""===t.text)?t.placeholder:t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{fontSize:i,italic:s,padding:r,__autoWidth:n,__autoHeight:o}=t;this.__updateTextDrawData();const{bounds:a}=t.__textDrawData,h=e.boxBounds;if(e.contentBounds=a,t.__lineHeight<i&&jl(a,i/2),n||o){if(h.x=n?a.x:0,h.y=o?a.y:0,h.width=n?a.width:t.width,h.height=o?a.height:t.height,r){const[e,i,s,r]=t.__padding;n&&(h.x-=r,h.width+=i+r),o&&(h.y-=e,h.height+=s+e)}this.__updateNaturalSize()}else super.__updateBoxBounds();s&&(h.width+=.16*i),g.stintSet(this,"isOverflow",!Hl(h,a)),this.isOverflow?(Vl(t.__textBoxBounds={},[h,a]),e.renderChanged=!0):t.__textBoxBounds=h}__onUpdateSize(){this.__box&&this.__box.__onUpdateSize(),super.__onUpdateSize()}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.isOverflow?1:0),t}__updateRenderBounds(){const{renderBounds:t,renderSpread:e}=this.__layout;Xl(t,this.__.__textBoxBounds,e),this.__box&&(this.__box.__layout.renderBounds=t)}__drawRenderPath(t){t.font=this.__.__font}__draw(t,e,i){const s=this.__box;s&&(s.__nowWorld=this.__nowWorld,s.__draw(t,e,i)),this.textEditing&&!e.exporting||super.__draw(t,e,i)}__drawShape(t,e){e.shape&&this.__box&&this.__box.__drawShape(t,e),super.__drawShape(t,e)}destroy(){this.boxStyle&&(this.boxStyle=null),super.destroy()}},Qt([yn(Jh)],t.Text.prototype,"__",void 0),Qt([$r(0)],t.Text.prototype,"width",void 0),Qt([$r(0)],t.Text.prototype,"height",void 0),Qt([an()],t.Text.prototype,"boxStyle",void 0),Qt([jr(!1)],t.Text.prototype,"resizeFontSize",void 0),Qt([an("#000000")],t.Text.prototype,"fill",void 0),Qt([sn("outside")],t.Text.prototype,"strokeAlign",void 0),Qt([gn("all")],t.Text.prototype,"hitFill",void 0),Qt([$r("")],t.Text.prototype,"text",void 0),Qt([$r("")],t.Text.prototype,"placeholder",void 0),Qt([$r("caption")],t.Text.prototype,"fontFamily",void 0),Qt([$r(12)],t.Text.prototype,"fontSize",void 0),Qt([$r("normal")],t.Text.prototype,"fontWeight",void 0),Qt([$r(!1)],t.Text.prototype,"italic",void 0),Qt([$r("none")],t.Text.prototype,"textCase",void 0),Qt([$r("none")],t.Text.prototype,"textDecoration",void 0),Qt([$r(0)],t.Text.prototype,"letterSpacing",void 0),Qt([$r({type:"percent",value:1.5})],t.Text.prototype,"lineHeight",void 0),Qt([$r(0)],t.Text.prototype,"paraIndent",void 0),Qt([$r(0)],t.Text.prototype,"paraSpacing",void 0),Qt([$r("x")],t.Text.prototype,"writingMode",void 0),Qt([$r("left")],t.Text.prototype,"textAlign",void 0),Qt([$r("top")],t.Text.prototype,"verticalAlign",void 0),Qt([$r(!0)],t.Text.prototype,"autoSizeAlign",void 0),Qt([$r("normal")],t.Text.prototype,"textWrap",void 0),Qt([$r("show")],t.Text.prototype,"textOverflow",void 0),Qt([an(!1)],t.Text.prototype,"textEditing",void 0),t.Text=Qt([kn()],t.Text),t.Path=class extends t.UI{get __tag(){return"Path"}constructor(t){super(t)}},Qt([yn(Zh)],t.Path.prototype,"__",void 0),Qt([sn("center")],t.Path.prototype,"strokeAlign",void 0),t.Path=Qt([kn()],t.Path),t.Pen=class extends t.Group{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(e){const i=this.pathElement=new t.Path(e);return this.pathStyle=e,this.__path=i.path||(i.path=[]),this.add(i),this}beginPath(){return this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,i,s,r,n){return this}quadraticCurveTo(t,e,i,s){return this}closePath(){return this}rect(t,e,i,s){return this}roundRect(t,e,i,s,r){return this}ellipse(t,e,i,s,r,n,o,a){return this}arc(t,e,i,s,r,n){return this}arcTo(t,e,i,s,r){return this}drawEllipse(t,e,i,s,r,n,o,a){return this}drawArc(t,e,i,s,r,n){return this}drawPoints(t,e,i){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}},Qt([yn($h)],t.Pen.prototype,"__",void 0),Qt([(t,e)=>{Ur(t,e,{get(){return this.__path}})}],t.Pen.prototype,"path",void 0),t.Pen=Qt([Bn(ws,["set","path","paint"]),kn()],t.Pen),t.App=class extends t.Leafer{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:e,tree:i,sky:s,editor:r}=t;e&&(this.ground=this.addLeafer(e)),(i||r)&&(this.tree=this.addLeafer(i||{type:t.type||"design"})),(s||r)&&(this.sky=this.addLeafer(s)),r&&Ht.editor(r,this)}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:i}=this.config;e||i===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable()}__updateLocalBounds(){this.forEach(t=>t.updateLayout()),super.__updateLocalBounds()}start(){super.start(),this.forEach(t=>t.start())}stop(){this.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.forEach(t=>t.lockLayout())}forceRender(t,e){this.forEach(i=>i.forceRender(t,e))}addLeafer(e){const i=new t.Leafer(e);return this.add(i),i}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds)return void setTimeout(()=>this.add(t,e),10);t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),o(e)||(t.canvas.childIndex=e),this.__listenChildEvents(t)}forEach(t){this.children.forEach(t)}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){t.context&&this.forEach(i=>e.matrix?i.__render(t,e):t.copyWorld(i.canvas,e.bounds))}__onResize(t){this.forEach(e=>e.resize(t)),super.__onResize(t)}updateLayout(){this.forEach(t=>t.updateLayout())}__getChildConfig(t){const e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&g.assign(e,t),this.autoLayout&&g.copyAttrs(e,this,ce),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once([[Ro.END,this.__onReady,this],[Co.START,this.__onCreated,this],[Co.END,this.__onViewReady,this]]),this.realCanvas&&this.__eventIds.push(t.on_(Co.END,this.__onChildRenderEnd,this))}},t.App=Qt([kn()],t.App);const Gl={},Kl={isHoldSpaceKey:()=>Kl.isHold("Space"),isHold:t=>Gl[t],isHoldKeys:(t,e)=>e?t(e):void 0,setDownCode(t){Gl[t]||(Gl[t]=!0)},setUpCode(t){Gl[t]=!1}},ql={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(t){t.buttons||(t.buttons=1)},left:t=>1===t.buttons,right:t=>2===t.buttons,middle:t=>4===t.buttons};class Zl extends _o{get spaceKey(){return Kl.isHoldSpaceKey()}get left(){return ql.left(this)}get right(){return ql.right(this)}get middle(){return ql.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}isHoldKeys(t){return Kl.isHoldKeys(t,this)}getBoxPoint(t){return(t||this.current).getBoxPoint(this)}getInnerPoint(t){return(t||this.current).getInnerPoint(this)}getLocalPoint(t){return(t||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,e){qt.changeName(t,e)}}t.PointerEvent=class extends Zl{},t.PointerEvent.POINTER="pointer",t.PointerEvent.BEFORE_DOWN="pointer.before_down",t.PointerEvent.BEFORE_MOVE="pointer.before_move",t.PointerEvent.BEFORE_UP="pointer.before_up",t.PointerEvent.DOWN="pointer.down",t.PointerEvent.MOVE="pointer.move",t.PointerEvent.UP="pointer.up",t.PointerEvent.OVER="pointer.over",t.PointerEvent.OUT="pointer.out",t.PointerEvent.ENTER="pointer.enter",t.PointerEvent.LEAVE="pointer.leave",t.PointerEvent.TAP="tap",t.PointerEvent.DOUBLE_TAP="double_tap",t.PointerEvent.CLICK="click",t.PointerEvent.DOUBLE_CLICK="double_click",t.PointerEvent.LONG_PRESS="long_press",t.PointerEvent.LONG_TAP="long_tap",t.PointerEvent.MENU="pointer.menu",t.PointerEvent.MENU_TAP="pointer.menu_tap",t.PointerEvent=Qt([Rn()],t.PointerEvent);const $l=t.PointerEvent,Ql={};t.DragEvent=class extends t.PointerEvent{static setList(t){this.list=t instanceof Ga?t:new Ga(t)}static setData(t){this.data=t}static getValidMove(t,e,i,s=!0){const r=t.getLocalPoint(i,null,!0);return G.move(r,e.x-t.x,e.y-t.y),s&&this.limitMove(t,r),sl.axisMove(t,r),r}static limitMove(t,e){sl.limitMove(t,e)}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(Ql,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(Ql,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(Ql,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPagePoint(),i={};return Rt.set(i,e.x-t.x,e.y-t.y,t.x,t.y),Rt.unsign(i),i}assignMove(t){Ql.x=t?this.totalX:this.moveX,Ql.y=t?this.totalY:this.moveY}},t.DragEvent.BEFORE_DRAG="drag.before_drag",t.DragEvent.START="drag.start",t.DragEvent.DRAG="drag",t.DragEvent.END="drag.end",t.DragEvent.OVER="drag.over",t.DragEvent.OUT="drag.out",t.DragEvent.ENTER="drag.enter",t.DragEvent.LEAVE="drag.leave",t.DragEvent=Qt([Rn()],t.DragEvent);const Jl=t.DragEvent;t.DropEvent=class extends t.PointerEvent{static setList(e){t.DragEvent.setList(e)}static setData(e){t.DragEvent.setData(e)}},t.DropEvent.DROP="drop",t.DropEvent=Qt([Rn()],t.DropEvent),t.MoveEvent=class extends t.DragEvent{},t.MoveEvent.BEFORE_MOVE="move.before_move",t.MoveEvent.START="move.start",t.MoveEvent.MOVE="move",t.MoveEvent.END="move.end",t.MoveEvent=Qt([Rn()],t.MoveEvent),t.RotateEvent=class extends t.PointerEvent{},t.RotateEvent.BEFORE_ROTATE="rotate.before_rotate",t.RotateEvent.START="rotate.start",t.RotateEvent.ROTATE="rotate",t.RotateEvent.END="rotate.end",t.RotateEvent=Qt([Rn()],t.RotateEvent),t.SwipeEvent=class extends t.DragEvent{},t.SwipeEvent.SWIPE="swipe",t.SwipeEvent.LEFT="swipe.left",t.SwipeEvent.RIGHT="swipe.right",t.SwipeEvent.UP="swipe.up",t.SwipeEvent.DOWN="swipe.down",t.SwipeEvent=Qt([Rn()],t.SwipeEvent),t.ZoomEvent=class extends t.PointerEvent{},t.ZoomEvent.BEFORE_ZOOM="zoom.before_zoom",t.ZoomEvent.START="zoom.start",t.ZoomEvent.ZOOM="zoom",t.ZoomEvent.END="zoom.end",t.ZoomEvent=Qt([Rn()],t.ZoomEvent),t.KeyEvent=class extends Zl{},t.KeyEvent.BEFORE_DOWN="key.before_down",t.KeyEvent.BEFORE_UP="key.before_up",t.KeyEvent.DOWN="key.down",t.KeyEvent.HOLD="key.hold",t.KeyEvent.UP="key.up",t.KeyEvent=Qt([Rn()],t.KeyEvent);const td={getDragEventData:(t,e,i)=>Object.assign(Object.assign({},i),{x:i.x,y:i.y,moveX:i.x-e.x,moveY:i.y-e.y,totalX:i.x-t.x,totalY:i.y-t.y}),getDropEventData:(t,e,i)=>Object.assign(Object.assign({},t),{list:e,data:i}),getSwipeDirection:e=>e<-45&&e>-135?t.SwipeEvent.UP:e>45&&e<135?t.SwipeEvent.DOWN:e<=45&&e>=-45?t.SwipeEvent.RIGHT:t.SwipeEvent.LEFT,getSwipeEventData:(t,e,i)=>Object.assign(Object.assign({},i),{moveX:e.moveX,moveY:e.moveY,totalX:i.x-t.x,totalY:i.y-t.y,type:ed.getSwipeDirection(G.getAngle(t,i))}),getBase(t){const e=1===t.button?4:t.button;return{altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,buttons:o(t.buttons)?1:0===t.buttons?e:t.buttons,origin:t}},pathHasEventType(t,e){const{list:i}=t;for(let t=0,s=i.length;t<s;t++)if(i[t].hasEvent(e))return!0;return!1},filterPathByEventType(t,e){const i=new Ga,{list:s}=t;for(let t=0,r=s.length;t<r;t++)s[t].hasEvent(e)&&i.add(s[t]);return i},pathCanDrag:e=>e&&e.list.some(e=>Un.draggable(e)||!e.isLeafer&&e.hasEvent(t.DragEvent.DRAG)),pathHasOutside:t=>t&&t.list.some(t=>t.isOutside)},ed=td,id=new Ga,{getDragEventData:sd,getDropEventData:rd,getSwipeEventData:nd}=td;class od{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=sd(t,t,t),this.canAnimate=this.canDragOut=!0}getList(e,i){const{proxy:s}=this.interaction.selector,r=s&&s.list.length,n=t.DragEvent.list||this.draggableList||id;return this.dragging&&(r?e?id:new Ga(i?[...s.list,...s.dragHoverExclude]:s.list):n)}checkDrag(e,i){const{interaction:s}=this;if(this.moving&&e.buttons<1)return this.canAnimate=!1,void s.pointerCancel();!this.moving&&i&&(this.moving=s.canMove(this.downData)||s.isHoldRightKey||s.isMobileDragEmpty)&&(this.dragData.moveType="drag",s.emit(t.MoveEvent.START,this.dragData)),this.moving||this.dragStart(e,i),this.drag(e)}dragStart(e,i){this.dragging||(this.dragging=i&&ql.left(e),this.dragging&&(this.interaction.emit(t.DragEvent.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(t=>this.dragStartPoints[t.innerId]={x:t.x,y:t.y})}getDraggableList(t){let e;for(let i=0,s=t.length;i<s;i++)if(e=t.list[i],Un.draggable(e)){this.draggableList=new Ga(e);break}}drag(e){const{interaction:i,dragData:s,downData:r}=this,{path:n,throughPath:o}=r;this.dragData=sd(r,s,e),o&&(this.dragData.throughPath=o),this.dragData.path=n,this.moving?(this.dragData.moveType="drag",i.emit(t.MoveEvent.BEFORE_MOVE,this.dragData),i.emit(t.MoveEvent.MOVE,this.dragData)):this.dragging&&(this.dragReal(),i.emit(t.DragEvent.BEFORE_DRAG,this.dragData),i.emit(t.DragEvent.DRAG,this.dragData))}dragReal(e){const{interaction:i}=this,{running:s}=i,r=this.realDraggableList;if(r.length&&s){const{totalX:s,totalY:n}=this.dragData,{dragLimitAnimate:o}=i.p,a=!o||!!e;r.forEach(i=>{if(i.draggable){const r=h(i.draggable),l=t.DragEvent.getValidMove(i,this.dragStartPoints[i.innerId],{x:s,y:n},a||r);o&&!r&&e?Un.animateMove(i,l,d(o)?o:.3):i.move(l)}})}}dragOverOrOut(e){const{interaction:i}=this,{dragOverPath:s}=this,{path:r}=e;this.dragOverPath=r,s?r.indexAt(0)!==s.indexAt(0)&&(i.emit(t.DragEvent.OUT,e,s),i.emit(t.DragEvent.OVER,e,r)):i.emit(t.DragEvent.OVER,e,r)}dragEnterOrLeave(e){const{interaction:i}=this,{dragEnterPath:s}=this,{path:r}=e;i.emit(t.DragEvent.LEAVE,e,s,r),i.emit(t.DragEvent.ENTER,e,r,s),this.dragEnterPath=r}dragEnd(t,e){(this.dragging||this.moving)&&(this.checkDragEndAnimate(t,e)||this.dragEndReal(t))}dragEndReal(e){const{interaction:i,downData:s,dragData:r}=this;e||(e=r);const{path:n,throughPath:o}=s,a=sd(s,e,e);if(o&&(a.throughPath=o),a.path=n,this.moving&&(this.moving=!1,a.moveType="drag",i.emit(t.MoveEvent.END,a)),this.dragging){const n=this.getList();this.dragging=!1,i.p.dragLimitAnimate&&this.dragReal(!0),i.emit(t.DragEvent.END,a),this.swipe(e,s,r,a),this.drop(e,n,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}swipe(t,e,i,s){const{interaction:r}=this;if(G.getDistance(e,t)>r.config.pointer.swipeDistance){const t=nd(e,i,s);this.interaction.emit(t.type,t)}}drop(e,i,s){const r=rd(e,i,t.DragEvent.data);r.path=s,this.interaction.emit(t.DropEvent.DROP,r),this.interaction.emit(t.DragEvent.LEAVE,e,s)}dragReset(){t.DragEvent.list=t.DragEvent.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragEndAnimate(t,e){return!1}animate(t,e){}checkDragOut(t){}autoMoveOnDragOut(t){}autoMoveCancel(){}destroy(){this.dragReset()}}const ad=Mt.get("emit");const hd=["move","zoom","rotate","key"];function ld(t,e,i,s,r){if(hd.some(t=>e.startsWith(t))&&t.__.hitChildren&&!cd(t,r)){let n;for(let o=0,a=t.children.length;o<a;o++)n=t.children[o],!i.path.has(n)&&n.__.hittable&&dd(n,e,i,s,r)}}function dd(t,e,i,s,r){if(t.destroyed)return!1;if(t.__.hitSelf&&!cd(t,r)&&(Lh.updateEventStyle&&!s&&Lh.updateEventStyle(t,e),t.hasEvent(e,s))){i.phase=s?1:t===i.target?2:3;const r=qt.get(e,i);if(t.emitEvent(r,s),r.isStop)return!0}return!1}function cd(t,e){return e&&e.has(t)}const ud={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:20,y:8}},pointer:{type:"pointer",snap:!0,hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20},touch:{preventDefault:"auto"},multiTouch:{},move:{autoDistance:2},zoom:{},cursor:!0,keyEvent:!0},{pathHasEventType:_d,pathCanDrag:pd,pathHasOutside:gd}=td;class fd{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return!0===this.m.drag||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&ql.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&ql.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&Kl.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,e,i,s){this.config=g.clone(ud),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=i,this.defaultPath=new Ga(t),this.createTransformer(),this.dragger=new od(this),s&&(this.config=g.default(s,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(e,i){e||(e=this.hoverData),e&&(ql.defaultLeft(e),this.updateDownData(e),this.checkPath(e,i),this.downTime=Date.now(),this.emit(t.PointerEvent.BEFORE_DOWN,e),this.emit(t.PointerEvent.DOWN,e),ql.left(e)&&(this.tapWait(),this.longPressWait(e)),this.waitRightTap=ql.right(e),this.dragger.setDragData(e),this.isHoldRightKey||this.updateCursor(e))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&ql.defaultLeft(t);(this.canvas.bounds.hitPoint(t)||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(e){if(this.emit(t.PointerEvent.BEFORE_MOVE,e,this.defaultPath),this.downData){const t=G.getDistance(this.downData,e)>this.p.dragDistance;t&&(this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(e,t)}this.dragger.moving||(this.updateHoverData(e),this.checkPath(e),this.emit(t.PointerEvent.MOVE,e),this.pointerHover(e),this.dragging&&(this.dragger.dragOverOrOut(e),this.dragger.dragEnterOrLeave(e))),this.updateCursor(this.downData||e)}pointerUp(e){const{downData:i}=this;if(e||(e=i),!i)return;ql.defaultLeft(e),e.multiTouch=i.multiTouch,this.findPath(e);const s=Object.assign(Object.assign({},e),{path:e.path.clone()});e.path.addList(i.path.list),this.checkPath(e),this.downData=null,this.emit(t.PointerEvent.BEFORE_UP,e),this.emit(t.PointerEvent.UP,e),this.touchLeave(e),e.isCancel||(this.tap(e),this.menuTap(e)),this.dragger.dragEnd(e),this.updateCursor(s)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}menu(e){this.findPath(e),this.emit(t.PointerEvent.MENU,e),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(e)}menuTap(e){this.waitRightTap&&this.waitMenuTap&&(this.emit(t.PointerEvent.MENU_TAP,e),this.waitRightTap=this.waitMenuTap=!1)}createTransformer(){}move(t){}zoom(t){}rotate(t){}transformEnd(){}wheel(t){}multiTouch(t,e){}keyDown(e){if(!this.config.keyEvent)return;this.emit(t.KeyEvent.BEFORE_DOWN,e,this.defaultPath);const{code:i}=e;this.downKeyMap[i]||(this.downKeyMap[i]=!0,Kl.setDownCode(i),this.emit(t.KeyEvent.HOLD,e,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(t.KeyEvent.DOWN,e,this.defaultPath)}keyUp(e){if(!this.config.keyEvent)return;this.emit(t.KeyEvent.BEFORE_UP,e,this.defaultPath);const{code:i}=e;this.downKeyMap[i]=!1,Kl.setUpCode(i),this.emit(t.KeyEvent.UP,e,this.defaultPath),"grab"===this.cursor&&this.updateCursor()}pointerHover(t){!this.canHover||this.dragging&&!this.p.dragHover||(t.path||(t.path=new Ga),this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(e){const{path:i}=e,{overPath:s}=this;this.overPath=i,s?i.indexAt(0)!==s.indexAt(0)&&(this.emit(t.PointerEvent.OUT,e,s),this.emit(t.PointerEvent.OVER,e,i)):this.emit(t.PointerEvent.OVER,e,i)}pointerEnterOrLeave(e){let{path:i}=e;this.downData&&!this.moveMode&&(i=i.clone(),this.downData.path.forEach(t=>i.add(t)));const{enterPath:s}=this;this.enterPath=i,this.emit(t.PointerEvent.LEAVE,e,s,i),this.emit(t.PointerEvent.ENTER,e,i,s)}touchLeave(e){"touch"===e.pointerType&&this.enterPath&&(this.emit(t.PointerEvent.LEAVE,e),this.dragger.dragging&&this.emit(t.DropEvent.LEAVE,e))}tap(e){const{pointer:i}=this.config,s=this.longTap(e);if(!i.tapMore&&s)return;if(!this.waitTap)return;i.tapMore&&this.emitTap(e);const r=Date.now()-this.downTime,n=[t.PointerEvent.DOUBLE_TAP,t.PointerEvent.DOUBLE_CLICK].some(t=>_d(e.path,t));r<i.tapTime+50&&n?(this.tapCount++,2===this.tapCount?(this.tapWaitCancel(),this.emitDoubleTap(e)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{i.tapMore||(this.tapWaitCancel(),this.emitTap(e))},i.tapTime))):i.tapMore||(this.tapWaitCancel(),this.emitTap(e))}findPath(t,i){const{hitRadius:s,through:r}=this.p,{bottomList:n,target:o}=this;e.backgrounder||t.origin||o&&o.updateLayout();const a=this.selector.getByPoint(t,s,Object.assign({bottomList:n,name:t.type},i||{through:r}));return a.throughPath&&(t.throughPath=a.throughPath),t.path=a.path,a.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!(!e||!e.isApp)&&(e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer)}checkPath(t,e){(e||this.moveMode&&!gd(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||"auto"===this.m.drag&&!pd(t.path))&&!gd(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,i){const{downData:s}=this;!t&&s&&(t=s),t&&(this.findPath(t,e),i&&s&&t.path.addList(s.path.list),this.downData=t)}updateHoverData(e){e||(e=this.hoverData),e&&(this.findPath(e,{exclude:this.dragger.getList(!1,!0),name:t.PointerEvent.MOVE}),this.hoverData=e)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,i;const{path:s}=t;for(let t=0,r=s.length;t<r&&(e=s.list[t],i=e.syncEventer&&e.syncEventer.cursor||e.cursor,!i);t++);this.setCursor(i)}setCursor(t){this.cursor=t}getLocal(t,e){const i=this.canvas.getClientBounds(e),s={x:t.clientX-i.x,y:t.clientY-i.y},{bounds:r}=this.canvas;return s.x*=r.width/i.width,s.y*=r.height/i.height,this.p.snap&&G.round(s),s}emitTap(e){this.emit(t.PointerEvent.TAP,e),this.emit(t.PointerEvent.CLICK,e)}emitDoubleTap(e){this.emit(t.PointerEvent.DOUBLE_TAP,e),this.emit(t.PointerEvent.DOUBLE_CLICK,e)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){this.waitTap&&(clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0)}longPressWait(e){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(t.PointerEvent.LONG_PRESS,e)},this.p.longPressTime)}longTap(e){let i;return this.longPressed&&(this.emit(t.PointerEvent.LONG_TAP,e),(_d(e.path,t.PointerEvent.LONG_TAP)||_d(e.path,t.PointerEvent.LONG_PRESS))&&(i=!0)),this.longPressWaitCancel(),i}longPressWaitCancel(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressed=!1)}__onResize(){const{dragOut:t}=this.m;this.shrinkCanvasBounds=new Lt(this.canvas.bounds),this.shrinkCanvasBounds.spread(-(d(t)?t:2))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Bo.RESIZE,this.__onResize,this)],t.once(To.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,i,s){this.running&&function(t,e,i,s){if(!i&&!e.path)return;let r;e.type=t,i?e=Object.assign(Object.assign({},e),{path:i}):i=e.path,e.target=i.indexAt(0);try{for(let n=i.length-1;n>-1;n--){if(r=i.list[n],dd(r,t,e,!0,s))return;r.isApp&&ld(r,t,e,!0,s)}for(let n=0,o=i.length;n<o;n++)if(r=i.list[n],r.isApp&&ld(r,t,e,!1,s),dd(r,t,e,!1,s))return}catch(t){ad.error(t)}}(t,e,i,s)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer&&this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class yd{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}yd.custom={};class vd extends $t{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new Ga,this.pixelList=new Ga}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),Ht.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),Ht.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(t=>{t.__hitCanvas&&(t.__hitCanvas.destroy(),t.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}e.getSelector=function(t){return t.leafer?t.leafer.selector:e.selector||(e.selector=Ht.selector())};const{toInnerRadiusPointOf:md,copy:wd,setRadius:xd}=G,{hitRadiusPoint:bd,hitPoint:Ed}=Rt,Pd={},Bd={},kd=t.Leaf.prototype;kd.hit=function(t,i=0){this.updateLayout(),wd(Bd,t),xd(Bd,i);const s=this.__world;return!!(i?bd(s,Bd):Ed(s,Bd))&&(this.isBranch?e.getSelector(this).hitPoint(Object.assign({},Bd),i,{target:this}):this.__hitWorld(Bd))},kd.__hitWorld=function(t){const e=this.__;if(!e.hitSelf)return!1;const i=this.__world,s=this.__layout,r=i.width<10&&i.height<10;if(e.hitRadius&&(wd(Pd,t),xd(t=Pd,e.hitRadius)),md(t,i,Pd),e.hitBox||r){if(Rt.hitRadiusPoint(s.boxBounds,Pd))return!0;if(r)return!1}return!s.hitCanvasChanged&&this.__hitCanvas||(this.__updateHitCanvas(),s.boundsChanged||(s.hitCanvasChanged=!1)),this.__hit(Pd)},kd.__hitFill=function(t){const e=this.__hitCanvas;return e&&e.hitFill(t,this.__.windingRule)},kd.__hitStroke=function(t,e){const i=this.__hitCanvas;return i&&i.hitStroke(t,e)},kd.__hitPixel=function(t){const e=this.__hitCanvas;return e&&e.hitPixel(t,this.__layout.renderBounds,e.hitScale)},kd.__drawHitPath=function(t){t&&this.__drawRenderPath(t)};const Rd=new tt,Cd=t.UI.prototype;Cd.__updateHitCanvas=function(){this.__box&&this.__box.__updateHitCanvas();const t=this.leafer||this.parent&&this.parent.leafer;if(!t)return;const i=this.__,{hitCanvasManager:s}=t,r=(i.__isAlphaPixelFill||i.__isCanvas)&&"pixel"===i.hitFill,n=i.__isAlphaPixelStroke&&"pixel"===i.hitStroke,o=r||n;this.__hitCanvas||(this.__hitCanvas=o?s.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):s.getPathType(this));const a=this.__hitCanvas;if(o){const{renderBounds:t}=this.__layout,s=e.image.hitCanvasSize,o=a.hitScale=Ot.set(0,0,s,s).getFitMatrix(t).a,{x:h,y:l,width:d,height:c}=Ot.set(t).scale(o);a.resize({width:d,height:c,pixelRatio:1}),a.clear(),Or.patternLocked=!0,this.__renderShape(a,{matrix:Rd.setWith(this.__world).scaleWith(1/o).invertWith().translate(-h,-l),ignoreFill:!r,ignoreStroke:!n}),Or.patternLocked=!1,a.resetTransform(),i.__isHitPixel=!0}else i.__isHitPixel&&(i.__isHitPixel=!1);this.__drawHitPath(a),a.setStrokeOptions(i)},Cd.__hit=function(t){if(this.__box&&this.__box.__hit(t))return!0;const e=this.__;if(e.__isHitPixel&&this.__hitPixel(t))return!0;const{hitFill:i}=e,s=(e.fill||e.__isCanvas)&&("path"===i||"pixel"===i&&!(e.__isAlphaPixelFill||e.__isCanvas))||"all"===i;if(s&&this.__hitFill(t))return!0;const{hitStroke:r,__maxStrokeWidth:n}=e,o=e.stroke&&("path"===r||"pixel"===r&&!e.__isAlphaPixelStroke)||"all"===r;if(!s&&!o)return!1;const a=2*t.radiusX;let h=a;if(o)switch(e.strokeAlign){case"inside":if(h+=2*n,!s&&this.__hitFill(t)&&this.__hitStroke(t,h))return!0;h=a;break;case"center":h+=n;break;case"outside":if(h+=2*n,!s){if(!this.__hitFill(t)&&this.__hitStroke(t,h))return!0;h=a}}return!!h&&this.__hitStroke(t,h)};const Td=t.UI.prototype,Sd=t.Rect.prototype,Ld=t.Box.prototype;Sd.__updateHitCanvas=Ld.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&"pixel"===this.hitFill||"all"===this.hitStroke?Td.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)},Sd.__hitFill=Ld.__hitFill=function(t){return this.__hitCanvas?Td.__hitFill.call(this,t):Rt.hitRadiusPoint(this.__layout.boxBounds,t)},t.Text.prototype.__drawHitPath=function(t){const{__lineHeight:e,fontSize:i,__baseLine:s,__letterSpacing:r,__textDrawData:n}=this.__;t.beginPath(),r<0?this.__drawPathByBox(t):n.rows.forEach(r=>t.rect(r.x,r.y-s,r.width,e<i?i:e))},t.Group.prototype.pick=function(t,i){return i||(i=n),this.updateLayout(),e.getSelector(this).getByPoint(t,i.hitRadius||0,Object.assign(Object.assign({},i),{target:this}))};const Od=ue.prototype;Od.hitFill=function(t,e){return e?this.context.isPointInPath(t.x,t.y,e):this.context.isPointInPath(t.x,t.y)},Od.hitStroke=function(t,e){return this.strokeWidth=e,this.context.isPointInStroke(t.x,t.y)},Od.hitPixel=function(t,e,i=1){let{x:s,y:r,radiusX:n,radiusY:o}=t;e&&(s-=e.x,r-=e.y),Ot.set(s-n,r-o,2*n,2*o).scale(i).ceil();const{data:a}=this.context.getImageData(Ot.x,Ot.y,Ot.width||1,Ot.height||1);for(let t=0,e=a.length;t<e;t+=4)if(a[t+3]>0)return!0;return a[3]>0};const Dd={convert(t,e){const i=td.getBase(t),s=Object.assign(Object.assign({},i),{x:e.x,y:e.y,width:t.width,height:t.height,pointerType:t.pointerType,pressure:t.pressure});return"pen"===s.pointerType&&(s.tangentialPressure=t.tangentialPressure,s.tiltX=t.tiltX,s.tiltY=t.tiltY,s.twist=t.twist),s},convertMouse(t,e){const i=td.getBase(t);return Object.assign(Object.assign({},i),{x:e.x,y:e.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(t,e){const i=Dd.getTouch(t),s=td.getBase(t);return Object.assign(Object.assign({},s),{x:e.x,y:e.y,width:1,height:1,pointerType:"touch",multiTouch:t.touches.length>1,pressure:i.force})},getTouch:t=>t.targetTouches[0]||t.changedTouches[0]},Id={convert(t){const e=td.getBase(t);return Object.assign(Object.assign({},e),{code:t.code,key:t.key})}},{pathCanDrag:Ad}=td;class Md extends fd{get notPointer(){const{p:t}=this;return"pointer"!==t.type||t.touch||this.useMultiTouch}get notTouch(){const{p:t}=this;return"mouse"===t.type||this.usePointer}get notMouse(){return this.usePointer||this.useTouch}__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,pointerleave:this.onPointerLeave,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:i}=this;for(let i in e)e[i]=e[i].bind(this),t.addEventListener(i,e[i]);for(let t in i)i[t]=i[t].bind(this),window.addEventListener(t,i[t])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let e in t)this.view.removeEventListener(e,t[e]),this.viewEvents={};for(let t in e)window.removeEventListener(t,e[t]),this.windowEvents={}}getTouches(t){const e=[];for(let i=0,s=t.length;i<s;i++)e.push(t[i]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(Id.convert(t))}onKeyUp(t){this.keyUp(Id.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(Dd.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),this.notPointer||(this.usePointer||(this.usePointer=!0),this.pointerDown(Dd.convert(t,this.getLocal(t))))}onPointerMove(t,e){if(this.notPointer||this.preventWindowPointer(t))return;this.usePointer||(this.usePointer=!0);const i=Dd.convert(t,this.getLocal(t,!0));e?this.pointerHover(i):this.pointerMove(i)}onPointerLeave(t){this.onPointerMove(t,!0)}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),this.notPointer||this.preventWindowPointer(t)||this.pointerUp(Dd.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),this.notMouse||this.pointerDown(Dd.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.notMouse||this.preventWindowPointer(t)||this.pointerMove(Dd.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),this.notMouse||this.preventWindowPointer(t)||this.pointerUp(Dd.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.notMouse||this.pointerCancel()}onTouchStart(t){const e=Dd.getTouch(t),i=this.getLocal(e,!0),{preventDefault:s}=this.config.touch;(!0===s||"auto"===s&&Ad(this.findPath(i)))&&t.preventDefault(),this.multiTouchStart(t),this.notTouch||(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(Dd.convertTouch(t,i)))}onTouchMove(t){if(this.multiTouchMove(t),this.notTouch||this.preventWindowPointer(t))return;const e=Dd.getTouch(t);this.pointerMove(Dd.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.notTouch||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const e=Dd.getTouch(t);this.pointerUp(Dd.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.notTouch||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),i=this.getKeepTouchList(this.touches,e);i.length>1&&(this.multiTouch(td.getBase(t),i),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let i;const s=[];return t.forEach(t=>{i=e.find(e=>e.identifier===t.identifier),i&&s.push({from:this.getLocal(t),to:this.getLocal(i)})}),s}getLocalTouchs(t){return t.map(t=>this.getLocal(t))}onWheel(t){this.preventDefaultWheel(t),this.wheel(Object.assign(Object.assign(Object.assign({},td.getBase(t)),this.getLocal(t)),{deltaX:t.deltaX,deltaY:t.deltaY}))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=td.getBase(t);Object.assign(e,this.getLocal(t));const i=t.scale/this.lastGestureScale,s=(t.rotation-this.lastGestureRotation)/Math.PI*180*(x.within(this.config.wheel.rotateSpeed,0,1)/4+.1);this.zoom(Object.assign(Object.assign({},e),{scale:i*i})),this.rotate(Object.assign(Object.assign({},e),{rotation:s})),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),_(e[e.length-1])&&e.push("default"),this.canvas.view.style.cursor=e.map(t=>_(t)?`url(${t.url}) ${t.x||0} ${t.y||0}`:t).join(",")}eachCursor(t,e,i=0){if(i++,u(t))t.forEach(t=>this.eachCursor(t,e,i));else{const s=h(t)&&yd.get(t);s&&i<2?this.eachCursor(s,e,i):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function Wd(t,e){const i=t.__,{rows:s,decorationY:r}=i.__textDrawData;let n;i.__isPlacehold&&i.placeholderColor&&(e.fillStyle=i.placeholderColor);for(let t=0,i=s.length;t<i;t++)n=s[t],n.text?e.fillText(n.text,n.x,n.y):n.data&&n.data.forEach(t=>{e.fillText(t.char,t.x,n.y)});if(r){const{decorationColor:t,decorationHeight:n}=i.__textDrawData;t&&(e.fillStyle=t),s.forEach(t=>r.forEach(i=>e.fillRect(t.x,t.y+i,t.width,n)))}}function Fd(t,e){t.__.__font?Wd(t,e):t.__.windingRule?e.fill(t.__.windingRule):e.fill()}function Ud(t,e,i){switch(e.__.strokeAlign){case"center":zd(t,1,e,i);break;case"inside":Nd(t,"inside",e,i);break;case"outside":e.__.__fillAfterStroke?zd(t,2,e,i):Nd(t,"outside",e,i)}}function zd(t,e,i,s){const r=i.__;_(t)?Xd(t,e,!0,i,s):(s.setStroke(t,r.__strokeWidth*e,r),Yd(i,s))}function Nd(t,e,i,s){const r=s.getSameCanvas(!0,!0);r.font=i.__.__font,zd(t,2,i,r),r.blendMode="outside"===e?"destination-out":"destination-in",Wd(i,r),r.blendMode="normal",Un.copyCanvasByWorld(i,s,r),r.recycle(i.__nowWorld)}function Yd(t,e){let i,s=t.__.__textDrawData;const{rows:r,decorationY:n}=s;for(let t=0,s=r.length;t<s;t++)i=r[t],i.text?e.strokeText(i.text,i.x,i.y):i.data&&i.data.forEach(t=>{e.strokeText(t.char,t.x,i.y)});if(n){const{decorationHeight:t}=s;r.forEach(i=>n.forEach(s=>e.strokeRect(i.x,i.y+s,i.width,t)))}}function Xd(t,e,i,s,r){let n;const o=s.__,{__hasMultiStrokeStyle:a}=o;a||r.setStroke(void 0,o.__strokeWidth*e,o);for(let h=0,l=t.length;h<l;h++)if(n=t[h],(!n.image||!kh.checkImage(s,r,n,!1))&&n.style){if(a){const{strokeStyle:t}=n;t?r.setStroke(n.style,o.__getRealStrokeWidth(t)*e,o,t):r.setStroke(n.style,o.__strokeWidth*e,o)}else r.strokeStyle=n.style;n.blendMode?(r.saveBlendMode(n.blendMode),i?Yd(s,r):r.stroke(),r.restoreBlendMode()):i?Yd(s,r):r.stroke()}}function Hd(t,e,i){const s=e.__;if(s.__strokeWidth)if(s.__font)Ud(t,e,i);else switch(s.strokeAlign){case"center":jd(t,1,e,i);break;case"inside":!function(t,e,i){i.save(),i.clipUI(e),jd(t,2,e,i),i.restore()}(t,e,i);break;case"outside":!function(t,e,i){const s=e.__;if(s.__fillAfterStroke)jd(t,2,e,i);else{const{renderBounds:r}=e.__layout,n=i.getSameCanvas(!0,!0);e.__drawRenderPath(n),jd(t,2,e,n),n.clipUI(s),n.clearWorld(r),Un.copyCanvasByWorld(e,i,n),n.recycle(e.__nowWorld)}}(t,e,i)}}function jd(t,e,i,s){const r=i.__;_(t)?Xd(t,e,!1,i,s):(s.setStroke(t,r.__strokeWidth*e,r),s.stroke()),r.__useArrow&&Bh.strokeArrow(t,i,s)}const{getSpread:Vd,getOuterOf:Gd,getByMove:Kd,getIntersectData:qd}=Rt;let Zd;const{stintSet:$d}=g,{hasTransparent:Qd}=bh;function Jd(t,e,i){if(!_(e)||!1===e.visible||0===e.opacity)return;let s;const{boxBounds:r}=i.__layout;switch(e.type){case"image":s=kh.image(i,t,e,r,!Zd||!Zd[e.url]);break;case"linear":s=Rh.linearGradient(e,r);break;case"radial":s=Rh.radialGradient(e,r);break;case"angular":s=Rh.conicGradient(e,r);break;case"solid":const{type:n,color:a,opacity:h}=e;s={type:n,style:bh.string(a,h)};break;default:o(e.r)||(s={type:"solid",style:bh.string(e)})}if(s){if(h(s.style)&&Qd(s.style)&&(s.isTransparent=!0),e.style){if(0===e.style.strokeWidth)return;s.strokeStyle=e.style}e.editing&&(s.editing=e.editing),e.blendMode&&(s.blendMode=e.blendMode)}return s}const tc={compute:function(t,e){const i=e.__,s=[];let r,n,o,a=i.__input[t];u(a)||(a=[a]),Zd=kh.recycleImage(t,i);for(let i,r=0,n=a.length;r<n;r++)(i=Jd(t,a[r],e))&&(s.push(i),i.strokeStyle&&(o||(o=1),i.strokeStyle.strokeWidth&&(o=Math.max(o,i.strokeStyle.strokeWidth))));i["_"+t]=s.length?s:void 0,s.length&&s.every(t=>t.isTransparent)&&(s.some(t=>t.image)&&(r=!0),n=!0),"fill"===t?($d(i,"__isAlphaPixelFill",r),$d(i,"__isTransparentFill",n)):($d(i,"__isAlphaPixelStroke",r),$d(i,"__isTransparentStroke",n),$d(i,"__hasMultiStrokeStyle",o))},fill:function(t,e,i){i.fillStyle=t,Fd(e,i)},fills:function(t,e,i){let s;for(let r=0,n=t.length;r<n;r++){if(s=t[r],s.image){if(kh.checkImage(e,i,s,!e.__.__font))continue;if(!s.style){!r&&s.image.isPlacehold&&e.drawImagePlaceholder(i,s.image);continue}}if(i.fillStyle=s.style,s.transform||s.scaleFixed){if(i.save(),s.transform&&i.transform(s.transform),s.scaleFixed){const{scaleX:t,scaleY:r}=e.getRenderScaleData(!0);(!0===s.scaleFixed||"zoom-in"===s.scaleFixed&&t>1&&r>1)&&i.scale(1/t,1/r)}s.blendMode&&(i.blendMode=s.blendMode),Fd(e,i),i.restore()}else s.blendMode?(i.saveBlendMode(s.blendMode),Fd(e,i),i.restoreBlendMode()):Fd(e,i)}},fillPathOrText:Fd,fillText:Wd,stroke:Hd,strokes:function(t,e,i){Hd(t,e,i)},strokeText:Ud,drawTextStroke:Yd,shape:function(t,i,s){const r=i.getSameCanvas(),n=t.__nowWorld,o=i.bounds;let a,h,l,d,c,{scaleX:u,scaleY:_}=t.getRenderScaleData(!0);if(o.includes(n))c=r,a=d=n;else{const{renderShapeSpread:r}=t.__layout;let p;if(e.fullImageShadow)p=n;else{const t=r?Vd(o,u===_?r*u:[r*_,r*u]):o;p=qd(t,n)}l=o.getFitMatrix(p);let{a:g,d:f}=l;l.a<1&&(c=i.getSameCanvas(),t.__renderShape(c,s),u*=g,_*=f),d=Gd(n,l),a=Kd(d,-l.e,-l.f);const y=s.matrix;y?(h=new tt(l),h.multiply(y),g*=y.scaleX,f*=y.scaleY):h=l,h.withScale(g,f),s=Object.assign(Object.assign({},s),{matrix:h})}return t.__renderShape(r,s),{canvas:r,matrix:h,fitMatrix:l,bounds:a,worldCanvas:c,shapeBounds:d,scaleX:u,scaleY:_}}};let ec={},ic={a:1,b:0,c:0,d:1,e:0,f:0};const{get:sc,rotateOfOuter:rc,translate:nc,scaleOfOuter:oc,multiplyParent:ac,scale:hc,rotate:lc,skew:dc}=M;function cc(t,e,i,s,r,n,o){const a=sc();nc(a,e.x+i,e.y+s),hc(a,r,n),o&&rc(a,{x:e.x+e.width/2,y:e.y+e.height/2},o),t.transform=a}function uc(t,e,i,s,r,n,o,a,h){const l=sc();pc(l,e,i,s,r,n,o,a),h&&(ic.a=e.width/h.width,ic.d=e.height/h.height,ac(l,ic)),t.transform=l}function _c(t,e,i,s,r,n,o,a,h,l,d,c){const u=sc();if(c)pc(u,e,r,n,o,a,h,l);else{if(h)if("center"===d)rc(u,{x:i/2,y:s/2},h);else switch(lc(u,h),h){case 90:nc(u,s,0);break;case 180:nc(u,i,s);break;case 270:nc(u,0,i)}ec.x=e.x+r,ec.y=e.y+n,nc(u,ec.x,ec.y),o&&oc(u,ec,o,a)}t.transform=u}function pc(t,e,i,s,r,n,o,a){o&&lc(t,o),a&&dc(t,a.x,a.y),r&&hc(t,r,n),nc(t,e.x+i,e.y+s)}const{get:gc,translate:fc}=M,yc=new Lt,vc={},mc={};function wc(t,e,i,s){const{changeful:r,sync:n,scaleFixed:o}=i;r&&(t.changeful=r),n&&(t.sync=n),o&&(t.scaleFixed=o),t.data=xc(i,s,e)}function xc(t,e,i){t.padding&&(e=yc.set(e).shrink(t.padding)),"strench"===t.mode&&(t.mode="stretch");let{width:s,height:r}=i;const{opacity:n,mode:o,align:a,offset:l,scale:d,size:c,rotation:u,skew:p,clipSize:g,repeat:f,gap:y,filters:v}=t,m=e.width===s&&e.height===r,w={mode:o},b="center"!==a&&(u||0)%180==90;let E,P;switch(Rt.set(mc,0,0,b?r:s,b?s:r),o&&"cover"!==o&&"fit"!==o?((d||c)&&(x.getScaleData(d,c,i,vc),E=vc.scaleX,P=vc.scaleY),(a||y||f)&&(E&&Rt.scale(mc,E,P,!0),a&&dt.toPoint(a,mc,e,mc,!0,!0))):m&&!u||(E=P=Rt.getFitScale(e,mc,"fit"!==o),Rt.put(e,i,a,E,!1,mc),Rt.scale(mc,E,P,!0)),l&&G.move(mc,l),o){case"stretch":m||(s=e.width,r=e.height);break;case"normal":case"clip":(mc.x||mc.y||E||g||u||p)&&uc(w,e,mc.x,mc.y,E,P,u,p,t.clipSize);break;case"repeat":(!m||E||u||p)&&_c(w,e,s,r,mc.x,mc.y,E,P,u,p,a,t.freeTransform),f||(w.repeat="repeat");const i=_(f);(y||i)&&(w.gap=function(t,e,i,s,r){let n,o;_(t)?(n=t.x,o=t.y):n=o=t;return{x:bc(n,i,r.width,e&&e.x),y:bc(o,s,r.height,e&&e.y)}}(y,i&&f,mc.width,mc.height,e));break;default:E&&cc(w,e,mc.x,mc.y,E,P,u)}return w.transform||(e.x||e.y)&&(w.transform=gc(),fc(w.transform,e.x,e.y)),E&&"stretch"!==o&&(w.scaleX=E,w.scaleY=P),w.width=s,w.height=r,n&&(w.opacity=n),v&&(w.filters=v),f&&(w.repeat=h(f)?"x"===f?"repeat-x":"repeat-y":"repeat"),w}function bc(t,e,i,s){const r=h(t)||s?(s?i-s*e:i%e)/((s||Math.floor(i/e))-1):t;return"auto"===t&&r<0?0:r}let Ec,Pc=new Lt;const{isSame:Bc}=Rt;function kc(t,e,i,s,r,n){if("fill"===e&&!t.__.__naturalWidth){const e=t.__;if(e.__naturalWidth=s.width/e.pixelRatio,e.__naturalHeight=s.height/e.pixelRatio,e.__autoSide)return t.forceUpdate("width"),t.__proxyData&&(t.setProxyAttr("width",e.width),t.setProxyAttr("height",e.height)),!1}return r.data||wc(r,s,i,n),!0}function Rc(t,e){Sc(t,vo.LOAD,e)}function Cc(t,e){Sc(t,vo.LOADED,e)}function Tc(t,e,i){e.error=i,t.forceUpdate("surface"),Sc(t,vo.ERROR,e)}function Sc(t,e,i){t.hasEvent(e)&&t.emitEvent(new vo(e,i))}function Lc(t,e){const{leafer:i}=t;i&&i.viewReady&&(i.renderer.ignore=e)}const{get:Oc,scale:Dc,copy:Ic}=M,{floor:Ac,max:Mc,abs:Wc}=Math;function Fc(t,i,s){let{scaleX:r,scaleY:n}=t.getRenderScaleData(!0,i.scaleFixed);const o=r+"-"+n+"-"+s;if(i.patternId===o||t.destroyed)return!1;{const{image:t,data:a}=i;let h,l,{width:d,height:c,scaleX:u,scaleY:_,transform:p,repeat:g,gap:f}=a;r*=s,n*=s;const y=f&&f.x*r,v=f&&f.y*n;u&&(u=Wc(u),_=Wc(_),l=Oc(),Ic(l,p),Dc(l,1/u,1/_),r*=u,n*=_),d*=r,c*=n;const m=d*c;if(!g&&m>e.image.maxCacheSize)return!1;let w=e.image.maxPatternSize;if(!t.isSVG){const e=t.width*t.height;w>e&&(w=e)}if(m>w&&(h=Math.sqrt(m/w)),h&&(r/=h,n/=h,d/=h,c/=h),u&&(r/=u,n/=_),(p||1!==r||1!==n)&&(l||(l=Oc(),p&&Ic(l,p)),Dc(l,1/r,1/n)),l){const t=d+(y||0),e=c+(v||0);Dc(l,t/Mc(Ac(t),1),e/Mc(Ac(e),1))}const x=t.getCanvas(d,c,a.opacity,a.filters,y,v),b=t.getPattern(x,g||e.origin.noRepeat||"no-repeat",l,i);return i.style=b,i.patternId=o,!0}}const Uc={image:function(t,e,i,s,r){let n,o;const a=Or.get(i);return Ec&&i===Ec.paint&&Bc(s,Ec.boxBounds)?n=Ec.leafPaint:(n={type:i.type,image:a},a.hasAlphaPixel&&(n.isTransparent=!0),Ec=a.use>1?{leafPaint:n,paint:i,boxBounds:Pc.set(s)}:null),(r||a.loading)&&(o={image:a,attrName:e,attrValue:i}),a.ready?(kc(t,e,i,a,n,s),r&&(Rc(t,o),Cc(t,o))):a.error?r&&Tc(t,o,a.error):(r&&(Lc(t,!0),Rc(t,o)),n.loadId=a.load(()=>{Lc(t,!1),t.destroyed||(kc(t,e,i,a,n,s)&&(a.hasAlphaPixel&&(t.__layout.hitCanvasChanged=!0),t.forceUpdate("surface")),Cc(t,o)),n.loadId=void 0},e=>{Lc(t,!1),Tc(t,o,e),n.loadId=void 0}),t.placeholderColor&&(t.placeholderDelay?setTimeout(()=>{a.ready||(a.isPlacehold=!0,t.forceUpdate("surface"))},t.placeholderDelay):a.isPlacehold=!0)),n},checkImage:function(t,i,s,r){const{scaleX:n,scaleY:o}=t.getRenderScaleData(!0,s.scaleFixed),{pixelRatio:a}=i,{data:h}=s;if(!h||s.patternId===n+"-"+o+"-"+a&&!Sh.running)return!1;if(r)if(h.repeat)r=!1;else if(!(s.changeful||"miniapp"===e.name&&Bo.isResizing(t)||Sh.running)){let{width:t,height:i}=h;t*=n*a,i*=o*a,h.scaleX&&(t*=h.scaleX,i*=h.scaleY),r=t*i>e.image.maxCacheSize}return r?(t.__.__isFastShadow&&(i.fillStyle=s.style||"#000",i.fill()),function(t,e,i,s){e.save(),e.clipUI(t),i.blendMode&&(e.blendMode=i.blendMode);s.opacity&&(e.opacity*=s.opacity);s.transform&&e.transform(s.transform);e.drawImage(i.image.getFull(s.filters),0,0,s.width,s.height),e.restore()}(t,i,s,h),!0):(!s.style||s.sync||Sh.running?Fc(t,s,a):s.patternTask||(s.patternTask=Or.patternTasker.add(()=>Jt(this,void 0,void 0,function*(){s.patternTask=null,i.bounds.hit(t.__nowWorld)&&Fc(t,s,a),t.forceUpdate("surface")}),300)),!1)},createPattern:Fc,recycleImage:function(t,e){const i=e["_"+t];if(u(i)){let s,r,n,o,a;for(let h=0,l=i.length;h<l;h++)s=i[h],r=s.image,a=r&&r.url,a&&(n||(n={}),n[a]=!0,Or.recycle(r),r.loading&&(o||(o=e.__input&&e.__input[t]||[],u(o)||(o=[o])),r.unload(i[h].loadId,!o.some(t=>t.url===a))));return n}return null},createData:wc,getPatternData:xc,fillOrFitMode:cc,clipMode:uc,repeatMode:_c},{toPoint:zc}=at,{hasTransparent:Nc}=bh,Yc={},Xc={};function Hc(t,e,i,s){if(i){let r,n,o,a;for(let t=0,l=i.length;t<l;t++)r=i[t],h(r)?(o=t/(l-1),n=bh.string(r,s)):(o=r.offset,n=bh.string(r.color,s)),e.addColorStop(o,n),!a&&Nc(n)&&(a=!0);a&&(t.isTransparent=!0)}}const{getAngle:jc,getDistance:Vc}=G,{get:Gc,rotateOfOuter:Kc,scaleOfOuter:qc}=M,{toPoint:Zc}=at,$c={},Qc={};function Jc(t,e,i,s,r){let n;const{width:o,height:a}=t;if(o!==a||s){const t=jc(e,i);n=Gc(),r?(qc(n,e,o/a*(s||1),1),Kc(n,e,t+90)):(qc(n,e,1,o/a*(s||1)),Kc(n,e,t))}return n}const{getDistance:tu}=G,{toPoint:eu}=at,iu={},su={};const ru={linearGradient:function(t,i){let{from:s,to:r,type:n,opacity:o}=t;zc(s||"top",i,Yc),zc(r||"bottom",i,Xc);const a=e.canvas.createLinearGradient(Yc.x,Yc.y,Xc.x,Xc.y),h={type:n,style:a};return Hc(h,a,t.stops,o),h},radialGradient:function(t,i){let{from:s,to:r,type:n,opacity:o,stretch:a}=t;Zc(s||"center",i,$c),Zc(r||"bottom",i,Qc);const h=e.canvas.createRadialGradient($c.x,$c.y,0,$c.x,$c.y,Vc($c,Qc)),l={type:n,style:h};Hc(l,h,t.stops,o);const d=Jc(i,$c,Qc,a,!0);return d&&(l.transform=d),l},conicGradient:function(t,i){let{from:s,to:r,type:n,opacity:o,stretch:a}=t;eu(s||"center",i,iu),eu(r||"bottom",i,su);const h=e.conicGradientSupport?e.canvas.createConicGradient(0,iu.x,iu.y):e.canvas.createRadialGradient(iu.x,iu.y,0,iu.x,iu.y,tu(iu,su)),l={type:n,style:h};Hc(l,h,t.stops,o);const d=Jc(i,iu,su,a||1,e.conicGradientRotate90);return d&&(l.transform=d),l},getTransform:Jc},{copy:nu,toOffsetOutBounds:ou}=Rt,au={},hu={};function lu(t,i,s,r){const{bounds:n,shapeBounds:o}=r;if(e.fullImageShadow){if(nu(au,t.bounds),au.x+=i.x-o.x,au.y+=i.y-o.y,s){const{fitMatrix:t}=r;au.x-=(n.x+(t?t.e:0)+n.width/2)*(s-1),au.y-=(n.y+(t?t.f:0)+n.height/2)*(s-1),au.width*=s,au.height*=s}t.copyWorld(r.canvas,t.bounds,au)}else s&&(nu(au,i),au.x-=i.width/2*(s-1),au.y-=i.height/2*(s-1),au.width*=s,au.height*=s),t.copyWorld(r.canvas,o,s?au:i)}const{toOffsetOutBounds:du}=Rt,cu={};const uu={shadow:function(t,e,i){let s,r;const{__nowWorld:n,__layout:o}=t,{shadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=i,_=e.getSameCanvas(),p=a.length-1;ou(l,hu),a.forEach((a,g)=>{let f=1;if(a.scaleFixed){const t=Math.abs(n.scaleX);t>1&&(f=1/t)}_.setWorldShadow(hu.offsetX+a.x*c*f,hu.offsetY+a.y*u*f,a.blur*c*f,bh.string(a.color)),r=a.spread?1+2*a.spread/(o.boxBounds.width+2*(o.strokeBoxSpread||0))*f:0,lu(_,hu,r,i),s=l,a.box&&(_.restore(),_.save(),h&&(_.copyWorld(_,l,n,"copy"),s=n),h?_.copyWorld(h,n,n,"destination-out"):_.copyWorld(i.canvas,d,l,"destination-out")),Un.copyCanvasByWorld(t,e,_,s,a.blendMode),p&&g<p&&_.clearWorld(s)}),_.recycle(s)},innerShadow:function(t,e,i){let s,r;const{__nowWorld:n,__layout:o}=t,{innerShadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=i,_=e.getSameCanvas(),p=a.length-1;du(l,cu),a.forEach((a,g)=>{let f=1;if(a.scaleFixed){const t=Math.abs(n.scaleX);t>1&&(f=1/t)}_.save(),_.setWorldShadow(cu.offsetX+a.x*c*f,cu.offsetY+a.y*u*f,a.blur*c*f),r=a.spread?1-2*a.spread/(o.boxBounds.width+2*(o.strokeBoxSpread||0))*f:0,lu(_,cu,r,i),_.restore(),h?(_.copyWorld(_,l,n,"copy"),_.copyWorld(h,n,n,"source-out"),s=n):(_.copyWorld(i.canvas,d,l,"source-out"),s=l),_.fillWorld(s,bh.string(a.color),"source-in"),Un.copyCanvasByWorld(t,e,_,s,a.blendMode),p&&g<p&&_.clearWorld(s)}),_.recycle(s)},blur:function(t,e,i){const{blur:s}=t.__;i.setWorldBlur(s*t.__nowWorld.a),i.copyWorldToInner(e,t.__nowWorld,t.__layout.renderBounds),i.filter="none"},backgroundBlur:function(t,e,i){}},{excludeRenderBounds:_u}=Gn;let pu;function gu(t,e,i,s,r,n,o,a){switch(e){case"grayscale":pu||(pu=!0,r.useGrayscaleAlpha(t.__nowWorld));case"alpha":!function(t,e,i,s,r,n){const o=t.__nowWorld;i.resetTransform(),i.opacity=1,i.useMask(s,o),n&&s.recycle(o);yu(t,e,i,1,r,n)}(t,i,s,r,o,a);break;case"opacity-path":yu(t,i,s,n,o,a);break;case"path":a&&i.restore()}}function fu(t){return t.getSameCanvas(!1,!0)}function yu(t,e,i,s,r,n){const o=t.__nowWorld;e.resetTransform(),e.opacity=s,e.copyWorld(i,o,void 0,r),n?i.recycle(o):i.clearWorld(o)}t.Group.prototype.__renderMask=function(t,e){let i,s,r,n,o,a;const{children:h}=this;for(let l=0,d=h.length;l<d;l++){if(i=h[l],a=i.__.mask,a){o&&(gu(this,o,t,r,s,n,void 0,!0),s=r=null),n=i.__.opacity,pu=!1,"path"===a||"clipping-path"===a?(n<1?(o="opacity-path",r||(r=fu(t))):(o="path",t.save()),i.__clip(r||t,e)):(o="grayscale"===a?"grayscale":"alpha",s||(s=fu(t)),r||(r=fu(t)),i.__render(s,e)),"clipping"!==a&&"clipping-path"!==a||_u(i,e)||i.__render(t,e);continue}const d=1===n&&i.__.__blendMode;d&&gu(this,o,t,r,s,n,void 0,!1),_u(i,e)||i.__render(r||t,e),d&&gu(this,o,t,r,s,n,d,!1)}gu(this,o,t,r,s,n,void 0,!0)};const vu=">)]}%!?,.:;'\"",mu=vu+"_#~&*+\\=|",wu=new RegExp([[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]].map(([t,e])=>`[\\u${t.toString(16)}-\\u${e.toString(16)}]`).join("|"));function xu(t){const e={};return t.split("").forEach(t=>e[t]=!0),e}const bu=xu("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz"),Eu=xu("{[(<'\""),Pu=xu(vu),Bu=xu(mu),ku=xu("- ");var Ru;!function(t){t[t.Letter=0]="Letter",t[t.Single=1]="Single",t[t.Before=2]="Before",t[t.After=3]="After",t[t.Symbol=4]="Symbol",t[t.Break=5]="Break"}(Ru||(Ru={}));const{Letter:Cu,Single:Tu,Before:Su,After:Lu,Symbol:Ou,Break:Du}=Ru;function Iu(t){return bu[t]?Cu:ku[t]?Du:Eu[t]?Su:Pu[t]?Lu:Bu[t]?Ou:wu.test(t)?Tu:Cu}const Au={trimRight(t){const{words:e}=t;let i,s=0,r=e.length;for(let n=r-1;n>-1&&(i=e[n].data[0]," "===i.char);n--)s++,t.width-=i.width;s&&e.splice(r-s,s)}};function Mu(t,e,i){switch(e){case"title":return i?t.toUpperCase():t;case"upper":return t.toUpperCase();case"lower":return t.toLowerCase();default:return t}}const{trimRight:Wu}=Au,{Letter:Fu,Single:Uu,Before:zu,After:Nu,Symbol:Yu,Break:Xu}=Ru;let Hu,ju,Vu,Gu,Ku,qu,Zu,$u,Qu,Ju,t_,e_,i_,s_,r_,n_,o_,a_=[];function h_(t,e){Qu&&!$u&&($u=Qu),Hu.data.push({char:t,width:e}),Vu+=e}function l_(){Gu+=Vu,Hu.width=Vu,ju.words.push(Hu),Hu={data:[]},Vu=0}function d_(){s_&&(r_.paraNumber++,ju.paraStart=!0,s_=!1),Qu&&(ju.startCharSize=$u,ju.endCharSize=Qu,$u=0),ju.width=Gu,n_.width?Wu(ju):o_&&c_(),a_.push(ju),ju={words:[]},Gu=0}function c_(){Gu>(r_.maxWidth||0)&&(r_.maxWidth=Gu)}const{top:u_,right:__,bottom:p_,left:g_}=t.Direction4;function f_(t,e,i){const{bounds:s,rows:r}=t;s[e]+=i;for(let t=0;t<r.length;t++)r[t][e]+=i}const y_={getDrawData:function(t,i){h(t)||(t=String(t));let s=0,r=0,n=i.__getInput("width")||0,o=i.__getInput("height")||0;const{textDecoration:a,__font:l,__padding:d}=i;d&&(n?(s=d[g_],n-=d[__]+d[g_]):i.autoSizeAlign||(s=d[g_]),o?(r=d[u_],o-=d[u_]+d[p_]):i.autoSizeAlign||(r=d[u_]));const c={bounds:{x:s,y:r,width:n,height:o},rows:[],paraNumber:0,font:e.canvas.font=l};return function(t,i,s){r_=t,a_=t.rows,n_=t.bounds,o_=!n_.width&&!s.autoSizeAlign;const{__letterSpacing:r,paraIndent:n,textCase:o}=s,{canvas:a}=e,{width:h,height:l}=n_;if(h||l||r||"none"!==o){const t="none"!==s.textWrap,e="break"===s.textWrap;s_=!0,t_=null,$u=Zu=Qu=Vu=Gu=0,Hu={data:[]},ju={words:[]},r&&(i=[...i]);for(let s=0,l=i.length;s<l;s++)qu=i[s],"\n"===qu?(Vu&&l_(),ju.paraEnd=!0,d_(),s_=!0):(Ju=Iu(qu),Ju===Fu&&"none"!==o&&(qu=Mu(qu,o,!Vu)),Zu=a.measureText(qu).width,r&&(r<0&&(Qu=Zu),Zu+=r),e_=Ju===Uu&&(t_===Uu||t_===Fu)||t_===Uu&&Ju!==Nu,i_=!(Ju!==zu&&Ju!==Uu||t_!==Yu&&t_!==Nu),Ku=s_&&n?h-n:h,t&&h&&Gu+Vu+Zu>Ku&&(e?(Vu&&l_(),Gu&&d_()):(i_||(i_=Ju===Fu&&t_==Nu),e_||i_||Ju===Xu||Ju===zu||Ju===Uu||Vu+Zu>Ku?(Vu&&l_(),Gu&&d_()):Gu&&d_()))," "===qu&&!0!==s_&&Gu+Vu===0||(Ju===Xu?(" "===qu&&Vu&&l_(),h_(qu,Zu),l_()):e_||i_?(Vu&&l_(),h_(qu,Zu)):h_(qu,Zu)),t_=Ju);Vu&&l_(),Gu&&d_(),a_.length>0&&(a_[a_.length-1].paraEnd=!0)}else i.split("\n").forEach(t=>{r_.paraNumber++,Gu=a.measureText(t).width,a_.push({x:n||0,text:t,width:Gu,paraStart:!0}),o_&&c_()})}(c,t,i),d&&function(t,e,i,s,r){if(!s&&i.autoSizeAlign)switch(i.textAlign){case"left":f_(e,"x",t[g_]);break;case"right":f_(e,"x",-t[__])}if(!r&&i.autoSizeAlign)switch(i.verticalAlign){case"top":f_(e,"y",t[u_]);break;case"bottom":f_(e,"y",-t[p_])}}(d,c,i,n,o),function(t,e){const{rows:i,bounds:s}=t,r=i.length,{__lineHeight:n,__baseLine:o,__letterSpacing:a,__clipText:h,textAlign:l,verticalAlign:d,paraSpacing:c,autoSizeAlign:u}=e;let{x:_,y:p,width:g,height:f}=s,y=n*r+(c?c*(t.paraNumber-1):0),v=o;if(h&&y>f)y=Math.max(f,n),r>1&&(t.overflow=r);else if(f||u)switch(d){case"middle":p+=(f-y)/2;break;case"bottom":p+=f-y}v+=p;let m,w,x,b=g||u?g:t.maxWidth;for(let o=0,d=r;o<d;o++){if(m=i[o],m.x=_,m.width<g||m.width>g&&!h)switch(l){case"center":m.x+=(b-m.width)/2;break;case"right":m.x+=b-m.width}m.paraStart&&c&&o>0&&(v+=c),m.y=v,v+=n,t.overflow>o&&v>y&&(m.isOverflow=!0,t.overflow=o+1),w=m.x,x=m.width,a<0&&(m.width<0?(x=-m.width+e.fontSize+a,w-=x,x+=e.fontSize):x-=a),w<s.x&&(s.x=w),x>s.width&&(s.width=x),h&&g&&g<x&&(m.isOverflow=!0,t.overflow||(t.overflow=i.length))}s.y=p,s.height=y}(c,i),function(t,e,i){const{rows:s}=t,{textAlign:r,paraIndent:n,letterSpacing:o}=e;let a,h,l,d,c,u;s.forEach(t=>{t.words&&(l=n&&t.paraStart?n:0,u=t.words.length,h=i&&("justify"===r||"both"===r)&&u>1?(i-t.width-l)/(u-1):0,d=o||t.isOverflow?0:h>.01?1:2,t.isOverflow&&!o&&(t.textMode=!0),2===d?(t.x+=l,function(t){t.text="",t.words.forEach(e=>{e.data.forEach(e=>{t.text+=e.char})})}(t)):(t.x+=l,a=t.x,t.data=[],t.words.forEach((e,i)=>{1===d?(c={char:"",x:a},a=function(t,e,i){return t.forEach(t=>{i.char+=t.char,e+=t.width}),e}(e.data,a,c),(t.isOverflow||" "!==c.char)&&t.data.push(c)):a=function(t,e,i,s){return t.forEach(t=>{(s||" "!==t.char)&&(t.x=e,i.push(t)),e+=t.width}),e}(e.data,a,t.data,t.isOverflow),!h||t.paraEnd&&"both"!==r||i===u-1||(a+=h,t.width+=h)})),t.words=null)})}(c,i,n),c.overflow&&function(t,i,s,r){if(!r)return;const{rows:n,overflow:o}=t;let{textOverflow:a}=i;if(n.splice(o),a&&"show"!==a){let t,h;"hide"===a?a="":"ellipsis"===a&&(a="...");const l=a?e.canvas.measureText(a).width:0,d=s+r-l;("none"===i.textWrap?n:[n[o-1]]).forEach(e=>{if(e.isOverflow&&e.data){let i=e.data.length-1;for(let s=i;s>-1&&(t=e.data[s],h=t.x+t.width,!(s===i&&h<d));s--){if(h<d&&" "!==t.char||!s){e.data.splice(s+1),e.width-=t.width;break}e.width-=t.width}e.width+=l,e.data.push({char:a,x:h}),e.textMode&&function(t){t.text="",t.data.forEach(e=>{t.text+=e.char}),t.data=null}(e)}})}}(c,i,s,n),"none"!==a&&function(t,e){let i;const{fontSize:s,textDecoration:r}=e;switch(t.decorationHeight=s/11,_(r)?(i=r.type,r.color&&(t.decorationColor=bh.string(r.color))):i=r,i){case"under":t.decorationY=[.15*s];break;case"delete":t.decorationY=[.35*-s];break;case"under-delete":t.decorationY=[.15*s,.35*-s]}}(c,i),c}};const v_={string:function(t,e){const i=d(e)&&e<1;if(h(t)){if(!i||!bh.object)return t;t=bh.object(t)}let s=o(t.a)?1:t.a;i&&(s*=e);const r=t.r+","+t.g+","+t.b;return 1===s?"rgb("+r+")":"rgba("+r+","+s+")"}};return Object.assign(xh,y_),Object.assign(bh,v_),Object.assign(Bh,tc),Object.assign(kh,Uc),Object.assign(Rh,ru),Object.assign(Ch,uu),Object.assign(Ht,{interaction:(t,e,i,s)=>new Md(t,e,i,s),hitCanvas:(t,e)=>new Za(t,e),hitCanvasManager:()=>new vd}),Ja(),t.AlignHelper=dt,t.AroundHelper=at,t.AutoBounds=Dt,t.BezierHelper=Ne,t.Bounds=Lt,t.BoundsEvent=mo,t.BoundsHelper=Rt,t.BoxData=Yh,t.BranchHelper=$n,t.BranchRender=_a,t.CanvasData=el,t.CanvasManager=$t,t.ChildEvent=po,t.ColorConvert=bh,t.Creator=Ht,t.Cursor=yd,t.DataHelper=g,t.Debug=Mt,t.DragBoundsHelper=sl,t.Dragger=od,t.Effect=Ch,t.EllipseData=Gh,t.EllipseHelper=Ze,t.Event=_o,t.EventCreator=qt,t.Eventer=Mo,t.Export=Sh,t.FileHelper=Pr,t.Filter=Th,t.FrameData=Hh,t.GroupData=Nh,t.HitCanvasManager=vd,t.ImageData=tl,t.ImageEvent=vo,t.ImageManager=Or,t.IncrementId=i,t.Interaction=Md,t.InteractionBase=fd,t.InteractionHelper=td,t.Keyboard=Kl,t.LayoutEvent=Ro,t.Layouter=uh,t.LeafBounds=da,t.LeafBoundsHelper=Gn,t.LeafData=y,t.LeafDataProxy=qo,t.LeafEventer=Go,t.LeafHelper=Un,t.LeafLayout=uo,t.LeafLevelList=Ka,t.LeafList=Ga,t.LeafMatrix=ia,t.LeafRender=ca,t.LeaferCanvas=Za,t.LeaferCanvasBase=ue,t.LeaferData=Xh,t.LeaferEvent=To,t.LeaferImage=Fr,t.LineData=jh,t.MathHelper=x,t.Matrix=tt,t.MatrixHelper=M,t.MyDragEvent=Jl,t.MyImage=Yl,t.MyPointerEvent=$l,t.NeedConvertToCanvasCommandMap=ye,t.OneRadian=E,t.PI2=P,t.PI_2=B,t.Paint=Bh,t.PaintGradient=Rh,t.PaintImage=kh,t.PathArrow=Ph,t.PathBounds=_r,t.PathCommandDataHelper=ss,t.PathCommandMap=ge,t.PathConvert=Ii,t.PathCorner=wr,t.PathCreator=ws,t.PathData=Zh,t.PathDrawer=As,t.PathHelper=_e,t.PathNumberCommandLengthMap=xe,t.PathNumberCommandMap=we,t.PenData=$h,t.Picker=fh,t.Platform=e,t.Plugin=Xt,t.Point=Q,t.PointHelper=G,t.PointerButton=ql,t.PolygonData=Kh,t.PropertyEvent=fo,t.RectData=Vh,t.RectHelper=be,t.RectRender=hl,t.RenderEvent=Co,t.Renderer=ph,t.ResizeEvent=Bo,t.Resource=Sr,t.Run=zt,t.Selector=yh,t.StarData=qh,t.State=Lh,t.StringNumberMap=It,t.TaskItem=Rr,t.TaskProcessor=Cr,t.TextConvert=xh,t.TextData=Jh,t.Transition=Oh,t.TwoPointBoundsHelper=it,t.UIBounds=il,t.UICreator=Vt,t.UIData=Uh,t.UIEvent=Zl,t.UIRender=ol,t.UnitConvert=Eh,t.WaitHelper=eo,t.WatchEvent=ko,t.Watcher=eh,t.affectRenderBoundsType=on,t.affectStrokeBoundsType=sn,t.attr=Xr,t.autoLayoutType=Kr,t.boundsType=$r,t.canvasPatch=Er,t.canvasSizeAttrs=ce,t.createAttr=function(t){return(e,i)=>{Ur(e,i,Nr(i,t))}},t.createDescriptor=Nr,t.cursorType=fn,t.dataProcessor=yn,t.dataType=jr,t.decorateLeafAttr=Yr,t.defineDataProcessor=vn,t.defineKey=Ur,t.defineLeafAttr=Hr,t.doBoundsType=Jr,t.doStrokeType=rn,t.effectType=vh,t.emptyData=n,t.eraserType=pn,t.extraPropertyEventMap=yo,t.getBoundsData=R,t.getDescriptor=zr,t.getMatrixData=C,t.getPointData=k,t.hitType=gn,t.isArray=u,t.isData=function(t){return _(t)&&!u(t)},t.isEmptyData=p,t.isFinite=l,t.isNull=a,t.isNumber=d,t.isObject=_,t.isString=h,t.isUndefined=o,t.layoutProcessor=function(t){return(e,i)=>{Ur(e,"__LayoutProcessor",{get:()=>t})}},t.leaferTransformAttrMap=Io,t.maskType=_n,t.naturalBoundsType=Qr,t.opacityType=hn,t.pathInputType=tn,t.pathType=en,t.pen=xr,t.positionType=Vr,t.registerUI=kn,t.registerUIEvent=Rn,t.resizeType=mh,t.rewrite=bn,t.rewriteAble=En,t.rotationType=Zr,t.scaleType=qr,t.scrollType=Gr,t.sortType=un,t.strokeType=nn,t.surfaceType=an,t.tempBounds=Ot,t.tempMatrix=et,t.tempPoint=J,t.tryToNumber=function(t){return"string"==typeof t&&c.test(t)?+t:t},t.useCanvas=Ja,t.useModule=Bn,t.version="1.9.4",t.visibleType=ln,t.zoomLayerType=wh,t}({});function Leafer(t){return new LeaferUI.Leafer(t)}Object.setPrototypeOf(Leafer,LeaferUI),Leafer.prototype=LeaferUI.Leafer.prototype;
//# sourceMappingURL=web.min.js.map